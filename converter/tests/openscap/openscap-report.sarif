{"$schema":"https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.6.json","version":"2.1.0","runs":[{"results":[{"ruleId":"xccdf_org.ssgproject.content_rule_package_aide_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_aide_build_database","kind":"notApplicable","level":"none","message":{"text":"Run the following command to generate a new database:By default, the database will be written to the file.\n\nStoring the database, the configuration file, and the binary(or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity.\nThe newly-generated database can be installed as follows:To initiate a manual check, run the following command:If this check produces any unexpected output, investigate."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_aide_check_audit_tools","kind":"notApplicable","level":"none","message":{"text":"The operating system file integrity tool must be configured to protect the integrity of the audit tools."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking","kind":"notApplicable","level":"none","message":{"text":"At a minimum, AIDE should be configured to run a weekly scan.\nTo implement a daily execution of AIDE at 4:05am using cron, add the following line to:To implement a weekly execution of AIDE at 4:05am using cron, add the following line to:AIDE can be executed periodically through other means; this is merely one example.\nThe usage of cron's special time codes, such asandis acceptable."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_is_fips_mode_enabled","kind":"notApplicable","level":"none","message":{"text":"On a system where FIPS 140-2 mode is enabled,must exist.\nTo verify FIPS mode, run the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_harden_ssh_client_crypto_policy","kind":"notApplicable","level":"none","message":{"text":"Crypto Policies are means of enforcing certain cryptographic settings for selected applications including OpenSSH client.\nTo override the system wide crypto policy for Openssh client, place a file in theso that it is loaded before the. In this case it is file namedcontaining parameters which need to be changed with respect to the crypto policy.\nThis rule checks if the file exists and if it contains required parameters and values which modify the Crypto Policy.\nDuring the parsing process, as soon as Openssh client parses some configuration option and its value, it remembers it and ignores any subsequent overrides. The customization mechanism provided by crypto policies appends eventual customizations at the end of the system wide crypto policy. Therefore, if the crypto policy customization overrides some parameter which is already configured in the system wide crypto policy, the SSH client will not honor that customized parameter."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_installed_OS_is_FIPS_certified","kind":"notApplicable","level":"none","message":{"text":"To enable processing of sensitive information the operating system must\nprovide certified cryptographic modules compliant with FIPS 140-2\nstandard.\n\nUbuntu Linux is supported by Canonical Ltd. As the Ubuntu Linux Vendor, Canonical Ltd. is\nresponsible for government certifications and standards.\n\nUsers of Ubuntu Linux either need an Ubuntu Advantage subscription or need\nto be using Ubuntu Pro from a sponsored vendor in order to have access to\nFIPS content supported by Canonical."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_mcafeetp_installed","kind":"notApplicable","level":"none","message":{"text":"Install McAfee Endpoint Security for Linux antivirus software\nwhich is provided for DoD systems and uses signatures to search for the\npresence of viruses on the filesystem.\n\nThepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_MFEhiplsm_installed","kind":"notApplicable","level":"none","message":{"text":"Install the McAfee Host Intrusion Prevention System (HIPS) Module if it is absolutely\nnecessary. If SELinux is enabled, do not install or enable this module."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_configure_user_data_backups","kind":"notApplicable","level":"none","message":{"text":"The operating system must conduct backups of user data contained\nin the operating system. The operating system provides utilities for\nautomating backups of user data. Commercial and open-source products\nare also available."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_prelink_removed","kind":"pass","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_encrypt_partitions","kind":"notApplicable","level":"none","message":{"text":"Ubuntu 22.04 natively supports partition encryption through the\nLinux Unified Key Setup-on-disk-format (LUKS) technology. The easiest way to\nencrypt a partition is during installation time.For manual installations, select thecheckbox during\npartition creation to encrypt the partition. When this\noption is selected the system will prompt for a passphrase to use in\ndecrypting the partition. The passphrase will subsequently need to be entered manually\nevery time the system boots.For automated/unattended installations, it is possible to use Kickstart by adding\ntheandoptions to the definition of each partition to be\nencrypted. For example, the following line would encrypt the root partition:Anyis stored in the Kickstart in plaintext, and the Kickstart\nmust then be protected accordingly.\nOmitting theoption from the partition definition will cause the\ninstaller to pause and interactively ask for the passphrase during installation.By default, theinstaller usescipher\nwith a minimumbit key size which should be compatible with FIPS enabled.Detailed information on encrypting partitions using LUKS or LUKS ciphers can be found on\nthe Ubuntu 22.04 Documentation web site:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_dev_shm","kind":"notApplicable","level":"none","message":{"text":"Theis a traditional shared memory concept. \nOne program will create a memory portion, which other processes \n(if permitted) can access. Ifis not configured, \ntmpfs will be mounted to /dev/shm by systemd."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_home","kind":"notApplicable","level":"none","message":{"text":"If user home directories will be stored locally, create a separate partition\nforat installation time (or migrate it later using LVM). Ifwill be mounted from another system such as an NFS server, then\ncreating a separate partition is not necessary at installation time, and the\nmountpoint can instead be configured later."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_srv","kind":"notApplicable","level":"none","message":{"text":"If a file server (FTP, TFTP...) is hosted locally, create a separate partition\nforat installation time (or migrate it later using LVM). Ifwill be mounted from another system such as an NFS server, then\ncreating a separate partition is not necessary at installation time, and the\nmountpoint can instead be configured later."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_tmp","kind":"notApplicable","level":"none","message":{"text":"Thedirectory is a world-writable directory used\nfor temporary file storage. Ensure it has its own partition or\nlogical volume at installation time, or migrate it using LVM."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_var","kind":"notApplicable","level":"none","message":{"text":"Thedirectory is used by daemons and other system\nservices to store frequently-changing data. Ensure thathas its own partition\nor logical volume at installation time, or migrate it using LVM."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_var_log","kind":"notApplicable","level":"none","message":{"text":"System logs are stored in thedirectory.\n\nEnsure thathas its own partition or logical\nvolume at installation time, or migrate it using LVM."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_var_log_audit","kind":"notApplicable","level":"none","message":{"text":"Audit logs are stored in thedirectory.\n\nEnsure thathas its own partition or logical\nvolume at installation time, or migrate it using LVM.\nMake absolutely certain that it is large enough to store all\naudit logs that will be created by the auditing daemon."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_partition_for_var_tmp","kind":"notApplicable","level":"none","message":{"text":"Thedirectory is a world-writable directory used\nfor temporary file storage. Ensure it has its own partition or\nlogical volume at installation time, or migrate it using LVM."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_user_list","kind":"notApplicable","level":"none","message":{"text":"In the default graphical environment, users logging directly into the\nsystem are greeted with a login screen that displays all known users.\nThis functionality should be disabled by settingto.To disable, add or editto. For example:Once the setting has been added, add a lock toto prevent\nuser modification. For example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_gnome_gdm_disable_xdmcp","kind":"notApplicable","level":"none","message":{"text":"XDMCP is an unencrypted protocol, and therefore, presents a security risk, see e.g..\n\nTo disable XDMCP support in Gnome, settounder theconfiguration section in. For example:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount","kind":"notApplicable","level":"none","message":{"text":"The system's default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable automount within GNOME3, add or settoin.\nFor example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount_open","kind":"notApplicable","level":"none","message":{"text":"The system's default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable automount-open within GNOME3, add or settoin.\nFor example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_autorun","kind":"notApplicable","level":"none","message":{"text":"The system's default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable autorun-never within GNOME3, add or settoin.\nFor example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_lock_delay","kind":"notApplicable","level":"none","message":{"text":"To activate the locking delay of the screensaver in the GNOME3 desktop when\nthe screensaver is activated, add or settoin. For example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_lock_enabled","kind":"notApplicable","level":"none","message":{"text":"To activate locking of the screensaver in the GNOME3 desktop when it is activated,\nadd or settoin. For example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_ctrlaltdel_reboot","kind":"notApplicable","level":"none","message":{"text":"By default,will reboot the system if thekey sequence is pressed.To configure the system to ignore thekey sequence\nfrom the Graphical User Interface (GUI) instead of rebooting the system,\nadd or settoin. For example:Once the settings have been added, add a lock toto prevent\nuser modification. For example:After the settings have been set, run."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_gdm_removed","kind":"notApplicable","level":"none","message":{"text":"By removing thepackage, the system no longer has GNOME installed\n\ninstalled. If X Windows is not installed then the system cannot boot into graphical user mode.\nThis prevents the system from being accidentally or maliciously booted into amode. To do so, run the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_enable_dconf_user_profile","kind":"notApplicable","level":"none","message":{"text":"By default, DConf provides a standard user profile. This profile contains a list\nof DConf configuration databases. The user profile and database always take the\nhighest priority. As such the DConf User profile should always exist and be\nconfigured correctly.To make sure that the user profile is configured correctly, theshould be set as follows:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_sudo_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_add_noexec","kind":"notApplicable","level":"none","message":{"text":"The sudotag, when specified, prevents user executed\ncommands from executing other commands, like a shell for example.\nThis should be enabled by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_add_requiretty","kind":"notApplicable","level":"none","message":{"text":"The sudotag, when specified, will only execute sudo\ncommands from users logged in to a real tty.\nThis should be enabled by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_add_use_pty","kind":"notApplicable","level":"none","message":{"text":"The sudotag, when specified, will only execute sudo\ncommands from users logged in to a real tty.\nThis should be enabled by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_custom_logfile","kind":"notApplicable","level":"none","message":{"text":"A custom log sudo file can be configured with the 'logfile' tag. This rule configures\na sudo custom logfile at the default location suggested by CIS, which uses\n/var/log/sudo.log."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_remove_no_authenticate","kind":"pass","level":"none","message":{"text":"The sudooption, when specified, allows a user to execute commands using\nsudo without having to authenticate. This should be disabled by making sure that theoption does not exist inconfiguration file or\nany sudo configuration snippets in."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_remove_nopasswd","kind":"notApplicable","level":"none","message":{"text":"The sudotag, when specified, allows a user to execute\ncommands using sudo without having to authenticate. This should be disabled\nby making sure that thetag does not exist inconfiguration file or any sudo configuration snippets\nin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_require_authentication","kind":"pass","level":"none","message":{"text":"The sudoandoption, when\nspecified, allows a user to execute commands using sudo without having to\nauthenticate. This should be disabled by making sure thatand/ordo not exist inconfiguration file or any sudo configuration snippets\nin.\"."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_require_reauthentication","kind":"notApplicable","level":"none","message":{"text":"The sudotag sets the amount of time sudo password prompt waits.\nThe defaultvalue is 5 minutes.\nThe timestamp_timeout should be configured by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin.\nIf the value is set to an integer less than 0, the user's time stamp will not expire\nand the user will not have to re-authenticate for privileged actions until the user's session is terminated."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudo_vdsm_nopasswd","kind":"notApplicable","level":"none","message":{"text":"The sudotag, when specified, allows a user to execute commands using sudo without having to authenticate. Only theuser should have this capability in any sudo configuration snippets in."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudoers_explicit_command_args","kind":"notApplicable","level":"none","message":{"text":"All commands in the sudoers file must strictly specify the arguments allowed to be used for a given user.\nIf the command is supposed to be executed only without arguments, pass \"\" as an argument in the corresponding user specification."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudoers_no_command_negation","kind":"notApplicable","level":"none","message":{"text":"Policies applied by sudo through the sudoers file should not involve negation.\n\nEach user specification in thefile contains a comma-delimited list of command specifications.\nThe definition can make use glob patterns, as well as of negations.\nIndirect definition of those commands by means of exclusion of a set of commands is trivial to bypass, so it is not allowed to use such constructs."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sudoers_no_root_target","kind":"notApplicable","level":"none","message":{"text":"The targeted users of a user specification should be, as much as possible, non privileged users (i.e.: non-root).\n\nUser specifications have to explicitly list the runas spec (i.e. the list of target users that can be impersonated), andorshould not be used."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_gnutls-utils_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_nss-tools_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_clean_components_post_updating","kind":"notApplicable","level":"none","message":{"text":"should be configured to remove previous software components after\nnew versions have been installed. To configureto remove the\n\nprevious software components after updating, set theandtoin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_prefer_64bit_os","kind":"notApplicable","level":"none","message":{"text":"Prefer installation of 64-bit operating systems when the CPU supports it."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_banner_enabled","kind":"notApplicable","level":"none","message":{"text":"In the default graphical environment, displaying a login warning banner\nin the GNOME Display Manager's login screen can be enabled on the login\nscreen by settingto.To enable, add or editto. For example:Once the setting has been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run.\nThe banner text must also be set."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dconf_gnome_login_banner_text","kind":"notApplicable","level":"none","message":{"text":"In the default graphical environment, configuring the login warning banner text\nin the GNOME Display Manager's login screen can be configured on the login\nscreen by settingtowhereis the approved banner for your environment.To enable, add or editto. For example:After the settings have been set, run.\nWhen entering a warning banner that spans several lines, remember\nto begin and end the string withand usefor new lines."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_banner_etc_issue","kind":"notApplicable","level":"none","message":{"text":"To configure the system login banner edit. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\n\nThe DoD required text is either:OR:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_banner_etc_issue_net","kind":"notApplicable","level":"none","message":{"text":"To configure the system login banner edit. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\nThe DoD required text is either:OR:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_banner_etc_motd","kind":"notApplicable","level":"none","message":{"text":"To configure the system message banner edit. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\nThe DoD required text is either:OR:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue_net","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_motd","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_issue","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_issue_net","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_motd","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_issue","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_issue_net","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_motd","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_account_passwords_pam_faillock_audit","kind":"notApplicable","level":"none","message":{"text":"PAM faillock locks an account due to excessive password failures, this event must be logged."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_account_passwords_pam_faillock_dir","kind":"notApplicable","level":"none","message":{"text":"By setting a `dir` in the faillock configuration account lockouts will persist across reboots."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember","kind":"notApplicable","level":"none","message":{"text":"Do not allow users to reuse recent passwords. This can be accomplished by using theoption for theorPAM modules."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_audit","kind":"notApplicable","level":"none","message":{"text":"PAM faillock locks an account due to excessive password failures, this event must be logged."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny","kind":"notApplicable","level":"none","message":{"text":"This rule configures the system to lock out accounts after a number of incorrect login attempts\nusing.\npam_faillock.so module requires multiple entries in pam files. These entries must be carefully\ndefined to work as expected.\n\nEnsure that the filecontains the following entry:Where count should be less than or equal toand greater than 0."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_interval","kind":"notApplicable","level":"none","message":{"text":"Utilizing, thedirective configures the system\nto lock out an account after a number of incorrect login attempts within a specified time\nperiod.\n\nEnsure that the filecontains the following entry:whereisor greater."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time","kind":"notApplicable","level":"none","message":{"text":"This rule configures the system to lock out accounts during a specified time period after a\nnumber of incorrect login attempts using.\n\n\nEnsure that the filecontains the following entry:whereisor greater.\n\n\npam_faillock.so module requires multiple entries in pam files. These entries must be carefully\ndefined to work as expected. In order to avoid any errors when manually editing these files,\nit is recommended to use the appropriate tools, such asor,\ndepending on the OS version.\n\nIfis set to, manual intervention by an administrator is required\nto unlock a user. This should be done using thetool."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit","kind":"notApplicable","level":"none","message":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of digits in a password. When set to a negative number, any password will be required to\ncontain that many digits. When set to a positive number, pam_pwquality will grant +1 additional\nlength credit for each digit. Modify thesetting into require the use of a digit in passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit","kind":"notApplicable","level":"none","message":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of lowercase letters in a password. When set to a negative number, any password will be required to\ncontain that many lowercase characters. When set to a positive number, pam_pwquality will grant +1 additional\nlength credit for each lowercase character. Modify thesetting into require the use of a lowercase character in passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass","kind":"notApplicable","level":"none","message":{"text":"The pam_pwquality module'sparameter controls\nrequirements for usage of different character classes, or types, of character\nthat must exist in a password before it is considered valid. For example,\nsetting this value to three (3) requires that any password must have characters\nfrom at least three different categories in order to be approved. The default\nvalue is zero (0), meaning there are no required classes. There are four\ncategories available:Modify thesetting inentry\nto requirediffering categories of characters when changing passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen","kind":"notApplicable","level":"none","message":{"text":"The pam_pwquality module'sparameter controls requirements for\nminimum characters required in a password. Addafter pam_pwquality to set minimum password length requirements."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit","kind":"notApplicable","level":"none","message":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of special (or \"other\") characters in a password. When set to a negative number,\nany password will be required to contain that many special characters.\nWhen set to a positive number, pam_pwquality will grant +1\nadditional length credit for each special character. Modify thesetting\ninto equalto require use of a special character in passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_retry","kind":"notApplicable","level":"none","message":{"text":"To configure the number of retry prompts that are permitted per-session:\n\nEdit thestatement into show, or a lower value if site\npolicy is more restrictive. The DoD requirement is a maximum of 3 prompts\nper session."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit","kind":"notApplicable","level":"none","message":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of uppercase letters in a password. When set to a negative number, any password will be required to\ncontain that many uppercase characters. When set to a positive number, pam_pwquality will grant +1 additional\nlength credit for each uppercase character. Modify thesetting into require the use of an uppercase character in passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs","kind":"notApplicable","level":"none","message":{"text":"In, add or correct the following line to ensure\nthe system will useas the hashing algorithm:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_disallow_bypass_password_sudo","kind":"notApplicable","level":"none","message":{"text":"Verify the operating system is not configured to bypass password requirements for privilege\nescalation. Check the configuration of the \"/etc/pam.d/sudo\" file with the following command:If any occurrences of \"pam_succeed_if\" is returned from the command, this is a finding."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_display_login_attempts","kind":"notApplicable","level":"none","message":{"text":"To configure the system to notify users of last logon/access\nusing, add or correct thesettings into read as follows:And make sure that theoption is not set formodule."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_burstaction","kind":"notApplicable","level":"none","message":{"text":"By default,will reboot the system if thekey sequence is pressed Ctrl-Alt-Delete more than 7 times in 2 seconds.To configure the system to ignore thesetting, add or modify the following to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_reboot","kind":"notApplicable","level":"none","message":{"text":"By default,will reboot the system if thekey sequence is pressed.To configure the system to ignore thekey sequence from the\n\ncommand line instead of rebooting the system, do either of the following:orDo not simply delete thefile,\nas this file may be restored during future system updates."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration","kind":"notApplicable","level":"none","message":{"text":"To specify the number of days after a password expires (which\nsignifies inactivity) until an account is permanently disabled, add or correct\nthe following line in:If a password is currently on the verge of expiration, thenday(s) remain(s) until the account is automatically\ndisabled. However, if the password will not expire for another 60 days, then 60\ndays plusday(s) could\nelapse until the account would be automatically disabled. See theman page for more information."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_account_unique_name","kind":"pass","level":"none","message":{"text":"Ensure accounts on the system have unique names.\n\nTo ensure all accounts have unique names, run the following command:If a username is returned, change or delete the username."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_account_use_centralized_automated_auth","kind":"notApplicable","level":"none","message":{"text":"Implement an automated system for managing user accounts that minimizes the\nrisk of errors, either intentional or deliberate. This system\nshould integrate with an existing enterprise user management system, such as\none based on Identity Management tools such as Active Directory, Kerberos,\nDirectory Server, etc."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ensure_shadow_group_empty","kind":"pass","level":"none","message":{"text":"The shadow group allows system programs which require access the ability\nto read the /etc/shadow file. No users should be assigned to the shadow group."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_policy_temp_passwords_immediate_change","kind":"notApplicable","level":"none","message":{"text":"Temporary passwords for Ubuntu 22.04 operating system logons must\nrequire an immediate change to a permanent password.\n\nVerify that a policy exists that ensures when a user is created, it is\ncreating using a method that forces a user to change their password upon\ntheir next login."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs","kind":"notApplicable","level":"none","message":{"text":"To specify password maximum age for new accounts,\nedit the fileand add or correct the following line:A value of 180 days is sufficient for many environments.\nThe DoD requirement is 60.\nThe profile requirement is."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_minimum_age_login_defs","kind":"notApplicable","level":"none","message":{"text":"To specify password minimum age for new accounts,\nedit the fileand add or correct the following line:A value of 1 day is considered sufficient for many\nenvironments. The DoD requirement is 1.\nThe profile requirement is."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_minlen_login_defs","kind":"notApplicable","level":"none","message":{"text":"To specify password length requirements for new accounts, edit the fileand add or correct the following line:The DoD requirement is.\nThe FISMA requirement is.\nThe profile requirement is.\nIf a program consultsand also another PAM module\n(such as) during a password change operation, then\nthe most restrictive must be satisfied. See PAM section for more\ninformation about enforcing password quality requirements."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_set_max_life_existing","kind":"pass","level":"none","message":{"text":"Configure non-compliant accounts to enforce a-day maximum password lifetime\nrestriction by running the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_set_min_life_existing","kind":"pass","level":"none","message":{"text":"Configure non-compliant accounts to enforce a 24 hours/1 day minimum password\nlifetime by running the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs","kind":"notApplicable","level":"none","message":{"text":"To specify how many days prior to password\nexpiration that a warning will be issued to users,\nedit the fileand add or correct\n the following line:The DoD requirement is 7.\nThe profile requirement is."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed","kind":"notApplicable","level":"none","message":{"text":"If any password hashes are stored in(in the second field,\ninstead of anor), the cause of this misconfiguration should be\ninvestigated. The account should have its password reset and the hash should be\nproperly stored, or the account should be deleted entirely."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_password_last_change_is_in_past","kind":"notApplicable","level":"none","message":{"text":"All users should have a password change date in the past."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_gid_passwd_group_same","kind":"pass","level":"none","message":{"text":"Add a group to the system for each GID referenced without a corresponding group."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_empty_passwords","kind":"notApplicable","level":"none","message":{"text":"If an account is configured for password authentication\nbut does not have an assigned password, it may be possible to log\ninto the account without authentication. Remove any instances of theinandto prevent logins with empty passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_empty_passwords_etc_shadow","kind":"notApplicable","level":"none","message":{"text":"Check the \"/etc/shadow\" file for blank passwords with the\nfollowing command:If the command returns any results, this is a finding.\nConfigure all accounts on the system to have a password or lock\nthe account with the following commands:\nPerform a password reset:Lock an account:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_netrc_files","kind":"pass","level":"none","message":{"text":"Thefiles contain login information\nused to auto-login into FTP servers and reside in the user's home\ndirectory. These files may contain unencrypted passwords to\nremote FTP servers making them susceptible to access by unauthorized\nusers and should not be used.  Anyfiles should be removed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero","kind":"pass","level":"none","message":{"text":"If any account other than root has a UID of 0, this misconfiguration should\nbe investigated and the accounts other than root should be removed or have\ntheir UID changed.If the account is associated with system commands or applications the UID\nshould be changed to one greater than \"0\" but less than \"1000.\"\nOtherwise assign a UID greater than \"1000\" that has not already been\nassigned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_root_gid_zero","kind":"pass","level":"none","message":{"text":"Theuser should have a primary group of 0."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ensure_pam_wheel_group_empty","kind":"notApplicable","level":"none","message":{"text":"Ensure that the groupreferenced by the pam_wheelparameter exists and has no\nmembers. This ensures that no user can run commands with altered\nprivileges through thecommand."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ensure_root_password_configured","kind":"notApplicable","level":"none","message":{"text":"Single user mode is used for recovery when the system detects an\nissue during boot or by manual selection from the bootloader."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_direct_root_logins","kind":"notApplicable","level":"none","message":{"text":"To further limit access to theaccount, administrators\ncan disable root logins at the console by editing thefile.\nThis file lists all devices the root user is allowed to login to. If the file does\nnot exist at all, the root user can login through any communication device on the\nsystem, whether via the console or via a raw network interface. This is dangerous\nas user can login to the system as root via Telnet, which sends the password in\nplain text over the network. By default, Ubuntu 22.04'sfile only allows the root user to login at the console\nphysically attached to the system. To prevent root from logging in, remove the\ncontents of this file. To prevent direct root logins, remove the contents of this\nfile by typing the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_password_auth_for_systemaccounts","kind":"notApplicable","level":"none","message":{"text":"Some accounts are not associated with a human user of the system, and exist to perform some\nadministrative functions. An attacker should not be able to log into these accounts.System accounts are those user accounts with a user ID less than.\nIf any system account other than,,,andhas an unlocked password, disable it with the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts","kind":"pass","level":"none","message":{"text":"Some accounts are not associated with a human user of the system, and exist to perform some\nadministrative functions. Should an attacker be able to log into these accounts, they should\nnot be granted access to a shell.The login shell for each local account is stored in the last field of each line in. System accounts are those user accounts with a user ID less than. The user ID is stored in the third field. If any system account\nother thanhas a login shell, disable it with the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_prevent_direct_root_logins","kind":"notApplicable","level":"none","message":{"text":"Configure the operating system to prevent direct logins to theaccount by performing the following operations:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_restrict_serial_port_logins","kind":"notApplicable","level":"none","message":{"text":"To restrict root logins on serial ports,\nensure lines of this form do not appear in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_securetty_root_login_console_only","kind":"notApplicable","level":"none","message":{"text":"To restrict root logins through the (deprecated) virtual console devices,\nensure lines of this form do not appear in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_use_pam_wheel_group_for_su","kind":"notApplicable","level":"none","message":{"text":"To ensure that only users who are members of the group set in thepam_wheel parameter can run commands with altered\nprivileges through thecommand, make sure that the\nfollowing line exists in the file:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_account_unique_id","kind":"notApplicable","level":"none","message":{"text":"Change user IDs (UIDs), or delete accounts, so each has a unique name."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_group_unique_id","kind":"pass","level":"none","message":{"text":"Change the group name or delete groups, so each has a unique id."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_group_unique_name","kind":"pass","level":"none","message":{"text":"Change the group name or delete groups, so each has a unique name."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_root_path_dirs_no_write","kind":"pass","level":"none","message":{"text":"For each element in root's path, run:and ensure that write permissions are disabled for group and\nother."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_root_path_no_dot","kind":"notApplicable","level":"none","message":{"text":"Ensure that none of the directories in root's path is equal to a singlecharacter, or\nthat it contains any instances that lead to relative path traversal, such asor beginning a path without the slash () character.\nAlso ensure that there are no \"empty\" elements in the path, such as in these examples:These empty elements have the same effect as a singlecharacter."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc","message":{"text":"To ensure the default umask for users of the Bash shell is set properly,\nadd or correct thesetting into read\nas follows:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}],"rank":0.5},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs","kind":"notApplicable","level":"none","message":{"text":"To ensure the default umask controlled byis set properly,\nadd or correct thesetting into read as follows:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile","message":{"text":"To ensure the default umask controlled byis set properly,\nadd or correct thesetting into read as follows:Note thatalso reads scrips withindirectory.\nThese scripts are also valid files to set umask value. Therefore, they should also be\nconsidered during the check and properly remediated, if necessary."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}],"rank":0.5},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_umask_interactive_users","kind":"pass","level":"none","message":{"text":"Remove theenvironment variable from all interactive users initialization files."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_logon_fail_delay","kind":"notApplicable","level":"none","message":{"text":"To ensure the logon failure delay controlled byis set properly,\nadd or correct thesetting into read as follows:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_max_concurrent_login_sessions","kind":"notApplicable","level":"none","message":{"text":"Limiting the number of allowed users and sessions per user can limit risks related to Denial of\nService attacks. This addresses concurrent sessions for a single account and does not address\nconcurrent sessions by a single user via multiple accounts. To set the number of concurrent\nsessions per user add the following line inor\na file under:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_polyinstantiated_tmp","kind":"notApplicable","level":"none","message":{"text":"To configure polyinstantiated /tmp directories, first create the parent directories\nwhich will hold the polyinstantiation child directories. Use the following command:Then, add the following entry to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_polyinstantiated_var_tmp","kind":"notApplicable","level":"none","message":{"text":"To configure polyinstantiated /tmp directories, first create the parent directories\nwhich will hold the polyinstantiation child directories. Use the following command:Then, add the following entry to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_tmout","kind":"notApplicable","level":"none","message":{"text":"Setting theoption inensures that\nall user sessions will terminate based on inactivity.\nThe value of TMOUT should be exported and read only.\nThesetting in a file loaded by, e.g.should read as follows:readonly TMOUT\nexport TMOUT."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_user_dot_group_ownership","kind":"pass","level":"none","message":{"text":"Change the group owner of interactive users files to the group found\ninfor the user. To change the group owner of a local\ninteractive user home directory, use the following command:This rule ensures every initialization file related to an interactive user\nis group-owned by an interactive user."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_user_dot_no_world_writable_programs","kind":"pass","level":"none","message":{"text":"Set the mode on files being executed by the user initialization files with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_user_dot_user_ownership","kind":"pass","level":"none","message":{"text":"Set the owner of the user initialization files for interactive users to\nthe primary owner with the following command:This rule ensures every initialization file related to an interactive user\nis owned by an interactive user."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_accounts_user_interactive_home_directory_exists","kind":"pass","level":"none","message":{"text":"Create home directories to all local interactive users that currently do not\nhave a home directory assigned. Use the following commands to create the user\nhome directory assigned in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupownership_home_directories","kind":"pass","level":"none","message":{"text":"Change the group owner of interactive users home directory to the\ngroup found in. To change the group owner of\ninteractive users home directory, use the following command:This rule ensures every home directory related to an interactive user is\ngroup-owned by an interactive user. It also ensures that interactive users\nare group-owners of one and only one home directory."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_home_directories","kind":"pass","level":"none","message":{"text":"Change the owner of interactive users home directories to that correct\nowner. To change the owner of a interactive users home directory, use\nthe following command:This rule ensures every home directory related to an interactive user is\nowned by an interactive user. It also ensures that interactive users are\nowners of one and only one home directory."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_home_directories","kind":"pass","level":"none","message":{"text":"Change the mode of interactive users home directories to. To\nchange the mode of interactive users home directory, use the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_home_dirs","kind":"notApplicable","level":"none","message":{"text":"For each human user of the system, view the\npermissions of the user's home directory:Ensure that the directory is not group-writable and that it\nis not world-readable. If necessary, repair the permissions:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chmod","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chown","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmod","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmodat","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchown","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchownat","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fremovexattr","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root.If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fsetxattr","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lchown","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lremovexattr","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root.If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lsetxattr","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_removexattr","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root.If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default), add the\nfollowing line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_setxattr","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_umount","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file system umount\nchanges. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_umount2","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file system umount2\nchanges. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_execution_chacl","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_execution_setfacl","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_execution_chcon","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rename","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_renameat","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rmdir","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlink","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlinkat","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_creat","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_ftruncate","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_truncate","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_delete","kind":"notApplicable","level":"none","message":{"text":"To capture kernel module unloading events, use following line, setting ARCH to\neither b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:Place to add the line depends on a waydaemon is configured. If it is configured\nto use theprogram (the default), add the line to a file with suffixin the directory.\n\nIf thedaemon is configured to use theutility,\nadd the line to file."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_finit","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram\nto read audit rules during daemon startup (the default), add the following lines to a file\nwith suffixin the directoryto capture kernel module\nloading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:If thedaemon is configured to use theutility to read audit\nrules during daemon startup, add the following lines tofile\nin order to capture kernel module loading and unloading events, setting ARCH to either b32 or\nb64 as appropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_init","kind":"notApplicable","level":"none","message":{"text":"To capture kernel module loading events, use following line, setting ARCH to\neither b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:Place to add the line depends on a waydaemon is configured. If it is configured\nto use theprogram (the default), add the line to a file with suffixin the directory.\n\nIf thedaemon is configured to use theutility,\nadd the line to file."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_login_events_faillog","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects login information for all users\nand root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing logon events:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for unattempted manual\nedits of files involved in storing logon events:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_login_events_lastlog","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects login information for all users\nand root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing logon events:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for unattempted manual\nedits of files involved in storing logon events:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_login_events_tallylog","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects login information for all users\nand root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing logon events:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for unattempted manual\nedits of files involved in storing logon events:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_init","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_poweroff","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_reboot","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_shutdown","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands","kind":"notApplicable","level":"none","message":{"text":"The audit system should collect information about usage of privileged commands for all users.\nThese are commands with suid or sgid bits on and they are specially risky in local block\ndevice partitions not mounted with noexec and nosuid options. Therefore, these partitions\nshould be first identified by the following command:For all partitions listed by the previous command, it is necessary to search for\nsetuid / setgid programs using the following command:For each setuid / setgid program identified by the previous command, an audit rule must be\npresent in the appropriate place using the following line structure:If thedaemon is configured to use theprogram to read\naudit rules during daemon startup, add the line to a file with suffixin thedirectory, replacing thepart with the full path\nof that setuid / setgid identified program.\n\nIf thedaemon is configured to use theutility instead, add\nthe line to thefile, also replacing thepart\nwith the full path of that setuid / setgid identified program."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_apparmor_parser","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If\nthedaemon is configured to use theprogram to read audit rules during daemon startup (the default), add\nthe following lines to a file with suffixin the\ndirectory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following\nlines tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_at","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chage","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chfn","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chsh","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_crontab","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_fdisk","kind":"notApplicable","level":"none","message":{"text":"Configure the operating system to audit the execution of the partition\nmanagement program \"fdisk\"."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_gpasswd","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_insmod","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_kmod","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_modprobe","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_mount","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newgidmap","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newgrp","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newuidmap","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_pam_timestamp_check","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_passwd","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_postdrop","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_postqueue","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_rmmod","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_ssh_agent","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_ssh_keysign","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_su","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sudo","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sudoedit","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_umount","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_unix_chkpwd","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_unix_update","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_usermod","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_time_adjtimex","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:The -k option allows for the specification of a key in string form that can be\nused for better reporting capability through ausearch and aureport. Multiple\nsystem calls can be defined on the same line to save space if desired, but is\nnot required. See an example of multiple combined syscalls:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_time_clock_settime","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:The -k option allows for the specification of a key in string form that can\nbe used for better reporting capability through ausearch and aureport.\nMultiple system calls can be defined on the same line to save space if\ndesired, but is not required. See an example of multiple combined syscalls:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_time_settimeofday","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:The -k option allows for the specification of a key in string form that can be\nused for better reporting capability through ausearch and aureport. Multiple\nsystem calls can be defined on the same line to save space if desired, but is\nnot required. See an example of multiple combined syscalls:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_time_stime","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectoryfor both 32 bit and 64 bit systems:Since the 64 bit version of the \"stime\" system call is not defined in the audit\nlookup table, the corresponding \"-F arch=b64\" form of this rule is not expected\nto be defined on 64 bit systems (the aforementioned \"-F arch=b32\" stime rule\nform itself is sufficient for both 32 bit and 64 bit systems). If thedaemon is configured to use theutility to\nread audit rules during daemon startup, add the following line tofile for both 32 bit and 64 bit systems:Since the 64 bit version of the \"stime\" system call is not defined in the audit\nlookup table, the corresponding \"-F arch=b64\" form of this rule is not expected\nto be defined on 64 bit systems (the aforementioned \"-F arch=b32\" stime rule\nform itself is sufficient for both 32 bit and 64 bit systems). The -k option\nallows for the specification of a key in string form that can be used for\nbetter reporting capability through ausearch and aureport. Multiple system\ncalls can be defined on the same line to save space if desired, but is not\nrequired. See an example of multiple combined system calls:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_time_watch_localtime","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default),\nadd the following line to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:The -k option allows for the specification of a key in string form that can\nbe used for better reporting capability through ausearch and aureport and\nshould always be used."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_immutable","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectoryin order to make the auditd configuration\nimmutable:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile in order to make the auditd configuration\nimmutable:With this setting, a reboot will be required to change any audit rules."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_mac_modification","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_mac_modification_usr_share","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_media_export","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect media exportation\nevents for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_session_events","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_session_events_btmp","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_session_events_utmp","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_session_events_wtmp","kind":"notApplicable","level":"none","message":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_suid_privilege_function","kind":"notApplicable","level":"none","message":{"text":"Verify the system generates an audit record when privileged functions are executed.\n\nIf audit is using the \"auditctl\" tool to load the rules, run the following command:If audit is using the \"augenrules\" tool to load the rules, run the following command:If both the \"b32\" and \"b64\" audit rules for \"SUID\" files are not defined, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules for \"SGID\" files are not defined, this is a finding."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_sysadmin_actions","kind":"notApplicable","level":"none","message":{"text":"At a minimum, the audit system should collect administrator actions\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default),\nadd the following line to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_group","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_gshadow","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_opasswd","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_passwd","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_shadow","kind":"notApplicable","level":"none","message":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_audit_sudo_log_events","kind":"notApplicable","level":"none","message":{"text":"The Ubuntu 22.04 operating system must generate audit records for\nprivileged activities, nonlocal maintenance, diagnostic sessions and\nother system-level access.\n\nVerify the operating system audits activities performed during nonlocal\nmaintenance and diagnostic sessions. Run the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_directory_access_var_log_audit","kind":"notApplicable","level":"none","message":{"text":"The audit system should collect access events to read audit log directory.\nThe following audit rule will assure that access to audit log directory are\ncollected.If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default), add the\nrule to a file with suffixin the directory.\nIf thedaemon is configured to use theutility to read audit rules during daemon startup, add the rule tofile."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_directory_permissions_var_log_audit","kind":"notApplicable","level":"none","message":{"text":"Ifinis set to a group other than thegroup account, change the mode of the audit log files with the following command:Otherwise, change the mode of the audit log files with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_group_ownership_var_log_audit","kind":"notApplicable","level":"none","message":{"text":"All audit logs must be group owned by root user. The path for audit log can\nbe configured viaparameter inor, by default, the path for audit log is.\n\nTo properly set the group owner of, run the command:Ifinis set to a group other\nthan thegroup account, change the group ownership of the audit logs\nto this specific group."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupownership_audit_configuration","kind":"notApplicable","level":"none","message":{"text":"All audit configuration files must be owned by group root."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_audit_configuration","kind":"notApplicable","level":"none","message":{"text":"All audit configuration files must be owned by root user.\n\nTo properly set the owner of, run the command:To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit","kind":"notApplicable","level":"none","message":{"text":"All audit logs must be owned by root user and group. By default, the path for audit log is.\n\nTo properly set the owner of, run the command:To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit_stig","kind":"notApplicable","level":"none","message":{"text":"All audit logs must be owned by root user. The path for audit log can be\nconfigured viaparameter inor by default, the path for audit log is.\n\nTo properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_audit_configuration","kind":"notApplicable","level":"none","message":{"text":"All audit configuration files permissions must be 640 or more restrictive."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit","kind":"notApplicable","level":"none","message":{"text":"Ifinis set to a group other than thegroup account, change the mode of the audit log files with the following command:Otherwise, change the mode of the audit log files with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_audispd_configure_remote_server","kind":"notApplicable","level":"none","message":{"text":"Configure the audispd plugin to off-load audit records onto a different\nsystem or media from the system being audited.\n\nFirst, set theoption inSet theoption inwith an IP address or hostname of the system that the audispd plugin should\nsend audit records to. For example."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_audispd_configure_sufficiently_large_partition","kind":"notApplicable","level":"none","message":{"text":"The Ubuntu 22.04 operating system must allocate audit record storage\ncapacity to store at least one weeks worth of audit records when audit\nrecords are not immediately sent to a central audit record storage\nfacility.\n\nThe partition size needed to capture a week's worth of audit records is\nbased on the activity level of the system and the total storage capacity\navailable. In normal circumstances, 10.0 GB of storage space for audit\nrecords will be sufficient.\n\nDetermine which partition the audit records are being written to with the\nfollowing command:Check the size of the partition that audit records are written to with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_audispd_syslog_plugin_activated","kind":"notApplicable","level":"none","message":{"text":"To configure theservice to use theplug-in of theaudit event multiplexor, set\ntheline into.\nRestart theservice:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_disk_error_action","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen there is a disk error.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_disk_error_action_stig","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen there is a disk error.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_disk_full_action","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_disk_full_action_stig","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_action_mail_acct","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to send email to\na designated account in certain situations. Add or correct the following line\ninto ensure that administrators are notified\nvia email for those situations:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_action","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single user\nmode for corrective action. Acceptable values also includeand. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_percentage","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to perform an action."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file","kind":"notApplicable","level":"none","message":{"text":"Determine the amount of audit data (in megabytes)\nwhich should be retained in each log file. Edit the file. Add or modify the following line, substituting\nthe correct value offor:Set the value to(MB) or higher for general-purpose systems.\nLarger values, of course,\nsupport retention of even more audit data."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action","kind":"notApplicable","level":"none","message":{"text":"The default action to take when the logs reach their maximum size\nis to rotate the log files, discarding the oldest one. To configure the action taken\nby, add or correct the line in:Possible values forare described in theman\npage. These include:Set thetoto ensure log rotation\noccurs. This is the default. The setting is case-insensitive."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action_stig","kind":"notApplicable","level":"none","message":{"text":"The default action to take when the logs reach their maximum size\nis to rotate the log files, discarding the oldest one. To configure the action taken\nby, add or correct the line in:Possible values forare described in theman\npage. These include:Set thetoto ensure log rotation\noccurs. This is the default. The setting is case-insensitive."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_num_logs","kind":"notApplicable","level":"none","message":{"text":"Determine how many log filesshould retain when it rotates logs.\nEdit the file. Add or modify the following\nline, substitutingwith the correct value of:Set the value to 5 for general-purpose systems.\nNote that values less than 2 result in no log rotation."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_action","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen disk spaceto run low.\nEdit the file. Modify the following line,\nsubstitutingappropriately:Possible values forare described in theman page.\nThese include:Set this to(instead of the default,\nwhich is) as it is more likely to get prompt attention. Acceptable values\nalso include,, and."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_percentage","kind":"notApplicable","level":"none","message":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value to at least 25 to cause the system to\nnotify the user of an issue."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_freq","kind":"notApplicable","level":"none","message":{"text":"To configure Audit daemon to issue an explicit flush to disk command\nafter writingrecords, settoin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_local_events","kind":"notApplicable","level":"none","message":{"text":"To configure Audit daemon to include local events in Audit logs, settoin.\nThis is the default setting."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_log_format","kind":"notApplicable","level":"none","message":{"text":"To configure Audit daemon to resolve all uid, gid, syscall,\narchitecture, and socket address information before writing the\nevents to disk, settoin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_name_format","kind":"notApplicable","level":"none","message":{"text":"To configure Audit daemon to use value returned by gethostname\nsyscall as computer node name in the audit events,\nsettoin."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_offload_logs","kind":"notApplicable","level":"none","message":{"text":"The operating system must have a crontab script running weekly to\noffload audit events of standalone systems."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_overflow_action","kind":"notApplicable","level":"none","message":{"text":"The audit system should have an action setup in the event the internal event queue becomes full.\nTo setup an overflow action edit. Setto one of the following values:,,."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_auditd_write_logs","kind":"notApplicable","level":"none","message":{"text":"To configure Audit daemon to write Audit logs to the disk, settoin.\nThis is the default setting."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_audit-audispd-plugins_installed","kind":"notApplicable","level":"none","message":{"text":"The audit-audispd-plugins package should be installed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_audit_installed","kind":"notApplicable","level":"none","message":{"text":"The audit package should be installed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_auditd_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice is an essential userspace component of\nthe Linux Auditing System, as it is responsible for writing audit records to\ndisk.\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_audit_argument","kind":"notApplicable","level":"none","message":{"text":"To ensure all processes can be audited, even those which start\nprior to the audit daemon, add the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_audit_backlog_limit_argument","kind":"notApplicable","level":"none","message":{"text":"To improve the kernel capacity to queue all log events, even those which occurred\nprior to the audit daemon, add the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_apparmor_installed","kind":"notApplicable","level":"none","message":{"text":"AppArmor provide Mandatory Access Controls."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_all_apparmor_profiles_enforced","kind":"notApplicable","level":"none","message":{"text":"AppArmor profiles define what resources applications are able to access.\nTo set all profiles to enforce mode run the following command:To list unconfined processes run the following command:Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_all_apparmor_profiles_in_enforce_complain_mode","kind":"notApplicable","level":"none","message":{"text":"AppArmor profiles define what resources applications are able to access.\nTo set all profiles to eitherormode\nrun the following command to set all profiles tomode:run the following command to set all profiles tomode:To list unconfined processes run the following command:Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_apparmor_configured","kind":"notApplicable","level":"none","message":{"text":"Verify that the Apparmor tool is configured to\ncontrol whitelisted applications and user home directory access\ncontrol.Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_enable_apparmor","kind":"notApplicable","level":"none","message":{"text":"Configure AppArmor to be enabled at boot time and verify that it has not been\noverwritten by the bootloader boot parameters.\n\nNote: This recommendation is designed around the grub bootloader, if LILO or\nanother bootloader is in use in your environment, enact equivalent settings."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_grub2_cfg","kind":"notApplicable","level":"none","message":{"text":"The fileshould\nbe owned by theuser to prevent destruction\nor modification of the file.\n\nTo properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg","kind":"notApplicable","level":"none","message":{"text":"File permissions forshould be set to 600.\n\nTo properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_password","kind":"notApplicable","level":"none","message":{"text":"The grub2 boot loader should have a superuser account and password\nprotection enabled to protect boot-time settings.Since plaintext passwords are a security risk, generate a hash for the password\nby running the following command:When prompted, enter the password that was selected.Using the hash from the output, modify thefile with the following content:NOTE: the bootloader superuser account and password MUST differ from the\nroot account and password.\nOnce the superuser password has been added,\nupdate thefile by running:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_uefi_password","kind":"notApplicable","level":"none","message":{"text":"The grub2 boot loader should have a superuser account and password\nprotection enabled to protect boot-time settings.Since plaintext passwords are a security risk, generate a hash for the password\nby running the following command:When prompted, enter the password that was selected.Using the hash from the output, modify thefile with the following content:NOTE: the bootloader superuser account and password MUST differ from the\nroot account and password.\nOnce the superuser password has been added,\nupdate thefile by running:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_disable_recovery","kind":"notApplicable","level":"none","message":{"text":"Ubuntu 22.04 systems support an \"recovery boot\" option that can be used\nto prevent services from being started. Theconfiguration option inshould be set toto disable the generation of recovery mode menu entries. It is\nalso required to change the runtime configuration, run:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_enable_iommu_force","kind":"notApplicable","level":"none","message":{"text":"On x86 architecture supporting VT-d, the IOMMU manages the access control policy between the hardware devices and some\n    of the system critical units such as the memory.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_l1tf_argument","kind":"notApplicable","level":"none","message":{"text":"L1 Terminal Fault (L1TF) is a hardware vulnerability which allows unprivileged\nspeculative access to data which is available in the Level 1 Data Cache when\nthe page table entry isn't present.\n\nSelect the appropriate mitigation by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:Since Linux Kernel 4.19 you can check the L1TF vulnerability state with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_mce_argument","kind":"notApplicable","level":"none","message":{"text":"A Machine Check Exception is an error generated by the CPU itdetects an error\nin itself, memory or I/O devices.\nThese errors may be corrected and generate a check log entry, if an error\ncannot be corrected the kernel may panic or SIGBUS.\n\nTo force the kernel to panic on any uncorrected error reported by Machine Check\nset the MCE tolerance to zero by addingto the default GRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_nosmap_argument_absent","kind":"notApplicable","level":"none","message":{"text":"The SMAP is used to prevent the supervisor mode from unintentionally reading/writing into\nmemory pages in the user space, it is enabled by default since Linux kernel 3.7.\nBut it could be disabled through kernel boot parameters.\n\nEnsure that Supervisor Mode Access Prevention (SMAP) is not disabled by\ntheboot paramenter option.\n\nCheck that the linewithindoesn't contain the argument.\nRun the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_nosmep_argument_absent","kind":"notApplicable","level":"none","message":{"text":"The SMEP is used to prevent the supervisor mode from executing user space code,\nit is enabled by default since Linux kernel 3.0. But it could be disabled through\nkernel boot parameters.\n\nEnsure that Supervisor Mode Execution Prevention (SMEP) is not disabled by\ntheboot paramenter option.\n\nCheck that the linewithindoesn't contain the argument.\nRun the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_rng_core_default_quality_argument","kind":"notApplicable","level":"none","message":{"text":"The TPM security chip that is available in most modern systems has a hardware RNG.\nIt is also used to feed the entropy pool, but generally not credited entropy.\n\nUsein the kernel command line to set the trust\nlevel on the hardware generators. The trust level defines the amount of entropy to credit.\nA value oftells the system not to trust the hardware random number generators\navailable, and doesn't credit any entropy to the pool.\nA value ofassigns full confidence in the generators, and credits all the\nentropy it provides to the pool.\n\nNote that the value ofis global, affecting the trust\non all hardware random number generators.\n\nSelect the appropriate confidence by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_slab_nomerge_argument","kind":"notApplicable","level":"none","message":{"text":"The kernel may merge similar slabs together to reduce overhead and increase\ncache hotness of objects.\nDisabling merging of slabs keeps the slabs separate and reduces the risk of\nkernel heap overflows overwriting objects in merged caches.\n\nTo disable merging of slabs in the Kernel add the argumentto the default GRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_spec_store_bypass_disable_argument","kind":"notApplicable","level":"none","message":{"text":"Certain CPUs are vulnerable to an exploit against a common wide industry wide performance\noptimization known as Speculative Store Bypass (SSB).\n\nIn such cases, recent stores to the same memory location cannot always be observed by later\nloads during speculative execution. However, such stores are unlikely and thus they can be\ndetected prior to instruction retirement at the end of a particular speculation execution\nwindow.\n\nSince Linux Kernel 4.17 you can check the SSB mitigation state with the following command:Select the appropriate SSB state by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_spectre_v2_argument","kind":"notApplicable","level":"none","message":{"text":"Spectre V2 is an indirect branch poisoning attack that can lead to data leakage.\nAn exploit for Spectre V2 tricks the indirect branch predictor into executing\ncode from a future indirect branch chosen by the attacker, even if the privilege\nlevel is different.\n\nSince Linux Kernel 4.15 you can check the Spectre V2 mitigation state with the following command:Enforce the Spectre V2 mitigation by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_grub2_systemd_debug-shell_argument_absent","kind":"notApplicable","level":"none","message":{"text":"systemd'sservice is intended to\ndiagnose systemd related boot issues with variouscommands. Once enabled and following a system reboot, the root shell\nwill be available onwhich is access by pressing. Theservice should only be used\nfor systemd related issues and should otherwise be disabled.By default, thesystemd service is already disabled.\n\nEnsure the debug-shell is not enabled by theboot paramenter option.\n\nCheck that the linewithindoesn't contain the argument.\nRun the following command to update command line for already installed kernels:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_zipl_audit_argument","kind":"notApplicable","level":"none","message":{"text":"To ensure all processes can be audited, even those which start prior to the audit daemon,\ncheck that all boot entries inhaveincluded in its options.To ensure that new kernels and boot entries continue to enable audit,\naddto."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_zipl_audit_backlog_limit_argument","kind":"notApplicable","level":"none","message":{"text":"To improve the kernel capacity to queue all log events, even those which start prior to the audit daemon,\ncheck that all boot entries inhaveincluded in its options.To ensure that new kernels and boot entries continue to extend the audit log events queue,\naddto."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_disable_entropy_contribution_for_solid_state_drives","kind":"notApplicable","level":"none","message":{"text":"For each solid-state drive on the system, run:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_acpi_custom_method","kind":"notApplicable","level":"none","message":{"text":"This debug facility allows ACPI AML methods to be inserted and/or replaced without rebooting\nthe system.\nThis configuration is available from kernel 3.0.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_binfmt_misc","kind":"notApplicable","level":"none","message":{"text":"Enablingmakes it possible to plug wrapper-driven binary formats\ninto the kernel. This is specially useful for programs that need an interpreter to run like\nJava, Python and DOS emulators. Once you have registered such a binary class with the kernel,\nyou can start one of those programs simply by typing in its name at a shell prompt.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_bug","kind":"notApplicable","level":"none","message":{"text":"Disabling this option eliminates support for BUG and WARN, reducing the size of your kernel\nimage and potentially quietly ignoring numerous fatal conditions. You should only consider\ndisabling this option for embedded systems with no facilities for reporting errors.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_compat_brk","kind":"notApplicable","level":"none","message":{"text":"Enabling compatiliby withallows legacy binaries to run (i.e. those linked\nagainst libc5). But this compatibility comes at the cost of not being able to randomize\nthe heap placement (ASLR).\n\nUnless legacy binaries need to run on the system, setto.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_compat_vdso","kind":"notApplicable","level":"none","message":{"text":"Certain buggy versions of glibc (2.3.3) will crash if they are presented with a 32-bit vDSO\nthat is not mapped at the address indicated in its segment table.\nSettingtoturns off the 32-bit VDSO and works\naroud the glibc bug.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_debug_credentials","kind":"notApplicable","level":"none","message":{"text":"Enable this to turn on some debug checking for credential management. The additional code keeps\ntrack of the number of pointers from task_structs to any given cred struct, and checks to see\nthat this number never exceeds the usage count of the cred struct.\n\nFurthermore, if SELinux is enabled, this also checks that the security pointer in the cred\nstruct is never seen to be invalid.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_debug_fs","kind":"notApplicable","level":"none","message":{"text":"is a virtual file system that kernel developers use to put debugging files\ninto. Enable this option to be able to read and write to these files.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_debug_list","kind":"notApplicable","level":"none","message":{"text":"Enable this to turn on extended checks in the linked-list walking routines.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_debug_notifiers","kind":"notApplicable","level":"none","message":{"text":"Enable this to turn on sanity checking for notifier call chains. This is most useful for kernel\ndevelopers to make sure that modules properly unregister themselves from notifier chains.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_debug_sg","kind":"notApplicable","level":"none","message":{"text":"Scatter-gather tables are mechanism used for high performance I/O on DMA devices.\nEnable this to turn on checks on scatter-gather tables.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_default_mmap_min_addr","kind":"notApplicable","level":"none","message":{"text":"This is the portion of low virtual memory which should be protected from userspace allocation.\nThis configuration is available from kernel 3.14, but may be available if backported\nby distros.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"65536\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_devkmem","kind":"notApplicable","level":"none","message":{"text":"Disable support for the /dev/kmem device.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_hibernation","kind":"notApplicable","level":"none","message":{"text":"Enable the suspend to disk (STD) functionality, which is usually called \"hibernation\" in user\ninterfaces. STD checkpoints the system and powers it off; and restores that checkpoint on\nreboot.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_ia32_emulation","kind":"notApplicable","level":"none","message":{"text":"Disables support for legacy 32-bit programs under a 64-bit kernel.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_ipv6","kind":"notApplicable","level":"none","message":{"text":"Disable support for IP version 6 (IPv6).\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_kexec","kind":"notApplicable","level":"none","message":{"text":"is a system call that implements the ability to shutdown your current kernel,\nand to start another kernel. It is like a reboot but it is independent of the system firmware.\nAnd like a reboot you can start any kernel with it, not just Linux.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_legacy_ptys","kind":"notApplicable","level":"none","message":{"text":"Disable the Linux traditional BSD-like terminal names /dev/ptyxx for masters and /dev/ttyxx for\nslaves of pseudo terminals, and use only the modern ptys (devpts) interface.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig","kind":"notApplicable","level":"none","message":{"text":"Check modules for valid signatures upon load.\nNote that this option adds the OpenSSL development packages as a kernel build dependency so\nthat the signing tool can use its crypto library.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_all","kind":"notApplicable","level":"none","message":{"text":"Sign all modules during make modules_install. Without this option, modules must be signed\nmanually, using the scripts/sign-file tool.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_force","kind":"notApplicable","level":"none","message":{"text":"Reject unsigned modules or signed modules with an unknown key.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_hash","kind":"notApplicable","level":"none","message":{"text":"This configures the kernel to build and sign modules usingas the hash function.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_key","kind":"notApplicable","level":"none","message":{"text":"Setting this option to something other than its default ofwill\ndisable the autogeneration of signing keys and allow the kernel modules to be signed with a key\nof your choosing.\n\nThe string provided should identify a file containing both a private key and\nits corresponding X.509 certificate in PEM form, or — on systems where the OpenSSL ENGINE_pkcs11\nis functional — a PKCS#11 URI as defined by RFC7512. In the latter case, the PKCS#11 URI should\nreference both a certificate and a private key.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_sha512","kind":"notApplicable","level":"none","message":{"text":"This configures the kernel to build and sign modules using SHA512 as the hash function.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_page_poisoning_no_sanity","kind":"notApplicable","level":"none","message":{"text":"Skip the sanity checking on alloc, only fill the pages with poison on free. This reduces some\nof the overhead of the poisoning feature.\nThis configuration is available from kernel 4.6.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_page_poisoning_zero","kind":"notApplicable","level":"none","message":{"text":"Instead of using the existing poison value, fill the pages with zeros. This makes it harder to\ndetect when errors are occurring due to sanitization but the zeroing at free means that it is\nno longer necessary to write zeros when GFP_ZERO is used on allocation.\nThis configuration is available from kernel 4.19.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_page_table_isolation","kind":"notApplicable","level":"none","message":{"text":"This feature reduces the number of hardware side channels by ensuring that the majority of\nkernel addresses are not mapped into userspace.\nThis configuration is available from kernel 4.15, but may be available if backported\nby distros.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_panic_on_oops","kind":"notApplicable","level":"none","message":{"text":"Enable the kernel to panic when it oopses.\nThis has the same effect as setting oops=panic on the kernel command line.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_panic_timeout","kind":"notApplicable","level":"none","message":{"text":"Set the timeout value (in seconds) until a reboot occurs when the kernel panics.\nA timeout of 0 configures the system to wait forever. With a timeout value greater than 0,\nthe system will wait the specified amount of seconds before rebooting. While a timeout value\nless than 0 makes the system reboot immediately.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_proc_kcore","kind":"notApplicable","level":"none","message":{"text":"Provides a virtual ELF core file of the live kernel.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_randomize_base","kind":"notApplicable","level":"none","message":{"text":"In support of Kernel Address Space Layout Randomization (KASLR), this randomizes the physical\naddress at which the kernel image is decompressed and the virtual address where the kernel\nimage is mapped.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_randomize_memory","kind":"notApplicable","level":"none","message":{"text":"Randomizes the base virtual address of kernel memory sections (physical memory mapping,\nvmalloc & vmemmap).\nThis configuration is available from kernel 4.8, but may be available if backported\nby distros.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_retpoline","kind":"notApplicable","level":"none","message":{"text":"Compile kernel with the retpoline compiler options to guard against kernel-to-user data leaks\nby avoiding speculative indirect branches.\nRequires a compiler with -mindirect-branch=thunk-extern support for full protection.\nThe kernel may run slower.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_seccomp","kind":"notApplicable","level":"none","message":{"text":"This kernel feature is useful for number crunching applications that may need to compute\nuntrusted bytecode during their execution. By using pipes or other transports made available\nto the process as file descriptors supporting the read/write syscalls, it's possible to isolate\nthose applications in their own address space using seccomp.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_seccomp_filter","kind":"notApplicable","level":"none","message":{"text":"Enable tasks to build secure computing environments defined in terms of Berkeley Packet Filter\nprograms which implement task-defined system call filtering polices.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_security","kind":"notApplicable","level":"none","message":{"text":"This allows you to choose different security modules to be configured into your kernel.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_security_dmesg_restrict","kind":"notApplicable","level":"none","message":{"text":"Enforce restrictions on unprivileged users reading the kernel syslog via dmesg(8).\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_security_writable_hooks","kind":"notApplicable","level":"none","message":{"text":"Ensure kernel structures associated with LSMs are always mapped as read-only after system boot.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_security_yama","kind":"notApplicable","level":"none","message":{"text":"This enables support for LSM module Yama, which extends DAC support with additional system-wide\nsecurity settings beyond regular Linux discretionary access controls. The module will limit the\nuse of the system call.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_slub_debug","kind":"notApplicable","level":"none","message":{"text":"SLUB has extensive debug support features and this allows the allocator validation checking to\nbe enabled.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_syn_cookies","kind":"notApplicable","level":"none","message":{"text":"Normal TCP/IP networking is open to an attack known as SYN flooding.\nIt is denial-of-service attack that prevents legitimate remote users from being able to connect\nto your computer during an ongoing attack.\n\nWhen enabled the TCP/IP stack will use a cryptographic challenge protocol known as SYN cookies\nto enable legitimate users to continue to connect, even when your machine is under attack.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_unmap_kernel_at_el0","kind":"notApplicable","level":"none","message":{"text":"Speculation attacks against some high-performance processors can be used to bypass MMU\npermission checks and leak kernel data to userspace. This can be defended against by unmapping\nthe kernel when running in userspace, mapping it back in on exception entry via a trampoline\npage in the vector table.\nThis configuration is available from kernel 4.16, but may be available if backported\nby distros.\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_config_x86_vsyscall_emulation","kind":"notApplicable","level":"none","message":{"text":"Disabling it is roughly equivalent to booting with vsyscall=none, except that it will also\ndisable the helpful warning if a program tries to use a vsyscall. With this option set to N,\noffending programs will just segfault, citing addresses of the form 0xffffffffff600?00.\nThis configuration is available from kernel 3.19.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_actionsendstreamdriverauthmode","kind":"notApplicable","level":"none","message":{"text":"Rsyslogd is a system utility providing support for message logging. Support\nfor both internet and UNIX domain sockets enables this utility to support both local\nand remote logging.  Couple this utility with(which is a secure communications\nlibrary implementing the SSL, TLS and DTLS protocols), and you have a method to securely\nencrypt and off-load auditing.\n\nWhen usingto off-load logs the remote system must be authenticated."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_actionsendstreamdrivermode","kind":"notApplicable","level":"none","message":{"text":"Rsyslogd is a system utility providing support for message logging. Support\nfor both internet and UNIX domain sockets enables this utility to support both local\nand remote logging.  Couple this utility with(which is a secure communications\nlibrary implementing the SSL, TLS and DTLS protocols), and you have a method to securely\nencrypt and off-load auditing.\n\nWhen usingto off-load logs off a encrpytion system must be used."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_defaultnetstreamdriver","kind":"notApplicable","level":"none","message":{"text":"Rsyslogd is a system utility providing support for message logging. Support\nfor both internet and UNIX domain sockets enables this utility to support both local\nand remote logging.  Couple this utility with(which is a secure communications\nlibrary implementing the SSL, TLS and DTLS protocols), and you have a method to securely\nencrypt and off-load auditing.\n\nWhen usingto off-load logs off an encryption system must be used."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership","kind":"notApplicable","level":"none","message":{"text":"The group-owner of all log files written byshould be.\n\nThese log files are determined by the second part of each Rule line inand typically all appear in.\nFor each log filereferenced in,\nrun the following command to inspect the file's group owner:If the owner is not,\n\nrun the following command to\ncorrect this:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_files_ownership","kind":"notApplicable","level":"none","message":{"text":"The owner of all log files written byshould be.\n\nThese log files are determined by the second part of each Rule line inand typically all appear in.\nFor each log filereferenced in,\nrun the following command to inspect the file's owner:If the owner is not,\n\nrun the following command to\ncorrect this:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_files_permissions","kind":"notApplicable","level":"none","message":{"text":"The file permissions for all log files written byshould\nbe set to 640, or more restrictive. These log files are determined by the\nsecond part of each Rule line inand typically\nall appear in. For each log filereferenced in, run the following command to\ninspect the file's permissions:If the permissions are not 640 or more restrictive, run the following\ncommand to correct this:\"."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_remote_access_monitoring","kind":"notApplicable","level":"none","message":{"text":"Logging of remote access methods must be implemented to help identify cyber\nattacks and ensure ongoing compliance with remote access policies are being\naudited and upheld. An examples of a remote access method is the use of the\nRemote Desktop Protocol (RDP) from an external, non-organization controlled\nnetwork. Theorfile should contain a match for the following\nselectors:,, and. If\nnot, use the following as an example configuration:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_systemd-journal-remote_installed","kind":"notApplicable","level":"none","message":{"text":"Journald (via systemd-journal-remote ) supports the ability to send\nlog events it gathers to a remote log host or to receive messages\nfrom remote hosts, thus enabling centralised log management."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_systemd-journald_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice is an essential component of\nsystemd.\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_journald_compress","kind":"notApplicable","level":"none","message":{"text":"The journald system can compress large log files to avoid fill the system disk."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_journald_storage","kind":"notApplicable","level":"none","message":{"text":"The journald system may store log files in volatile memory or locally on disk.\nIf the logs are only stored in volatile memory they will we lost upon reboot."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_socket_systemd-journal-remote_disabled","kind":"notApplicable","level":"none","message":{"text":"Journald supports the ability to receive messages from remote hosts,\nthus acting as a log server. Clients should not receive data from\nother hosts.\nNOTE:\n    The same package, systemd-journal-remote , is used for both sending\n    logs to remote hosts and receiving incoming logs.\n    With regards to receiving logs, there are two Systemd unit files;\n    systemd-journal-remote.socket and systemd-journal-remote.service."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_logrotate_installed","kind":"notApplicable","level":"none","message":{"text":"logrotate is installed by default. Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ensure_logrotate_activated","kind":"notApplicable","level":"none","message":{"text":"Theutility allows for the automatic rotation of\nlog files.  The frequency of rotation is specified in,\nwhich triggers a cron task or a timer.  To configure logrotate to run daily, add or correct\nthe following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_timer_logrotate_enabled","kind":"notApplicable","level":"none","message":{"text":"Thetimer can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_syslogng_installed","kind":"notApplicable","level":"none","message":{"text":"syslog-ng can be installed in replacement of rsyslog.\nThepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_syslogng_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice (in replacement of rsyslog) provides syslog-style logging by default on Debian.\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_tcp","kind":"notApplicable","level":"none","message":{"text":"Thedaemon should not accept remote messages\nunless the system acts as a log server.\nIf the system needs to act as a central log server, add the following lines toto enable reception of messages over TCP:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_udp","kind":"notApplicable","level":"none","message":{"text":"Thedaemon should not accept remote messages\nunless the system acts as a log server.\nIf the system needs to act as a central log server, add the following lines toto enable reception of messages over UDP:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_nolisten","kind":"notApplicable","level":"none","message":{"text":"Thedaemon should not accept remote messages unless the system acts as a log\nserver. To ensure that it is not listening on the network, ensure any of the following lines\narefound inconfiguration files.\n\nIf using legacy syntax:If using RainerScript syntax:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_remote_loghost","kind":"notApplicable","level":"none","message":{"text":"To configure rsyslog to send logs to a remote log server,\nopenand read and understand the last section of the file,\nwhich describes the multiple directives necessary to activate remote\nlogging.\nAlong with these other directives, the system can be configured\nto forward its logs to a particular log server by\nadding or correcting one of the following lines,\nsubstitutingappropriately.\nThe choice of protocol depends on the environment of the system;\nalthough TCP and RELP provide more reliable message delivery,\nthey may not be supported in all environments.To use UDP for log message delivery:To use TCP for log message delivery:To use RELP for log message delivery:There must be a resolvable DNS CNAME or Alias record set to \"\" for logs to be sent correctly to the centralized logging utility."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_rsyslog_installed","kind":"notApplicable","level":"none","message":{"text":"Rsyslog is installed by default. Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_rsyslog_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice provides syslog-style logging by default on Ubuntu 22.04.\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ensure_rtc_utc_configuration","kind":"notApplicable","level":"none","message":{"text":"Ensure that the system real-time clock (RTC) is set to Coordinated Universal Time (UTC)."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_rsyslog_filecreatemode","kind":"notApplicable","level":"none","message":{"text":"rsyslog will create logfiles that do not already exist on the system.\nThis settings controls what permissions will be applied to these newly\ncreated files."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_ip6tables_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_iptables_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_ip6tables_default_rule","kind":"notApplicable","level":"none","message":{"text":"To set the default policy to DROP (instead of ACCEPT) for\nthe built-in INPUT chain which processes incoming packets,\nadd or correct the following line in:If changes were required, reload the ip6tables rules:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_ipv6_loopback_traffic","kind":"notApplicable","level":"none","message":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_loopback_traffic","kind":"notApplicable","level":"none","message":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ip6tables_rules_for_open_ports","kind":"review","level":"none","message":{"text":"Any ports that have been opened on non-loopback addresses\nneed firewall rules to govern traffic."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_iptables_rules_for_open_ports","kind":"review","level":"none","message":{"text":"Any ports that have been opened on non-loopback addresses\nneed firewall rules to govern traffic."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_iptables_default_rule","kind":"review","level":"none","message":{"text":"To set the default policy to DROP (instead of ACCEPT) for\nthe built-in INPUT chain which processes incoming packets,\nadd or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_iptables_default_rule_forward","kind":"notApplicable","level":"none","message":{"text":"To set the default policy to DROP (instead of ACCEPT) for\nthe built-in FORWARD chain which processes packets that will be forwarded from\none interface to another,\nadd or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_iptables-persistent_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_iptables_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_iptables-persistent_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_ipv6_option_disabled","kind":"notApplicable","level":"none","message":{"text":"To prevent the IPv6 kernel module () from binding to the\nIPv6 networking stack, add the following line to(or another file in):This permits the IPv6 module to be loaded (and thus satisfy other modules that\ndepend on it), while disabling support for the IPv6 protocol."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_disable_ipv6","kind":"notApplicable","level":"none","message":{"text":"To disable support for () addressing on all interface add the following line to(or another file in):This disables IPv6 on all network interfaces as other services and system\nfunctionality require the IPv6 stack loaded to work."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_disable_ipv6","kind":"notApplicable","level":"none","message":{"text":"To disable support for () addressing on interfaces by default add the following line to(or another file in):This disables IPv6 on network interfaces by default as other services and system\nfunctionality require the IPv6 stack loaded to work."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_ra","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_source_route","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_forwarding","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_ra","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_source_route","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_local","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_source_route","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_arp_filter","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_arp_ignore","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_log_martians","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_route_localnet","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_rp_filter","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_secure_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_shared_media","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_source_route","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_log_martians","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_rp_filter","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_secure_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_shared_media","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_echo_ignore_broadcasts","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_ignore_bogus_error_responses","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_syncookies","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_send_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_send_redirects","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_ip_forward","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_nftables_installed","kind":"notApplicable","level":"none","message":{"text":"nftables provides a new in-kernel packet classification framework that is based on a\nnetwork-specific Virtual Machine (VM) and a new nft userspace command line tool.\nnftables reuses the existing Netfilter subsystems such as the existing hook infrastructure,\nthe connection tracking system, NAT, userspace queuing and logging subsystem.\nThepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_nftables_removed","kind":"notApplicable","level":"none","message":{"text":"nftables is a subsystem of the Linux kernel providing filtering and classification of network\npackets/datagrams/frames and is the successor to iptables.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_nftables_enabled","kind":"notApplicable","level":"none","message":{"text":"The nftables service allows for the loading of nftables rulesets during boot,\nor starting on the nftables service\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_nftables_disabled","kind":"notApplicable","level":"none","message":{"text":"nftables is a subsystem of the Linux kernel providing filtering and classification of network\npackets/datagrams/frames and is the successor to iptables.\nTheservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_nftables_ensure_default_deny_policy","kind":"notApplicable","level":"none","message":{"text":"Base chain policy is the default verdict that will be applied to packets reaching the end of\nthe chain. There are two policies: accept (Default) and drop. If the policy is set to accept,\nthe firewall will accept any packet that is not configured to be denied and the packet will\ncontinue traversing the network stack."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_nftables_rules_permanent","kind":"notApplicable","level":"none","message":{"text":"nftables is a subsystem of the Linux kernel providing filtering and classification of\nnetwork packets/datagrams/frames. The nftables service reads thefile for a nftables file or files to\ninclude in the nftables ruleset. A nftables ruleset containing the input, forward, and output\nbase chains allow network traffic to be filtered."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_nftables_base_chain","kind":"notApplicable","level":"none","message":{"text":"Tables in nftables hold chains. Each table only has one address family and only applies\nto packets of this family. Tables can have one of six families.\nChains are containers for rules. They exist in two kinds, base chains and regular chains.\nA base chain is an entry point for packets from the networking stack, a regular chain may\nbe used as jump target and is used for better rule organization."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_nftables_loopback_traffic","kind":"notApplicable","level":"none","message":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_nftables_table","kind":"notApplicable","level":"none","message":{"text":"Tables in nftables hold chains. Each table only has one address family and only applies\nto packets of this family. Tables can have one of six families."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_ufw_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_ufw_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_ufw_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_ufw_default_rule","kind":"notApplicable","level":"none","message":{"text":"A default deny policy on connections ensures that any unconfigured\nnetwork usage will be rejected.\n\nNote: Any port or protocol without a explicit allow before the default\ndeny will be blocked."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_set_ufw_loopback_traffic","kind":"notApplicable","level":"none","message":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ufw_rules_for_open_ports","kind":"notApplicable","level":"none","message":{"text":"Any ports that have been opened on non-loopback addresses\nneed firewall rules to govern traffic."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_dccp_disabled","kind":"notApplicable","level":"none","message":{"text":"The Datagram Congestion Control Protocol (DCCP) is a\nrelatively new transport layer protocol, designed to support\nstreaming media and telephony.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_rds_disabled","kind":"notApplicable","level":"none","message":{"text":"The Reliable Datagram Sockets (RDS) protocol is a transport\nlayer protocol designed to provide reliable high-bandwidth,\nlow-latency communications between nodes in a cluster.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_sctp_disabled","kind":"notApplicable","level":"none","message":{"text":"The Stream Control Transmission Protocol (SCTP) is a\ntransport layer protocol, designed to support the idea of\nmessage-oriented communication, with several streams of messages\nwithin one connection.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_tipc_disabled","kind":"notApplicable","level":"none","message":{"text":"The Transparent Inter-Process Communication (TIPC) protocol\nis designed to provide communications between nodes in a\ncluster.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_wireless_disable_interfaces","kind":"notApplicable","level":"none","message":{"text":"Deactivating wireless network interfaces should prevent normal usage of the wireless\ncapability.Configure the system to disable all wireless network interfaces with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_only_allow_dod_certs","kind":"notApplicable","level":"none","message":{"text":"The operating system must only allow the use of DoD PKI-established\ncertificate authorities for verification of the establishment of\nprotected sessions."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_group","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_gshadow","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_passwd","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_shadow","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_group","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_shadow","kind":"pass","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_group","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_gshadow","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_passwd","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_shadow","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_group","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_passwd","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_etc_shadow","kind":"pass","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_group","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_gshadow","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_passwd","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_shadow","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_group","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_var_log","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_var_log_messages","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_var_log_syslog","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_var_log","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_var_log_messages","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_var_log_syslog","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_var_log","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_var_log_messages","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_var_log_syslog","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_group_ownership_library_dirs","kind":"notApplicable","level":"none","message":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are also\nstored in. All files in these directories should be\ngroup-owned by theuser. If the  directories, is found to be owned\nby a user other than root correct its\nownership with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_groupownership_binary_dirs","kind":"notApplicable","level":"none","message":{"text":"System commands files are stored in the following directories by default:All these directories should be owned by thegroup.\nIf the directory is found to be owned by a group other than root correct\nits ownership with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_ownership_binary_dirs","kind":"notApplicable","level":"none","message":{"text":"All these directories should be owned by theuser.\nIf any directoryin these directories is found\nto be owned by a user other than root, correct its ownership with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_ownership_library_dirs","kind":"notApplicable","level":"none","message":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are also\nstored in. All files in these directories should be\nowned by theuser. If the  directories, is found to be owned\nby a user other than root correct its\nownership with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_permissions_binary_dirs","kind":"notApplicable","level":"none","message":{"text":"System executables are stored in the following directories by default:These directories should not be group-writable or world-writable.\nIf any directoryin these directories is found to be\ngroup-writable or world-writable, correct its permission with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_permissions_library_dirs","kind":"notApplicable","level":"none","message":{"text":"System-wide shared library directories, which contain are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are\nstored in. All sub-directories in these directories\nshould not be group-writable or world-writable. If any file in these\ndirectories is found to be group-writable or world-writable, correct\nits permission with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupownership_audit_binaries","kind":"pass","level":"none","message":{"text":"The Ubuntu 22.04 operating system audit tools must have the proper\nownership configured to protected against unauthorized access.\n\nVerify it by running the following command:Audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupownership_system_commands_dirs","kind":"notApplicable","level":"none","message":{"text":"System commands files are stored in the following directories by default:All files in these directories should be owned by thegroup,\nor a system account.\nIf the directory, or any file in these directories, is found to be owned\nby a group other than root or a a system account correct its ownership\nwith the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_audit_binaries","kind":"pass","level":"none","message":{"text":"The Ubuntu 22.04 operating system audit tools must have the proper\nownership configured to protected against unauthorized access.\n\nVerify it by running the following command:Audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_binary_dirs","kind":"notApplicable","level":"none","message":{"text":"System executables are stored in the following directories by default:All files in these directories should be owned by theuser.\nIf any filein these directories is found\nto be owned by a user other than root, correct its ownership with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_library_dirs","kind":"notApplicable","level":"none","message":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are also\nstored in. All files in these directories should be\nowned by theuser. If the directory, or any file in these\ndirectories, is found to be owned by a user other than root correct its\nownership with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_audit_binaries","kind":"pass","level":"none","message":{"text":"The Ubuntu 22.04 operating system audit tools must have the proper\npermissions configured to protected against unauthorized access.\n\nVerify it by running the following command:Audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_binary_dirs","kind":"notApplicable","level":"none","message":{"text":"System executables are stored in the following directories by default:All files in these directories should not be group-writable or world-writable.\nIf any filein these directories is found\nto be group-writable or world-writable, correct its permission with the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_library_dirs","kind":"notApplicable","level":"none","message":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are\nstored in. All files in these directories\nshould not be group-writable or world-writable. If any file in these\ndirectories is found to be group-writable or world-writable, correct\nits permission with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_root_permissions_syslibrary_files","kind":"notApplicable","level":"none","message":{"text":"System-wide library files are stored in the following directories\nby default:All system-wide shared library files should be protected from unauthorised\naccess. If any of these files is not group-owned by root, correct its group-owner with\nthe following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dir_perms_world_writable_sticky_bits","kind":"notApplicable","level":"none","message":{"text":"When the so-called 'sticky bit' is set on a directory,\nonly the owner of a given file may remove that file from the\ndirectory. Without the sticky bit, any user with write access to a\ndirectory may remove any file in the directory. Setting the sticky\nbit prevents users from removing each other's files. In cases where\nthere is no reason for a directory to be world-writable, a better\nsolution is to remove that permission rather than to set the sticky\nbit. However, if a directory is used by a particular application,\nconsult that application's documentation instead of blindly\nchanging modes.To set the sticky bit on a world-writable directory, run the\nfollowing command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_audit_auditd","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_etc_audit_rulesd","kind":"pass","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_systemmap","kind":"notApplicable","level":"none","message":{"text":"Files containing sensitive informations should be protected by restrictive\n  permissions. Most of the time, there is no need that these files need to be read by any non-root user\n\nTo properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_unauthorized_world_writable","message":{"text":"It is generally a good idea to remove global (other) write\naccess to a file when it is discovered. However, check with\ndocumentation for specific applications before making changes.\nAlso, monitor for recurring world-writable files, as these may be\nsymptoms of a misconfigured application or user account. Finally,\nthis applies to real files and not virtual files that are a part of\npseudo file systems such asor."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}],"rank":0.5},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_ungroupowned","kind":"pass","level":"none","message":{"text":"If any files are not owned by a group, then the\ncause of their lack of group-ownership should be investigated.\nFollowing this, the files should be deleted or assigned to an\nappropriate group. The following command will discover and print\nany files on local partitions which do not belong to a valid group:To search all filesystems on a system including network mounted\nfilesystems the following command can be run manually for each partition:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_files_unowned_by_user","kind":"notApplicable","level":"none","message":{"text":"If any files are not owned by a user, then the\ncause of their lack of ownership should be investigated.\nFollowing this, the files should be deleted or assigned to an\nappropriate user. The following command will discover and print\nany files on local partitions which do not belong to a valid user:To search all filesystems on a system including network mounted\nfilesystems the following command can be run manually for each partition:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_permissions_local_var_log","kind":"pass","level":"none","message":{"text":"Any operating system providing too much information in error messages\nrisks compromising the data and security of the structure, and content\nof error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages.\nThe extent to which information systems are able to identify and handle\nerror conditions is guided by organizational policy and operational\nrequirements. Information that could be exploited by adversaries includes,\nfor example, erroneous logon attempts with passwords entered by mistake\nas the username, mission/business information that can be derived from\n(if not stated explicitly by) information recorded, and personal\ninformation, such as account numbers, social security numbers, and credit\ncard numbers."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_fs_protected_hardlinks","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_fs_protected_symlinks","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_autofs_disabled","kind":"notApplicable","level":"none","message":{"text":"Thedaemon mounts and unmounts filesystems, such as user\nhome directories shared via NFS, on demand. In addition, autofs can be used to handle\nremovable media, and the default configuration provides the cdrom device as.\nHowever, this method of providing access to removable media is not common, so autofs\ncan almost always be disabled if NFS is not in use. Even if NFS is required, it may be\npossible to configure filesystem mounts statically by editingrather than relying on the automounter.Theservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_cramfs_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem.\n\nThefilesystem type is a compressed read-only\nLinux filesystem embedded in small footprint systems. Aimage can be used without having to first\ndecompress the image."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_freevxfs_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_hfs_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_hfsplus_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_jffs2_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_squashfs_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem.\n\nThefilesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems (similar to). Aimage can be used without having\nto first decompress the image."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_udf_disabled","kind":"notApplicable","level":"none","message":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem.\n\nThefilesystem type is the universal disk format\nused to implement the ISO/IEC 13346 and ECMA-167 specifications.\nThis is an open vendor filesystem type for data storage on a broad\nrange of media. This filesystem type is neccessary to support\nwriting DVDs and newer optical disc formats."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_usb-storage_disabled","kind":"notApplicable","level":"none","message":{"text":"To prevent USB storage devices from being used, configure the kernel module loading system\nto prevent automatic loading of the USB storage driver.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:This will prevent theprogram from loading themodule, but will not prevent an administrator (or another program) from using theprogram to load the module manually."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent creation of device\nfiles in. Legitimate character and block devices should\nnot exist within temporary directories like.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_dev_shm_noexec","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nIt can be dangerous to allow the execution of binaries\nfrom world-writable temporary storage directories such as.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent execution\nof setuid programs in.  The SUID and SGID permissions should not\nbe required in these world-writable directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_home_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_home_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in these user data directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_tmp_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent device files from\nbeing created in. Legitimate character and block devices\nshould not exist within temporary directories like.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_tmp_noexec","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_tmp_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in these world-writable directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_noexec","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in directories containing audit log files.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_log_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_log_noexec","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_log_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in directories containing log files.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required for this directory.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nodev","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent device files from\nbeing created in. Legitimate character and block devices\nshould not exist within temporary directories like.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_tmp_noexec","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nosuid","kind":"notApplicable","level":"none","message":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in these world-writable directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_coredump_disable_backtraces","kind":"notApplicable","level":"none","message":{"text":"Theoption insection\nofspecifies the maximum size in bytes of a core which will be processed.\nCore dumps exceeding this size may be stored, but the backtrace will not\nbe generated."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_coredump_disable_storage","kind":"notApplicable","level":"none","message":{"text":"Theoption insectionofcan be set toto disable storing core dumps permanently."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_disable_users_coredumps","kind":"notApplicable","level":"none","message":{"text":"To disable core dumps for all users, add the following line to, or to a file within thedirectory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_fs_suid_dumpable","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_kernel_kptr_restrict","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_kernel_randomize_va_space","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_bios_enable_execution_restrictions","kind":"notApplicable","level":"none","message":{"text":"Reboot the system and enter the BIOS or Setup configuration menu.\nNavigate the BIOS configuration menu and make sure that the option is enabled. The setting may be located\nunder a Security section. Look for Execute Disable (XD) on Intel-based systems and No Execute (NX)\non AMD-based systems."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_kernel_module_uvcvideo_disabled","kind":"notApplicable","level":"none","message":{"text":"If the device contains a camera it should be covered or disabled when not in use."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sysctl_kernel_panic_on_oops","kind":"notApplicable","level":"none","message":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_selinux_not_disabled","kind":"notApplicable","level":"none","message":{"text":"The SELinux state should be set toorat system boot\ntime. In the file, add or correct the following line to configure\nthe system to boot into enforcing or permissive mode:OR."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_selinux_state","kind":"notApplicable","level":"none","message":{"text":"The SELinux state should be set toat\nsystem boot time.  In the file, add or correct the\nfollowing line to configure the system to boot into enforcing mode:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_apport_disabled","kind":"notApplicable","level":"none","message":{"text":"The Apport modifies certain kernel configuration values at\nruntime which may decrease the overall security of the system and expose sensitive data.\n\nTheservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_apt_conf_disallow_unauthenticated","kind":"notApplicable","level":"none","message":{"text":"Unauthenticated repositories should not be used for updates."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_avahi_disable_publishing","kind":"notApplicable","level":"none","message":{"text":"To prevent Avahi from publishing its records, editand ensure the following line appears in thesection:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_avahi_removed","kind":"pass","level":"none","message":{"text":"If the system does not need to have an Avahi server which implements\nthe DNS Service Discovery and Multicast DNS protocols,\nthe avahi-autoipd and avahi packages can be uninstalled."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_avahi-daemon_disabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_kdump_disabled","kind":"notApplicable","level":"none","message":{"text":"Theservice provides a kernel crash dump analyzer. It uses thesystem call to boot a secondary kernel (\"capture\" kernel) following a system\ncrash, which can load information from the crashed kernel for analysis.\n\nTheservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_at_deny_not_exist","kind":"notApplicable","level":"none","message":{"text":"The fileshould not exist.\nUseinstead."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_cron_deny_not_exist","kind":"notApplicable","level":"none","message":{"text":"The fileshould not exist.\nUseinstead."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_at_allow","kind":"notApplicable","level":"none","message":{"text":"Ifexists, it must be group-owned by.\n\nTo properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_allow","kind":"notApplicable","level":"none","message":{"text":"Ifexists, it must be group-owned by.\n\nTo properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_at_allow","kind":"notApplicable","level":"none","message":{"text":"Ifexists, it must be owned by.\n\nTo properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_cron_allow","kind":"notApplicable","level":"none","message":{"text":"Ifexists, it must be owned by.\n\nTo properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_at_allow","kind":"notApplicable","level":"none","message":{"text":"Ifexists, it must have permissionsor more restrictive.\n\n\nTo properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_cron_allow","kind":"notApplicable","level":"none","message":{"text":"Ifexists, it must have permissionsor more restrictive.\n\n\nTo properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_cron_installed","kind":"notApplicable","level":"none","message":{"text":"The Cron service should be installed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_cron_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice is used to execute commands at\npreconfigured times. It is required by almost all systems to perform necessary\nmaintenance tasks, such as notifying root of system activity.\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_d","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_daily","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_hourly","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_monthly","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_weekly","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_crontab","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_cron_d","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_cron_daily","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_cron_hourly","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_cron_monthly","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_cron_weekly","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_crontab","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_cron_d","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_cron_daily","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_cron_hourly","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_cron_monthly","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_cron_weekly","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_crontab","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_inetutils-telnetd_removed","kind":"notApplicable","level":"none","message":{"text":"The inet-based telnet daemon should be uninstalled."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_nis_removed","kind":"pass","level":"none","message":{"text":"The support for Yellowpages should not be installed unless it is required."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_ntpdate_removed","kind":"notApplicable","level":"none","message":{"text":"ntpdate is a historical ntp synchronization client for unixes. It sould be uninstalled."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_telnetd-ssl_removed","kind":"notApplicable","level":"none","message":{"text":"Thedaemon, even with ssl support, should be uninstalled."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_telnetd_removed","kind":"notApplicable","level":"none","message":{"text":"The telnet daemon should be uninstalled."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dhcp_client_restrict_options","kind":"notApplicable","level":"none","message":{"text":"Create the file, and add an\nappropriate setting for each of the ten configuration settings which can be\nobtained via DHCP. For each setting, do one of the following:If the setting shouldbe configured remotely by the DHCP server,\nselect an appropriate static value, and add the line:If the setting should be configured remotely by the DHCP server, add the lines:For example, suppose the DHCP server should provide only the IP address itself\nand the subnet mask. Then the entire file should look like:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_dhcp_server_minimize_served_info","kind":"notApplicable","level":"none","message":{"text":"Edit /etc/dhcp/dhcpd.conf. Examine each address range section within\nthe file, and ensure that the following options are not defined unless there is\nan operational need to provide this information via DHCP:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_dhcp_removed","kind":"pass","level":"none","message":{"text":"If the system does not need to act as a DHCP server,\nthe dhcp package can be uninstalled.\n\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_bind_removed","kind":"pass","level":"none","message":{"text":"Theservice is provided by thepackage.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_fapolicyd_prevent_home_folder_access","kind":"notApplicable","level":"none","message":{"text":"fapolicyd needs be configured so that users cannot give access to their home folders to other users."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_vsftpd_removed","kind":"pass","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ftp_limit_users","kind":"notApplicable","level":"none","message":{"text":"If there is a mission-critical reason for users to access their accounts via the insecure FTP protocol, limit the set of users who are allowed this access. Edit the vsftpd configuration file. Add or correct the following configuration options:Edit the file. For each user USERNAME who should be allowed to access the system via FTP, add a line containing that user's name:If anonymous access is also required, add the anonymous usernames toas well."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ftp_configure_firewall","kind":"notApplicable","level":"none","message":{"text":"By default,blocks access to the ports used by the web server.\n\nTo configureto allow port 21 traffic, one must editand(if IPv6 is in use).\nAdd the following line, ensuring that it appears before the final LOG and DROP lines for the INPUT chain:Edit the file. Ensure that the space-separated list of modules contains\nthe FTP connection tracking module:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_httpd_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_nginx_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_cyrus-imapd_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_dovecot_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_openldap-clients_removed","kind":"pass","level":"none","message":{"text":"The Lightweight Directory Access Protocol (LDAP) is a service that provides\na method for looking up information from a central database.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_openldap-servers_removed","kind":"pass","level":"none","message":{"text":"The slapd package is not installed by default on a Ubuntu 22.04\nsystem. It is needed only by the OpenLDAP server, not by the\nclients which use LDAP for authentication. If the system is not\nintended for use as an LDAP Server it should be removed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_postfix_client_configure_mail_alias","kind":"notApplicable","level":"none","message":{"text":"Make sure that mails delivered to root user are forwarded to a monitored\nemail address. Make sure that the addressis a valid email address\nreachable from the system in question. Use the following command to\nconfigure the alias:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_postfix_client_configure_mail_alias_postmaster","kind":"notApplicable","level":"none","message":{"text":"Verify the administrators are notified in the event of an audit processing failure.\nCheck that the \"/etc/aliases\" file has a defined value for \"root\"."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_postfix_client_configure_relayhost","kind":"notApplicable","level":"none","message":{"text":"Set up a relay host that will act as a gateway for all outbound email.\nEdit the fileto ensure that only the followingline appears:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_postfix_network_listening_disabled","kind":"notApplicable","level":"none","message":{"text":"Edit the fileto ensure that only the followingline appears:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_postfix_installed","kind":"notApplicable","level":"none","message":{"text":"A mail server is required for sending emails.\nThepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_postfix_enabled","kind":"notApplicable","level":"none","message":{"text":"The Postfix mail transfer agent is used for local mail delivery\nwithin the system. The default configuration only listens for connections to\nthe default SMTP port (port 25) on the loopback interface (127.0.0.1).  It is\nrecommended to leave this service enabled for local mail delivery.\n\nTheservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_has_nonlocal_mta","kind":"notApplicable","level":"none","message":{"text":"Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to\nlisten for incoming mail and transfer the messages to the appropriate\nuser or mail server. If the system is not intended to be a mail server,\nit is recommended that the MTA be configured to only process local mail."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_netfs_disabled","kind":"notApplicable","level":"none","message":{"text":"The netfs script manages the boot-time mounting of several types\nof networked filesystems, of which NFS and Samba are the most common. If these\nfilesystem types are not in use, the script can be disabled, protecting the\nsystem somewhat against accidental or malicious changes toand against flaws in the netfs script itself.\n\nTheservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_rpcbind_removed","kind":"notApplicable","level":"none","message":{"text":"The rpcbind utility maps RPC services to the ports on which they listen.\nRPC processes notify rpcbind when they start, registering the ports they\nare listening on and the RPC program numbers they expect to serve. The\nrpcbind service redirects the client to the proper port number so it can\ncommunicate with the requested service. If the system does not require RPC\n(such as for NFS servers) then this service should be disabled.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_all_squash_exports","kind":"notApplicable","level":"none","message":{"text":"Themaps all uids and gids to an anonymous user.\nThis should be disabled by removing any instances of theoption from the file."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_nfs-kernel-server_removed","kind":"pass","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_chrony_installed","kind":"notApplicable","level":"none","message":{"text":"System time should be synchronized between all systems in an environment. This is\ntypically done by establishing an authoritative time server or set of servers and having all\nsystems synchronize their clocks to them.\nThepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_ntp_installed","kind":"notApplicable","level":"none","message":{"text":"The ntpd service should be installed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_timesyncd_installed","kind":"notApplicable","level":"none","message":{"text":"The systemd_timesyncd service should be installed."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_chronyd_enabled","kind":"notApplicable","level":"none","message":{"text":"chrony is a daemon which implements the Network Time Protocol (NTP) is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on chrony can be found at.\nChrony can be configured to be a client and/or a server.\nTo enable Chronyd service, you can run:This recommendation only applies if chrony is in use on the system."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_ntp_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_ntpd_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_timesyncd_enabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be enabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_set_maxpoll","kind":"notApplicable","level":"none","message":{"text":"Theshould be configured toinorto continuously poll time servers. To configureinoradd the following after each `server`, `pool` or `peer` entry:todirectives. If using chrony anydirectives\nshould be configured too.\nIf noordirectives are configured, the rule evaluates\nto pass."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_chronyd_run_as_chrony_user","kind":"notApplicable","level":"none","message":{"text":"chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on chrony can be found at.\nChrony can be configured to be a client and/or a server.\nTo ensure that chronyd is running under chrony user account,variable inis set toor is\nabsent:This recommendation only applies if chrony is in use on the system."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_chronyd_server_directive","kind":"notApplicable","level":"none","message":{"text":"Check that Chrony only has time sources configured with thedirective."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_chronyd_specify_remote_server","kind":"notApplicable","level":"none","message":{"text":"is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information oncan be found at.can be configured to be a client and/or a server.\nAdd or edit server or pool lines toas appropriate:Multiple servers may be configured."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_chronyd_sync_clock","kind":"notApplicable","level":"none","message":{"text":"Synchronizing internal information system clocks provides uniformity\nof time stamps for information systems with multiple system clocks and\nsystems connected over a network."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ntpd_configure_restrictions","kind":"notApplicable","level":"none","message":{"text":"ntpd is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on NTP can be found at.\nntp can be configured to be a client and/or a server.\nTo ensure that ntpd implements correct server restrictions, make sure that the following lines exist in the file:This recommendation only applies if ntp is in use on the system."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ntpd_run_as_ntp_user","kind":"notApplicable","level":"none","message":{"text":"ntp is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on NTP can be found at.\nntp can be configured to be a client and/or a server.\nTo ensure that ntpd is running as ntp user, Add or edit thevariable into include ' -u ntp:ntp ':This recommendation only applies if ntp is in use on the system."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ntpd_specify_multiple_servers","kind":"notApplicable","level":"none","message":{"text":"Additional NTP servers can be specified for time synchronization\nin the file.  To do so, add additional lines of the\nfollowing form, substituting the IP address or hostname of a remote NTP server for:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_ntpd_specify_remote_server","kind":"notApplicable","level":"none","message":{"text":"To specify a remote NTP server for time synchronization, edit\nthe file. Add or correct the following lines,\nsubstituting the IP or hostname of a remote NTP server for:This instructs the NTP software to contact that remote server to obtain time\ndata."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_xinetd_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_rsh-server_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_rsh_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage contains the client commands\n\nfor the rsh services."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_no_rsh_trust_files","kind":"pass","level":"none","message":{"text":"The filesand(in\neach user's home directory) list remote hosts and users that are trusted by the\nlocal system when using the rshd daemon.\nTo remove these files, run the following command to delete them from any\nlocation:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_talk_removed","kind":"pass","level":"none","message":{"text":"Thepackage contains the client program for the\nInternet talk protocol, which allows the user to chat with other users on\ndifferent systems. Talk is a communication program which copies lines from one\nterminal to the terminal of another user.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_telnet_removed","kind":"pass","level":"none","message":{"text":"The telnet client allows users to start connections to other systems via\nthe telnet protocol."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_rsync_removed","kind":"pass","level":"none","message":{"text":"The rsyncd service can be used to synchronize files between systems over network links.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_cups_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_cups_disabled","kind":"notApplicable","level":"none","message":{"text":"Theservice can be disabled with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_squid_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_samba_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_net-snmp_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage provides the snmpd service.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_keepalive_0","kind":"notApplicable","level":"none","message":{"text":"The SSH server sends at mostmessages\nduring a SSH session and waits for a response from the SSH client.\nThe optionconfigures timeout after\neachmessage. If the SSH server does not\nreceive a response from the client, then the connection is considered unresponsive\nand terminated.\n\nTo ensure the SSH timeout occurs precisely when theis set, set theto\nvalue ofin:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_keepalive","kind":"notApplicable","level":"none","message":{"text":"The SSH server sends at mostmessages\nduring a SSH session and waits for a response from the SSH client.\nThe optionconfigures timeout after\neachmessage. If the SSH server does not\nreceive a response from the client, then the connection is considered unresponsive\nand terminated.\nFor SSH earlier than v8.2, avalue ofcauses a timeout precisely when theis set.\nStarting with v8.2, a value ofdisables the timeout functionality\ncompletely. If the option is set to a number greater than, then\nthe session will be disconnected afterseconds without receiving\na keep alive message."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout","kind":"notApplicable","level":"none","message":{"text":"SSH allows administrators to set a network responsiveness timeout interval.\nAfter this interval has passed, the unresponsive client will be automatically logged out.To set this timeout interval, edit the following line inas\nfollows:The timeoutis given in seconds. For example, have a timeout\nof 10 minutes, setto 600.If a shorter timeout has already been set for the login shell, that value will\npreempt any SSH setting made in. Keep in mind that\nsome processes may stop SSH from correctly detecting that the user is idle."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_disable_host_auth","kind":"notApplicable","level":"none","message":{"text":"SSH's cryptographic host-based authentication is\nmore secure thanauthentication. However, it is\nnot recommended that hosts unilaterally trust one another, even\nwithin an organization.The default SSH configuration disables host-based authentication. The appropriate\nconfiguration is used if no value is set for.To explicitly disable host-based authentication, add or correct the\nfollowing line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_allow_only_protocol2","kind":"notApplicable","level":"none","message":{"text":"Only SSH protocol version 2 connections should be\npermitted. The default setting inis correct, and can be\nverified by ensuring that the following\nline appears:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_compression","kind":"notApplicable","level":"none","message":{"text":"Compression is useful for slow network connections over long\ndistances but can cause performance issues on local LANs. If use of compression\nis required, it should be enabled only after a user has authenticated; otherwise,\nit should be disabled. To disable compression or delay compression until after\na user has successfully authenticated, add or correct the following line in thefile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords","kind":"notApplicable","level":"none","message":{"text":"Disallow SSH login with empty passwords.\nThe default SSH configuration disables logins with empty passwords. The appropriate\nconfiguration is used if no value is set for.To explicitly disallow SSH login from accounts with empty passwords,\nadd or correct the following line in:Any accounts with empty passwords should be disabled immediately, and PAM configuration\nshould prevent users from being able to assign themselves empty passwords."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_gssapi_auth","kind":"notApplicable","level":"none","message":{"text":"Unless needed, SSH should not permit extraneous or unnecessary\nauthentication mechanisms like GSSAPI.The default SSH configuration disallows authentications based on GSSAPI. The appropriate\nconfiguration is used if no value is set for.To explicitly disable GSSAPI authentication, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_kerb_auth","kind":"notApplicable","level":"none","message":{"text":"Unless needed, SSH should not permit extraneous or unnecessary\nauthentication mechanisms like Kerberos.The default SSH configuration disallows authentication validation through Kerberos.\nThe appropriate configuration is used if no value is set for.To explicitly disable Kerberos authentication, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_pubkey_auth","kind":"notApplicable","level":"none","message":{"text":"Unless needed, SSH should not permit extraneous or unnecessary\nauthentication mechanisms. To disable PubkeyAuthentication authentication, add or\ncorrect the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_rhosts","kind":"notApplicable","level":"none","message":{"text":"SSH can emulate the behavior of the obsolete rsh\ncommand in allowing users to enable insecure access to their\naccounts viafiles.The default SSH configuration disables support for. The appropriate\nconfiguration is used if no value is set for.To explicitly disable support for .rhosts files, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_rhosts_rsa","kind":"notApplicable","level":"none","message":{"text":"SSH can allow authentication through the obsolete rsh\ncommand through the use of the authenticating user's SSH keys. This should be disabled.To ensure this behavior is disabled, add or correct the\nfollowing line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_root_login","kind":"notApplicable","level":"none","message":{"text":"The root user should never be allowed to login to a\nsystem directly over a network.\nTo disable root login via SSH, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_root_password_login","kind":"notApplicable","level":"none","message":{"text":"To disable password-based root logins over SSH, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_tcp_forwarding","kind":"notApplicable","level":"none","message":{"text":"Theparameter specifies whether TCP forwarding is permitted.\nTo disable TCP forwarding, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_user_known_hosts","kind":"notApplicable","level":"none","message":{"text":"SSH can allow system users to connect to systems if a cache of the remote\nsystems public keys is available.  This should be disabled.To ensure this behavior is disabled, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_disable_x11_forwarding","kind":"notApplicable","level":"none","message":{"text":"The X11Forwarding parameter provides the ability to tunnel X11 traffic\nthrough the connection to enable remote graphic connections.\nSSH has the capability to encrypt remote X11 connections when SSH'soption is enabled.The default SSH configuration disables X11Forwarding. The appropriate\nconfiguration is used if no value is set for.To explicitly disable X11 Forwarding, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env","kind":"notApplicable","level":"none","message":{"text":"Ensure that users are not able to override environment variables of the SSH daemon.The default SSH configuration disables environment processing. The appropriate\nconfiguration is used if no value is set for.To explicitly disable Environment options, add or correct the following:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_gssapi_auth","kind":"notApplicable","level":"none","message":{"text":"Sites setup to use Kerberos or other GSSAPI Authenticaion require setting\nsshd to accept this authentication.\nTo enable GSSAPI authentication, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_pam","kind":"notApplicable","level":"none","message":{"text":"UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will\nenable PAM authentication using ChallengeResponseAuthentication and\nPasswordAuthentication in addition to PAM account and session module processing for all\nauthentication types.\n\nTo enable PAM authentication, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_pubkey_auth","kind":"notApplicable","level":"none","message":{"text":"Enable SSH login with public keys.The default SSH configuration enables authentication based on public keys. The appropriate\nconfiguration is used if no value is set for.To explicitly enable Public Key Authentication, add or correct the following:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_strictmodes","kind":"notApplicable","level":"none","message":{"text":"SSHsoption checks file and ownership permissions in\nthe user's home directoryfolder before accepting login. If world-\nwritable permissions are found, logon is rejected.The default SSH configuration hasenabled. The appropriate\nconfiguration is used if no value is set for.To explicitly enablein SSH, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner","kind":"notApplicable","level":"none","message":{"text":"To enable the warning banner and ensure it is consistent\nacross the system, add or correct the following line in:Another section contains information on how to create an\nappropriate system-wide warning banner."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner_net","kind":"notApplicable","level":"none","message":{"text":"To enable the warning banner and ensure it is consistent\nacross the system, add or correct the following line in:Another section contains information on how to create an\nappropriate system-wide warning banner."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_enable_x11_forwarding","kind":"notApplicable","level":"none","message":{"text":"By default, remote X11 connections are not encrypted when initiated\nby users. SSH has the capability to encrypt remote X11 connections when SSH'soption is enabled.To enable X11 Forwarding, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_limit_user_access","kind":"notApplicable","level":"none","message":{"text":"By default, the SSH configuration allows any user with an account\nto access the system. There are several options available to limit\nwhich users and group can access the system via SSH. It is\nrecommended that at least one of the following options be leveraged:\n- AllowUsers variable gives the system administrator the option of\n  allowing specific users to ssh into the system. The list consists of\n  space separated user names. Numeric user IDs are not recognized with\n  this variable. If a system administrator wants to restrict user\n  access further by specifically allowing a user's access only from a\n  particular host, the entry can be specified in the form of user@host.\n- AllowGroups variable gives the system administrator the option of\n  allowing specific groups of users to ssh into the system. The list\n  consists of space separated group names. Numeric group IDs are not\n  recognized with this variable.\n- DenyUsers variable gives the system administrator the option of\n  denying specific users to ssh into the system. The list consists of\n  space separated user names. Numeric user IDs are not recognized with\n  this variable. If a system administrator wants to restrict user\n  access further by specifically denying a user's access from a\n  particular host, the entry can be specified in the form of user@host.\n- DenyGroups variable gives the system administrator the option of\n  denying specific groups of users to ssh into the system. The list\n  consists of space separated group names. Numeric group IDs are not\n  recognized with this variable."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_print_last_log","kind":"notApplicable","level":"none","message":{"text":"Ensure that SSH will display the date and time of the last successful account logon.The default SSH configuration enables print of the date and time of the last login.\nThe appropriate configuration is used if no value is set for.To explicitly enable LastLog in SSH, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_rekey_limit","kind":"notApplicable","level":"none","message":{"text":"Theparameter specifies how often\nthe session key of the is renegotiated, both in terms of\namount of data that may be transmitted and the time\nelapsed.To decrease the default limits, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_login_grace_time","kind":"notApplicable","level":"none","message":{"text":"Theparameter to the SSH server specifies the time allowed for successful authentication to\nthe SSH server. The longer the Grace period is the more open unauthenticated connections\ncan exist. Like other session controls in this session the Grace Period should be limited to\nappropriate limits to ensure the service is available for needed access."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_loglevel_info","kind":"notApplicable","level":"none","message":{"text":"The INFO parameter specifices that record login and logout activity will be logged.The default SSH configuration sets the log level to INFO. The appropriate\nconfiguration is used if no value is set for.To explicitly specify the log level in SSH, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_loglevel_verbose","kind":"notApplicable","level":"none","message":{"text":"Theparameter configures the SSH daemon to record login and logout activity.\nTo specify the log level in\nSSH, add or correct the following line in:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_max_auth_tries","kind":"notApplicable","level":"none","message":{"text":"Theparameter specifies the maximum number of authentication attempts\npermitted per connection. Once the number of failures reaches half this value, additional failures are logged.\nto set MaxAUthTries editas follows:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_max_sessions","kind":"notApplicable","level":"none","message":{"text":"Theparameter specifies the maximum number of open sessions permitted\nfrom a given connection. To set MaxSessions editas follows:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_set_maxstartups","kind":"notApplicable","level":"none","message":{"text":"The MaxStartups parameter specifies the maximum number of concurrent\nunauthenticated connections to the SSH daemon. Additional connections will be\ndropped until authentication succeeds or the LoginGraceTime expires for a\nconnection. To confgure MaxStartups, you should add or correct the following\nline in thefile:CIS recommends a MaxStartups value of '10:30:60', or more restrictive where\ndictated by site policy."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_use_approved_ciphers_ordered_stig","kind":"notApplicable","level":"none","message":{"text":"Limit the ciphers to those algorithms which are FIPS-approved.\nThe following line indemonstrates use of FIPS-approved ciphers:This rule ensures that there are configured ciphers mentioned\nabove (or their subset), keeping the given order of algorithms."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_use_priv_separation","kind":"notApplicable","level":"none","message":{"text":"When enabled, SSH will create an unprivileged child process that\nhas the privilege of the authenticated user. To enable privilege separation in\nSSH, add or correct the following line in thefile:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_use_strong_ciphers","kind":"notApplicable","level":"none","message":{"text":"Limit the ciphers to strong algorithms.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\nThe following line indemonstrates use of those ciphers:The man pagecontains a list of supported ciphers."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_use_strong_kex","kind":"notApplicable","level":"none","message":{"text":"Limit the Key Exchange to strong algorithms.\nThe following line indemonstrates use\nof those:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sshd_use_strong_macs","kind":"notApplicable","level":"none","message":{"text":"Limit the MACs to strong hash algorithms.\nThe following line indemonstrates use\nof those MACs:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_openssh-server_installed","kind":"notApplicable","level":"none","message":{"text":"Thepackage should be installed.\nThepackage can be installed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_openssh-server_removed","kind":"notApplicable","level":"none","message":{"text":"Thepackage should be removed.\nThepackage can be removed with the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_service_sshd_disabled","kind":"notApplicable","level":"none","message":{"text":"The SSH server service, sshd, is commonly needed.\nHowever, if it can be disabled, do so.\nThis is unusual, as SSH is a common method for encrypted and authenticated\nremote access."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupowner_sshd_config","kind":"notApplicable","level":"none","message":{"text":"To properly set the group owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupownership_sshd_private_key","kind":"notApplicable","level":"none","message":{"text":"SSH server private keys, files that match theglob, must be\ngroup-owned bygroup."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_groupownership_sshd_pub_key","kind":"notApplicable","level":"none","message":{"text":"SSH server public keys, files that match theglob, must be\ngroup-owned bygroup."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_owner_sshd_config","kind":"notApplicable","level":"none","message":{"text":"To properly set the owner of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_sshd_private_key","kind":"notApplicable","level":"none","message":{"text":"SSH server private keys, files that match theglob, must be owned\nbyuser."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_ownership_sshd_pub_key","kind":"notApplicable","level":"none","message":{"text":"SSH server public keys, files that match theglob, must be owned\nbyuser."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_sshd_config","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_sshd_private_key","kind":"notApplicable","level":"none","message":{"text":"SSH server private keys - files that match theglob, have to have restricted permissions.\nIf those files are owned by theuser and thegroup, they have to have thepermission or stricter."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_file_permissions_sshd_pub_key","kind":"notApplicable","level":"none","message":{"text":"To properly set the permissions of, run the command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_iptables_sshd_disabled","kind":"notApplicable","level":"none","message":{"text":"By default, inbound connections to SSH's port are allowed. If the SSH\nserver is not being used, this exception should be removed from the\nfirewall configuration.Edit the filesand(if IPv6 is in use). In each file, locate\nand delete the line:This is unusual, as SSH is a common method for encrypted and authenticated\nremote access."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_sssd_offline_cred_expiration","kind":"notApplicable","level":"none","message":{"text":"SSSD should be configured to expire offline credentials after 1 day.\n\nTo configure SSSD to expire offline credentials, settounder thesection in. For example:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]},{"ruleId":"xccdf_org.ssgproject.content_rule_package_xorg-x11-server-common_removed","kind":"pass","level":"none","message":{"text":"By removing the xorg-x11-server-common package, the system no longer has X Windows\ninstalled. If X Windows is not installed then the system cannot boot into graphical user mode.\nThis prevents the system from being accidentally or maliciously booted into amode. To do so, run the following command:."},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"file:///","uriBaseId":"ROOTPATH","index":0},"region":{"startLine":1,"startColumn":1,"endLine":1,"endColumn":1}}}]}],"tool":{"driver":{"name":"Heimdall Tools","version":"2.7.2","informationUri":"https://saf.cms.gov/#/normalize","rules":[{"id":"xccdf_org.ssgproject.content_rule_package_aide_installed","name":"InstallAIDE","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nThe AIDE package must be installed if it is to be available for integrity checking."},"shortDescription":{"text":"Install AIDE."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-6 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_aide_build_database","name":"BuildAndTestAIDEDatabase","fullDescription":{"text":"Run the following command to generate a new database:By default, the database will be written to the file.\n\nStoring the database, the configuration file, and the binary(or hashes of these files), in a secure location (such as on read-only media) provides additional assurance about their integrity.\nThe newly-generated database can be installed as follows:To initiate a manual check, run the following command:If this check produces any unexpected output, investigate."},"help":{"text":"rationale:\nFor AIDE to be effective, an initial database of \"known-good\" information about files\nmust be captured and it should be able to be verified against the installed files."},"shortDescription":{"text":"Build and Test AIDE Database."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_aide_check_audit_tools","name":"ConfigureAIDEToVerifyTheAuditTools","fullDescription":{"text":"The operating system file integrity tool must be configured to protect the integrity of the audit tools."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nDEBIAN_FRONTEND=noninteractive apt-get install -y \"aide\"\n\n\n\n\n\n\n\n\n\n\nif grep -i '^.*/usr/sbin/auditctl.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/auditctl.*#/usr/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/auditd.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/auditd.*#/usr/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/ausearch.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/ausearch.*#/usr/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/aureport.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/aureport.*#/usr/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/autrace.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/autrace.*#/usr/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/augenrules.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/augenrules.*#/usr/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nif grep -i '^.*/usr/sbin/audispd.*$' /etc/aide/aide.conf; then\nsed -i \"s#.*/usr/sbin/audispd.*#/usr/sbin/audispd p+i+n+u+g+s+b+acl+xattrs+sha512#\" /etc/aide/aide.conf\nelse\necho \"/usr/sbin/audispd p+i+n+u+g+s+b+acl+xattrs+sha512\" >> /etc/aide/aide.conf\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nProtecting the integrity of the tools used for auditing purposes is a\ncritical step toward ensuring the integrity of audit information. Audit\ninformation includes all information (e.g., audit records, audit settings,\nand audit reports) needed to successfully audit information system\nactivity.\n\nAudit tools include but are not limited to vendor-provided and open-source\naudit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code\ninto the existing tools to provide the capability to hide or erase system\nactivity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed to\nprovide the capability to identify when the audit tools have been modified,\nmanipulated, or replaced. An example is a checksum hash of the file or\nfiles."},"shortDescription":{"text":"Configure AIDE to Verify the Audit Tools."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 (3) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_aide_periodic_cron_checking","name":"ConfigurePeriodicExecutionOfAIDE","fullDescription":{"text":"At a minimum, AIDE should be configured to run a weekly scan.\nTo implement a daily execution of AIDE at 4:05am using cron, add the following line to:To implement a weekly execution of AIDE at 4:05am using cron, add the following line to:AIDE can be executed periodically through other means; this is merely one example.\nThe usage of cron's special time codes, such asandis acceptable."},"help":{"text":"rationale:\nBy default, AIDE does not install itself for periodic execution. Periodically\nrunning AIDE is necessary to reveal unexpected changes in installed files.Unauthorized changes to the baseline configuration could make the system vulnerable\nto various attacks or allow unauthorized access to the operating system. Changes to\noperating system configurations can have unintended side effects, some of which may\nbe relevant to security.Detecting such changes and providing an automated response can help avoid unintended,\nnegative consequences that could ultimately affect the security state of the operating\nsystem. The operating system's Information Management Officer (IMO)/Information System\nSecurity Officer (ISSO) and System Administrators (SAs) must be notified via email and/or\nmonitoring system trap when there is an unauthorized modification of a configuration item."},"shortDescription":{"text":"Configure Periodic Execution of AIDE."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-6 d","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-7 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_is_fips_mode_enabled","name":"Verify'/proc/sys/crypto/fips_enabled'Exists","fullDescription":{"text":"On a system where FIPS 140-2 mode is enabled,must exist.\nTo verify FIPS mode, run the following command:."},"help":{"text":"rationale:\nUse of weak or untested encryption algorithms undermines the purposes of utilizing encryption to\nprotect data. The operating system must implement cryptographic modules adhering to the higher\nstandards approved by the federal government since this provides assurance they have been tested\nand validated."},"shortDescription":{"text":"Verify '/proc/sys/crypto/fips_enabled' exists."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SC-12 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-12 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_harden_ssh_client_crypto_policy","name":"HardenSSHClientCryptoPolicy","fullDescription":{"text":"Crypto Policies are means of enforcing certain cryptographic settings for selected applications including OpenSSH client.\nTo override the system wide crypto policy for Openssh client, place a file in theso that it is loaded before the. In this case it is file namedcontaining parameters which need to be changed with respect to the crypto policy.\nThis rule checks if the file exists and if it contains required parameters and values which modify the Crypto Policy.\nDuring the parsing process, as soon as Openssh client parses some configuration option and its value, it remembers it and ignores any subsequent overrides. The customization mechanism provided by crypto policies appends eventual customizations at the end of the system wide crypto policy. Therefore, if the crypto policy customization overrides some parameter which is already configured in the system wide crypto policy, the SSH client will not honor that customized parameter."},"help":{"text":"fix:\n#the file starts with 02 so that it is loaded before the 05-redhat.conf which activates configuration provided by system vide crypto policy\nfile=\"/etc/ssh/ssh_config.d/02-ospp.conf\"\necho -e \"Match final all\\n\\\nRekeyLimit 512M 1h\\n\\\nGSSAPIAuthentication no\\n\\\nCiphers aes256-ctr,aes256-cbc,aes128-ctr,aes128-cbc\\n\\\nPubkeyAcceptedKeyTypes ssh-rsa,ecdsa-sha2-nistp384,ecdsa-sha2-nistp256\\n\\\nMACs hmac-sha2-512,hmac-sha2-256\\n\\\nKexAlgorithms ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group14-sha1\\n\" > \"$file\"\nrationale:\nThe Common Criteria requirements specify how certain parameters for OpenSSH Client are configured. Particular parameters are RekeyLimit, GSSAPIAuthentication, Ciphers, PubkeyAcceptedKeyTypes, MACs and KexAlgorithms. Currently particular requirements specified by CC are stricter compared to any existing Crypto Policy."},"shortDescription":{"text":"Harden SSH client Crypto Policy."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_installed_OS_is_FIPS_certified","name":"TheInstalledOperatingSystemIsFIPS140-2Certified","fullDescription":{"text":"To enable processing of sensitive information the operating system must\nprovide certified cryptographic modules compliant with FIPS 140-2\nstandard.\n\nUbuntu Linux is supported by Canonical Ltd. As the Ubuntu Linux Vendor, Canonical Ltd. is\nresponsible for government certifications and standards.\n\nUsers of Ubuntu Linux either need an Ubuntu Advantage subscription or need\nto be using Ubuntu Pro from a sponsored vendor in order to have access to\nFIPS content supported by Canonical."},"help":{"text":"rationale:\nThe Federal Information Processing Standard (FIPS) Publication 140-2, (FIPS\nPUB 140-2) is a computer security standard. The standard specifies security\nrequirements for cryptographic modules used to protect sensitive\nunclassified information.  Refer to the full FIPS 140-2 standard atfor further details on the requirements.\nFIPS 140-2 validation is required by U.S. law when information systems use\ncryptography to protect sensitive government information. In order to\nachieve FIPS 140-2 certification, cryptographic modules are subject to\nextensive testing by independent laboratories, accredited by National\nInstitute of Standards and Technology (NIST)."},"shortDescription":{"text":"The Installed Operating System Is FIPS 140-2 Certified."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-12","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-12 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-12 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_mcafeetp_installed","name":"InstallMcAfeeEndpointSecurityForLinux(ENSL)","fullDescription":{"text":"Install McAfee Endpoint Security for Linux antivirus software\nwhich is provided for DoD systems and uses signatures to search for the\npresence of viruses on the filesystem.\n\nThepackage can be installed with the following command:."},"help":{"text":"rationale:\nVirus scanning software can be used to detect if a system has been compromised by\ncomputer viruses, as well as to limit their spread to other systems.\nwarning:\nDue to McAfee Endpoint Security for Linux (ENSL) being 3rd party software,\nautomated remediation is not available for this configuration check."},"shortDescription":{"text":"Install McAfee Endpoint Security for Linux (ENSL)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-2 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-4 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_MFEhiplsm_installed","name":"InstallTheHostIntrusionPreventionSystem(HIPS)Module","fullDescription":{"text":"Install the McAfee Host Intrusion Prevention System (HIPS) Module if it is absolutely\nnecessary. If SELinux is enabled, do not install or enable this module."},"help":{"text":"fix:\n[[packages]]\nname = \"MFEhiplsm\"\nversion = \"*\"\nrationale:\nWithout a host-based intrusion detection tool, there is no system-level defense\nwhen an intruder gains access to a system or network. Additionally, a host-based\nintrusion prevention tool can provide methods to immediately lock out detected\nintrusion attempts."},"shortDescription":{"text":"Install the Host Intrusion Prevention System (HIPS) Module."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-2 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-4 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_configure_user_data_backups","name":"ConfigureBackupsOfUserData","fullDescription":{"text":"The operating system must conduct backups of user data contained\nin the operating system. The operating system provides utilities for\nautomating backups of user data. Commercial and open-source products\nare also available."},"help":{"text":"check:\nocil:ssg-configure_user_data_backups_ocil:questionnaire:1\nrationale:\nOperating system backup is a critical step in maintaining data assurance and\navailability. User-level information is data generated by information system\nand/or application users. Backups shall be consistent with organizational\nrecovery time and recovery point objectives."},"shortDescription":{"text":"Configure Backups of User Data."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_prelink_removed","name":"Package\"prelink\"MustNotBeInstalled","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"check:\noval:ssg-package_prelink_removed:def:1\nrationale:\nThe use of thepackage can interfere with the operation of AIDE since it binaries.\nPrelinking can also increase damage caused by vulnerability in a common library like libc."},"shortDescription":{"text":"Package \"prelink\" Must not be Installed."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_encrypt_partitions","name":"EncryptPartitions","fullDescription":{"text":"Ubuntu 22.04 natively supports partition encryption through the\nLinux Unified Key Setup-on-disk-format (LUKS) technology. The easiest way to\nencrypt a partition is during installation time.For manual installations, select thecheckbox during\npartition creation to encrypt the partition. When this\noption is selected the system will prompt for a passphrase to use in\ndecrypting the partition. The passphrase will subsequently need to be entered manually\nevery time the system boots.For automated/unattended installations, it is possible to use Kickstart by adding\ntheandoptions to the definition of each partition to be\nencrypted. For example, the following line would encrypt the root partition:Anyis stored in the Kickstart in plaintext, and the Kickstart\nmust then be protected accordingly.\nOmitting theoption from the partition definition will cause the\ninstaller to pause and interactively ask for the passphrase during installation.By default, theinstaller usescipher\nwith a minimumbit key size which should be compatible with FIPS enabled.Detailed information on encrypting partitions using LUKS or LUKS ciphers can be found on\nthe Ubuntu 22.04 Documentation web site:."},"help":{"text":"check:\nocil:ssg-encrypt_partitions_ocil:questionnaire:1\nrationale:\nThe risk of a system's physical compromise, particularly mobile systems such as\nlaptops, places its data at risk of compromise.  Encrypting this data mitigates\nthe risk of its loss if the system is lost."},"shortDescription":{"text":"Encrypt Partitions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-28","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-28 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_dev_shm","name":"Ensure/dev/shmIsConfigured","fullDescription":{"text":"Theis a traditional shared memory concept. \nOne program will create a memory portion, which other processes \n(if permitted) can access. Ifis not configured, \ntmpfs will be mounted to /dev/shm by systemd."},"help":{"text":"rationale:\nAny user can upload and execute files inside thesimilar to \nthepartition. Configuringallows an administrator \nto set the noexec option on the mount, making /dev/shm useless for an attacker to \ninstall executable code. It would also prevent an attacker from establishing a \nhardlink to a system setuid program and wait for it to be updated. Once the program \nwas updated, the hardlink would be broken and the attacker would have his own copy \nof the program. If the program happened to have a security vulnerability, the attacker \ncould continue to exploit the known flaw."},"shortDescription":{"text":"Ensure /dev/shm is configured."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_home","name":"Ensure/homeLocatedOnSeparatePartition","fullDescription":{"text":"If user home directories will be stored locally, create a separate partition\nforat installation time (or migrate it later using LVM). Ifwill be mounted from another system such as an NFS server, then\ncreating a separate partition is not necessary at installation time, and the\nmountpoint can instead be configured later."},"help":{"text":"rationale:\nEnsuring thatis mounted on its own partition enables the\nsetting of more restrictive mount options, and also helps ensure that\nusers cannot trivially fill partitions used for log or audit data storage."},"shortDescription":{"text":"Ensure /home Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-32","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_srv","name":"Ensure/srvLocatedOnSeparatePartition","fullDescription":{"text":"If a file server (FTP, TFTP...) is hosted locally, create a separate partition\nforat installation time (or migrate it later using LVM). Ifwill be mounted from another system such as an NFS server, then\ncreating a separate partition is not necessary at installation time, and the\nmountpoint can instead be configured later."},"help":{"text":"rationale:\nSrv deserves files for local network file server such as FTP. Ensuring\nthatis mounted on its own partition enables the setting of\nmore restrictive mount options, and also helps ensure that\nusers cannot trivially fill partitions used for log or audit data storage."},"shortDescription":{"text":"Ensure /srv Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_tmp","name":"Ensure/tmpLocatedOnSeparatePartition","fullDescription":{"text":"Thedirectory is a world-writable directory used\nfor temporary file storage. Ensure it has its own partition or\nlogical volume at installation time, or migrate it using LVM."},"help":{"text":"rationale:\nThepartition is used as temporary storage by many programs.\nPlacingin its own partition enables the setting of more\nrestrictive mount options, which can help protect programs which use it."},"shortDescription":{"text":"Ensure /tmp Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_var","name":"Ensure/varLocatedOnSeparatePartition","fullDescription":{"text":"Thedirectory is used by daemons and other system\nservices to store frequently-changing data. Ensure thathas its own partition\nor logical volume at installation time, or migrate it using LVM."},"help":{"text":"rationale:\nEnsuring thatis mounted on its own partition enables the\nsetting of more restrictive mount options. This helps protect\nsystem services such as daemons or other programs which use it.\nIt is not uncommon for thedirectory to contain\nworld-writable directories installed by other software packages."},"shortDescription":{"text":"Ensure /var Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_var_log","name":"Ensure/var/logLocatedOnSeparatePartition","fullDescription":{"text":"System logs are stored in thedirectory.\n\nEnsure thathas its own partition or logical\nvolume at installation time, or migrate it using LVM."},"help":{"text":"rationale:\nPlacingin its own partition\nenables better separation between log files\nand other files in."},"shortDescription":{"text":"Ensure /var/log Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_var_log_audit","name":"Ensure/var/log/auditLocatedOnSeparatePartition","fullDescription":{"text":"Audit logs are stored in thedirectory.\n\nEnsure thathas its own partition or logical\nvolume at installation time, or migrate it using LVM.\nMake absolutely certain that it is large enough to store all\naudit logs that will be created by the auditing daemon."},"help":{"text":"rationale:\nPlacingin its own partition\nenables better separation between audit files\nand other files, and helps ensure that\nauditing cannot be halted due to the partition running out\nof space."},"shortDescription":{"text":"Ensure /var/log/audit Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_partition_for_var_tmp","name":"Ensure/var/tmpLocatedOnSeparatePartition","fullDescription":{"text":"Thedirectory is a world-writable directory used\nfor temporary file storage. Ensure it has its own partition or\nlogical volume at installation time, or migrate it using LVM."},"help":{"text":"rationale:\nThepartition is used as temporary storage by many programs.\nPlacingin its own partition enables the setting of more\nrestrictive mount options, which can help protect programs which use it."},"shortDescription":{"text":"Ensure /var/tmp Located On Separate Partition."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_user_list","name":"DisableTheGNOME3LoginUserList","fullDescription":{"text":"In the default graphical environment, users logging directly into the\nsystem are greeted with a login screen that displays all known users.\nThis functionality should be disabled by settingto.To disable, add or editto. For example:Once the setting has been added, add a lock toto prevent\nuser modification. For example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/login-screen\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|gdm.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/gdm.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/gdm.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*disable-user-list\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)disable-user-list(\\s*=)/#\\1disable-user-list\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/login-screen\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/login-screen]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*disable-user-list\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*disable-user-list\\\\s*=\\\\s*.*/disable-user-list=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/login-screen\\\\]|a\\\\disable-user-list=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/login-screen/disable-user-list$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|gdm.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/gdm.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/login-screen/disable-user-list$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/login-screen/disable-user-list$\" /etc/dconf/db/gdm.d/\nthen\n    echo \"/org/gnome/login-screen/disable-user-list\" >> \"/etc/dconf/db/gdm.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nLeaving the user list enabled is a security risk since it allows anyone\nwith physical access to the system to quickly enumerate known user accounts\nwithout logging in."},"shortDescription":{"text":"Disable the GNOME3 Login User List."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-23","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_gnome_gdm_disable_xdmcp","name":"DisableXDMCPInGDM","fullDescription":{"text":"XDMCP is an unencrypted protocol, and therefore, presents a security risk, see e.g..\n\nTo disable XDMCP support in Gnome, settounder theconfiguration section in. For example:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed; then\n\n# Try find '[xdmcp]' and 'Enable' in '/etc/gdm3/custom.conf', if it exists, set\n# to 'false', if it isn't here, add it, if '[xdmcp]' doesn't exist, add it there\nif grep -qzosP '[[:space:]]*\\[xdmcp]([^\\n\\[]*\\n+)+?[[:space:]]*Enable' '/etc/gdm3/custom.conf'; then\n    \n    sed -i \"s/Enable[^(\\n)]*/Enable=false/\" '/etc/gdm3/custom.conf'\nelif grep -qs '[[:space:]]*\\[xdmcp]' '/etc/gdm3/custom.conf'; then\n    sed -i \"/[[:space:]]*\\[xdmcp]/a Enable=false\" '/etc/gdm3/custom.conf'\nelse\n    if test -d \"/etc/gdm3\"; then\n        printf '%s\\n' '[xdmcp]' \"Enable=false\" >> '/etc/gdm3/custom.conf'\n    else\n        echo \"Config file directory '/etc/gdm3' doesnt exist, not remediating, assuming non-applicability.\" >&2\n    fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nXDMCP provides unencrypted remote access through the Gnome Display Manager (GDM) which does\nnot provide for the confidentiality and integrity of user passwords or the\nremote session. If a privileged user were to login using XDMCP, the\nprivileged user password could be compromised due to typed XEvents\nand keystrokes will traversing over the network in clear text."},"shortDescription":{"text":"Disable XDMCP in GDM."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount","name":"DisableGNOME3Automounting","fullDescription":{"text":"The system's default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable automount within GNOME3, add or settoin.\nFor example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*automount\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)automount(\\s*=)/#\\1automount\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/media-handling]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"false\")\"\nif grep -q \"^\\\\s*automount\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*automount\\\\s*=\\\\s*.*/automount=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/media-handling\\\\]|a\\\\automount=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/media-handling/automount$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/media-handling/automount$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/media-handling/automount$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/media-handling/automount\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nDisabling automatic mounting in GNOME3 can prevent\nthe introduction of malware via removable media.\nIt will, however, also prevent desktop users from legitimate use\nof removable media."},"shortDescription":{"text":"Disable GNOME3 Automounting."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_automount_open","name":"DisableGNOME3AutomountOpening","fullDescription":{"text":"The system's default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable automount-open within GNOME3, add or settoin.\nFor example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*automount-open\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)automount-open(\\s*=)/#\\1automount-open\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/media-handling]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"false\")\"\nif grep -q \"^\\\\s*automount-open\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*automount-open\\\\s*=\\\\s*.*/automount-open=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/media-handling\\\\]|a\\\\automount-open=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/media-handling/automount-open$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/media-handling/automount-open$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/media-handling/automount-open$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/media-handling/automount-open\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAutomatically mounting file systems permits easy introduction of unknown devices, thereby facilitating malicious activity.\nDisabling automatic mounting in GNOME3 can prevent\nthe introduction of malware via removable media.\nIt will, however, also prevent desktop users from legitimate use\nof removable media."},"shortDescription":{"text":"Disable GNOME3 Automount Opening."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_autorun","name":"DisableGNOME3AutomountRunning","fullDescription":{"text":"The system's default desktop environment, GNOME3, will mount\ndevices and removable media (such as DVDs, CDs and USB flash drives) whenever\nthey are inserted into the system. To disable autorun-never within GNOME3, add or settoin.\nFor example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*autorun-never\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)autorun-never(\\s*=)/#\\1autorun-never\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/media-handling\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/media-handling]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*autorun-never\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*autorun-never\\\\s*=\\\\s*.*/autorun-never=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/media-handling\\\\]|a\\\\autorun-never=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/media-handling/autorun-never$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/media-handling/autorun-never$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/media-handling/autorun-never$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/media-handling/autorun-never\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAutomatically mounting file systems permits easy introduction of unknown devices, thereby facilitating malicious activity.\nDisabling automatic mount running in GNOME3 can prevent\nthe introduction of malware via removable media.\nIt will, however, also prevent desktop users from legitimate use\nof removable media."},"shortDescription":{"text":"Disable GNOME3 Automount running."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_lock_delay","name":"SetGNOME3ScreensaverLockDelayAfterActivationPeriod","fullDescription":{"text":"To activate the locking delay of the screensaver in the GNOME3 desktop when\nthe screensaver is activated, add or settoin. For example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\nvar_screensaver_lock_delay=''\n\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/screensaver\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*lock-delay\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)lock-delay(\\s*=)/#\\1lock-delay\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/screensaver\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/screensaver]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"uint32 ${var_screensaver_lock_delay}\")\"\nif grep -q \"^\\\\s*lock-delay\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*lock-delay\\\\s*=\\\\s*.*/lock-delay=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/screensaver\\\\]|a\\\\lock-delay=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nA session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity\nof the information system but does not want to logout because of the temporary nature of the absense."},"shortDescription":{"text":"Set GNOME3 Screensaver Lock Delay After Activation Period."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-11 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-11 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_screensaver_lock_enabled","name":"EnableGNOME3ScreensaverLockAfterIdlePeriod","fullDescription":{"text":"To activate locking of the screensaver in the GNOME3 desktop when it is activated,\nadd or settoin. For example:Once the settings have been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/desktop/screensaver\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*lock-enabled\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)lock-enabled(\\s*=)/#\\1lock-enabled\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/desktop/screensaver\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/desktop/screensaver]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*lock-enabled\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*lock-enabled\\\\s*=\\\\s*.*/lock-enabled=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/desktop/screensaver\\\\]|a\\\\lock-enabled=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/desktop/screensaver/lock-enabled$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/desktop/screensaver/lock-enabled$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/desktop/screensaver/lock-enabled$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/desktop/screensaver/lock-enabled\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nA session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity\nof the information system but does not want to logout because of the temporary nature of the absense."},"shortDescription":{"text":"Enable GNOME3 Screensaver Lock After Idle Period."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-11 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_disable_ctrlaltdel_reboot","name":"DisableCtrl-Alt-DelRebootKeySequenceInGNOME3","fullDescription":{"text":"By default,will reboot the system if thekey sequence is pressed.To configure the system to ignore thekey sequence\nfrom the Graphical User Interface (GUI) instead of rebooting the system,\nadd or settoin. For example:Once the settings have been added, add a lock toto prevent\nuser modification. For example:After the settings have been set, run."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/settings-daemon/plugins/media-keys\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|local.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/local.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/local.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*logout\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)logout(\\s*=)/#\\1logout\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/settings-daemon/plugins/media-keys\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/settings-daemon/plugins/media-keys]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"''\")\"\nif grep -q \"^\\\\s*logout\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*logout\\\\s*=\\\\s*.*/logout=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/settings-daemon/plugins/media-keys\\\\]|a\\\\logout=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/settings-daemon/plugins/media-keys/logout$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|local.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/local.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/settings-daemon/plugins/media-keys/logout$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/settings-daemon/plugins/media-keys/logout$\" /etc/dconf/db/local.d/\nthen\n    echo \"/org/gnome/settings-daemon/plugins/media-keys/logout\" >> \"/etc/dconf/db/local.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nA locally logged-in user who presses Ctrl-Alt-Del, when at the console,\ncan reboot the system. If accidentally pressed, as could happen in\nthe case of mixed OS environment, this can create the risk of short-term\nloss of availability of systems due to unintentional reboot."},"shortDescription":{"text":"Disable Ctrl-Alt-Del Reboot Key Sequence in GNOME3."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_gdm_removed","name":"RemoveTheGDMPackageGroup","fullDescription":{"text":"By removing thepackage, the system no longer has GNOME installed\n\ninstalled. If X Windows is not installed then the system cannot boot into graphical user mode.\nThis prevents the system from being accidentally or maliciously booted into amode. To do so, run the following command:."},"help":{"text":"rationale:\nUnnecessary service packages must not be installed to decrease the attack surface of the system.\nA graphical environment is unnecessary for certain types of systems including a virtualization\nhypervisor."},"shortDescription":{"text":"Remove the GDM Package Group."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_enable_dconf_user_profile","name":"ConfigureGNOME3DConfUserProfile","fullDescription":{"text":"By default, DConf provides a standard user profile. This profile contains a list\nof DConf configuration databases. The user profile and database always take the\nhighest priority. As such the DConf User profile should always exist and be\nconfigured correctly.To make sure that the user profile is configured correctly, theshould be set as follows:."},"help":{"text":"rationale:\nFailure to have a functional DConf profile prevents GNOME3 configuration settings\nfrom being enforced for all users and allows various security risks."},"shortDescription":{"text":"Configure GNOME3 DConf User Profile."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_sudo_installed","name":"InstallSudoPackage","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nis a program designed to allow a system administrator to give\nlimited root privileges to users and log root activity. The basic philosophy\nis to give as few privileges as possible but still allow system users to\nget their work done."},"shortDescription":{"text":"Install sudo Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_add_noexec","name":"EnsurePrivilegedEscalatedCommandsCannotExecuteOtherCommands-SudoNOEXEC","fullDescription":{"text":"The sudotag, when specified, prevents user executed\ncommands from executing other commands, like a shell for example.\nThis should be enabled by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin."},"help":{"text":"rationale:\nRestricting the capability of sudo allowed commands to execute sub-commands\nprevents users from running programs with privileges they wouldn't have otherwise."},"shortDescription":{"text":"Ensure Privileged Escalated Commands Cannot Execute Other Commands - sudo NOEXEC."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_add_requiretty","name":"EnsureOnlyUsersLoggedInToRealTtyCanExecuteSudo-SudoRequiretty","fullDescription":{"text":"The sudotag, when specified, will only execute sudo\ncommands from users logged in to a real tty.\nThis should be enabled by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin."},"help":{"text":"rationale:\nRestricting the use cases in which a user is allowed to execute sudo commands\nreduces the attack surface."},"shortDescription":{"text":"Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo requiretty."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_add_use_pty","name":"EnsureOnlyUsersLoggedInToRealTtyCanExecuteSudo-SudoUse_pty","fullDescription":{"text":"The sudotag, when specified, will only execute sudo\ncommands from users logged in to a real tty.\nThis should be enabled by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin."},"help":{"text":"rationale:\nRequiring that sudo commands be run in a pseudo-terminal can prevent an attacker from retaining\naccess to the user's terminal after the main program has finished executing."},"shortDescription":{"text":"Ensure Only Users Logged In To Real tty Can Execute Sudo - sudo use_pty."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_custom_logfile","name":"EnsureSudoLogfileExists-SudoLogfile","fullDescription":{"text":"A custom log sudo file can be configured with the 'logfile' tag. This rule configures\na sudo custom logfile at the default location suggested by CIS, which uses\n/var/log/sudo.log."},"help":{"text":"rationale:\nA sudo log file simplifies auditing of sudo commands."},"shortDescription":{"text":"Ensure Sudo Logfile Exists - sudo logfile."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_remove_no_authenticate","name":"EnsureUsersRe-AuthenticateForPrivilegeEscalation-Sudo!authenticate","fullDescription":{"text":"The sudooption, when specified, allows a user to execute commands using\nsudo without having to authenticate. This should be disabled by making sure that theoption does not exist inconfiguration file or\nany sudo configuration snippets in."},"help":{"text":"rationale:\nWithout re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.When operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate."},"shortDescription":{"text":"Ensure Users Re-Authenticate for Privilege Escalation - sudo !authenticate."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_remove_nopasswd","name":"EnsureUsersRe-AuthenticateForPrivilegeEscalation-SudoNOPASSWD","fullDescription":{"text":"The sudotag, when specified, allows a user to execute\ncommands using sudo without having to authenticate. This should be disabled\nby making sure that thetag does not exist inconfiguration file or any sudo configuration snippets\nin."},"help":{"text":"rationale:\nWithout re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.When operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate."},"shortDescription":{"text":"Ensure Users Re-Authenticate for Privilege Escalation - sudo NOPASSWD."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_require_authentication","name":"EnsureUsersRe-AuthenticateForPrivilegeEscalation-Sudo","fullDescription":{"text":"The sudoandoption, when\nspecified, allows a user to execute commands using sudo without having to\nauthenticate. This should be disabled by making sure thatand/ordo not exist inconfiguration file or any sudo configuration snippets\nin.\"."},"help":{"text":"rationale:\nWithout re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.When operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate."},"shortDescription":{"text":"Ensure Users Re-Authenticate for Privilege Escalation - sudo."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_require_reauthentication","name":"RequireRe-AuthenticationWhenUsingTheSudoCommand","fullDescription":{"text":"The sudotag sets the amount of time sudo password prompt waits.\nThe defaultvalue is 5 minutes.\nThe timestamp_timeout should be configured by making sure that thetag exists inconfiguration file or any sudo configuration snippets\nin.\nIf the value is set to an integer less than 0, the user's time stamp will not expire\nand the user will not have to re-authenticate for privileged actions until the user's session is terminated."},"help":{"text":"rationale:\nWithout re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.When operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate."},"shortDescription":{"text":"Require Re-Authentication When Using the sudo Command."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudo_vdsm_nopasswd","name":"OnlyTheVDSMUserCanUseSudoNOPASSWD","fullDescription":{"text":"The sudotag, when specified, allows a user to execute commands using sudo without having to authenticate. Only theuser should have this capability in any sudo configuration snippets in."},"help":{"text":"rationale:\nWithout re-authentication, users may access resources or perform tasks for which they\ndo not have authorization.When operating systems provide the capability to escalate a functional capability, it\nis critical that the user re-authenticate."},"shortDescription":{"text":"Only the VDSM User Can Use sudo NOPASSWD."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudoers_explicit_command_args","name":"ExplicitArgumentsInSudoSpecifications","fullDescription":{"text":"All commands in the sudoers file must strictly specify the arguments allowed to be used for a given user.\nIf the command is supposed to be executed only without arguments, pass \"\" as an argument in the corresponding user specification."},"help":{"text":"rationale:\nAny argument can modify quite significantly the behavior of a program, whether regarding the\nrealized operation (read, write, delete, etc.) or accessed resources (path in a file system tree). To\navoid any possibility of misuse of a command by a user, the ambiguities must be removed at the\nlevel of its specification.\n\nFor example, on some systems, the kernel messages are only accessible by root.\nIf a user nevertheless must have the privileges to read them, the argument of the dmesg command has to be restricted\nin order to prevent the user from flushing the buffer through the -c option:"},"shortDescription":{"text":"Explicit arguments in sudo specifications."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudoers_no_command_negation","name":"Don'tDefineAllowedCommandsInSudoersByMeansOfExclusion","fullDescription":{"text":"Policies applied by sudo through the sudoers file should not involve negation.\n\nEach user specification in thefile contains a comma-delimited list of command specifications.\nThe definition can make use glob patterns, as well as of negations.\nIndirect definition of those commands by means of exclusion of a set of commands is trivial to bypass, so it is not allowed to use such constructs."},"help":{"text":"rationale:\nSpecifying access right using negation is inefficient and can be easily circumvented.\nFor example, it is expected that a specification likeprevents the execution of the shell\nbut that’s not the case: just copy the binaryto a different name to make it executable\nagain through the rule keyword.\nwarning:\nThis rule doesn't come with a remediation, as negations indicate design issues with the sudoers user specifications design. Just removing negations doesn't increase the security - you typically have to rethink the definition of allowed commands to fix the issue."},"shortDescription":{"text":"Don't define allowed commands in sudoers by means of exclusion."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sudoers_no_root_target","name":"Don'tTargetRootUserInTheSudoersFile","fullDescription":{"text":"The targeted users of a user specification should be, as much as possible, non privileged users (i.e.: non-root).\n\nUser specifications have to explicitly list the runas spec (i.e. the list of target users that can be impersonated), andorshould not be used."},"help":{"text":"rationale:\nIt is common that the command to be executed does not require superuser rights (editing a file\nwhose the owner is not root, sending a signal to an unprivileged process,etc.). In order to limit\nany attempt of privilege escalation through a command, it is better to apply normal user rights.\nwarning:\nThis rule doesn't come with a remediation, as the exact requirement allows exceptions, and removing lines from the sudoers file can make the system non-administrable."},"shortDescription":{"text":"Don't target root user in the sudoers file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_gnutls-utils_installed","name":"EnsureGnutls-utilsIsInstalled","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nGnuTLS is a secure communications library implementing the SSL, TLS and DTLS\nprotocols and technologies around them. It provides a simple C language\napplication programming interface (API) to access the secure communications\nprotocols as well as APIs to parse and write X.509, PKCS #12, OpenPGP and\nother required structures.\nThis package contains command line TLS client and server and certificate\nmanipulation tools."},"shortDescription":{"text":"Ensure gnutls-utils is installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_nss-tools_installed","name":"EnsureNss-toolsIsInstalled","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nNetwork Security Services (NSS) is a set of libraries designed to\nsupport cross-platform development of security-enabled client and\nserver applications. Install thepackage\nto install command-line tools to manipulate the NSS certificate\nand key database."},"shortDescription":{"text":"Ensure nss-tools is installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_clean_components_post_updating","name":"EnsureApt_getRemovesPreviousPackageVersions","fullDescription":{"text":"should be configured to remove previous software components after\nnew versions have been installed. To configureto remove the\n\nprevious software components after updating, set theandtoin."},"help":{"text":"fix:\nflag1=1\nflag2=1\n\nfor file in /etc/apt/apt.conf.d/*; do\n    if [ -e \"$file\" ]; then\n        if grep -qi \"Unattended-Upgrade::Remove-Unused-Dependencies\" $file; then\n            sed -i --follow-symlinks \"s/^.*Unattended-Upgrade::Remove-Unused-Dependencies.*/Unattended-Upgrade::Remove-Unused-Dependencies \\\"true\\\";/I\" $file\n            flag1=0\n        fi\n\n        if grep -qi \"Unattended-Upgrade::Remove-Unused-Kernel-Packages\" $file; then\n            sed -i --follow-symlinks \"s/^.*Unattended-Upgrade::Remove-Unused-Kernel-Packages.*/Unattended-Upgrade::Remove-Unused-Kernel-Packages \\\"true\\\";/I\" $file\n            flag2=0\n        fi\n    fi\ndone\n\nif [ $flag1 ] || [ $flag2 ]; then\n    echo \"Unattended-Upgrade::Remove-Unused-Dependencies \\\"true\\\";\" >> /etc/apt/apt.conf.d/50unattended-upgrades\n    echo \"Unattended-Upgrade::Remove-Unused-Kernel-Packages \\\"true\\\";\" >> /etc/apt/apt.conf.d/50unattended-upgrades\nfi\nrationale:\nPrevious versions of software components that are not removed from the information\nsystem after updates have been installed may be exploited by some adversaries."},"shortDescription":{"text":"Ensure apt_get Removes Previous Package Versions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-11 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-11 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-2 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_prefer_64bit_os","name":"PreferToUseA64-bitOperatingSystemWhenSupported","fullDescription":{"text":"Prefer installation of 64-bit operating systems when the CPU supports it."},"help":{"text":"rationale:\nUse of a 64-bit operating system offers a few advantages, like a larger address space range for\nAddress Space Layout Randomization (ASLR) and systematic presence of No eXecute and Execute Disable (NX/XD) protection bits.\nwarning:\nThere is no remediation besides installing a 64-bit operating system."},"shortDescription":{"text":"Prefer to use a 64-bit Operating System when supported."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_banner_enabled","name":"EnableGNOME3LoginWarningBanner","fullDescription":{"text":"In the default graphical environment, displaying a login warning banner\nin the GNOME Display Manager's login screen can be enabled on the login\nscreen by settingto.To enable, add or editto. For example:Once the setting has been added, add a lock toto prevent user modification.\nFor example:After the settings have been set, run.\nThe banner text must also be set."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed; then\n\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/login-screen\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|gdm.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/gdm.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/gdm.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*banner-message-enable\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)banner-message-enable(\\s*=)/#\\1banner-message-enable\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/login-screen\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/login-screen]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"true\")\"\nif grep -q \"^\\\\s*banner-message-enable\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*banner-message-enable\\\\s*=\\\\s*.*/banner-message-enable=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/login-screen\\\\]|a\\\\banner-message-enable=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# Check for setting in any of the DConf db directories\nLOCKFILES=$(grep -r \"^/org/gnome/login-screen/banner-message-enable$\" \"/etc/dconf/db/\" \\\n            | grep -v 'distro\\|ibus\\|gdm.d' | grep \":\" | cut -d\":\" -f1)\nLOCKSFOLDER=\"/etc/dconf/db/gdm.d/locks\"\n\nmkdir -p \"${LOCKSFOLDER}\"\n\n# Comment out the configurations in databases different from the target one\nif [[ ! -z \"${LOCKFILES}\" ]]\nthen\n    sed -i -E \"s|^/org/gnome/login-screen/banner-message-enable$|#&|\" \"${LOCKFILES[@]}\"\nfi\n\nif ! grep -qr \"^/org/gnome/login-screen/banner-message-enable$\" /etc/dconf/db/gdm.d/\nthen\n    echo \"/org/gnome/login-screen/banner-message-enable\" >> \"/etc/dconf/db/gdm.d/locks/00-security-settings-lock\"\nfi\n\ndconf update\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nDisplay of a standardized and approved use notification before granting access to the operating system\nensures privacy and security notification verbiage used is consistent with applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance.For U.S. Government systems, system use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not exist."},"shortDescription":{"text":"Enable GNOME3 Login Warning Banner."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-8 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 1","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dconf_gnome_login_banner_text","name":"SetTheGNOME3LoginWarningBannerText","fullDescription":{"text":"In the default graphical environment, configuring the login warning banner text\nin the GNOME Display Manager's login screen can be configured on the login\nscreen by settingtowhereis the approved banner for your environment.To enable, add or editto. For example:After the settings have been set, run.\nWhen entering a warning banner that spans several lines, remember\nto begin and end the string withand usefor new lines."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'gdm3' 2>/dev/null | grep -q installed; then\n\nlogin_banner_text=''\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newline \"tokens\". (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"(n)*\")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/(n)*/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\\\//g')\n# 5 - Removes the newline \"token.\" (Transforms them into newline escape sequences \"\\n\").\n#    ( Needs to be done after 4, otherwise the escapce sequence will become just \"n\".\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/(n)\\*/\\\\n/g')\n\n# Will do both approach, since we plan to migrate to checks over dconf db. That way, future updates of the tool\n# will pass the check even if we decide to check only for the dconf db path.\nif [ -e \"/etc/gdm3/greeter.dconf-defaults\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*banner\\-message\\-text/Id\" \"/etc/gdm3/greeter.dconf-defaults\"\nelse\n    touch \"/etc/gdm3/greeter.dconf-defaults\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/gdm3/greeter.dconf-defaults\"\n\ncp \"/etc/gdm3/greeter.dconf-defaults\" \"/etc/gdm3/greeter.dconf-defaults.bak\"\n# Insert after the line matching the regex '\\[org/gnome/login-screen\\]'\nline_number=\"$(LC_ALL=C grep -n \"\\[org/gnome/login-screen\\]\" \"/etc/gdm3/greeter.dconf-defaults.bak\" | LC_ALL=C sed 's/:.*//g')\"\nif [ -z \"$line_number\" ]; then\n    # There was no match of '\\[org/gnome/login-screen\\]', insert at\n    # the end of the file.\n    printf '%s\\n' \"banner-message-text='${login_banner_text}'\" >> \"/etc/gdm3/greeter.dconf-defaults\"\nelse\n    head -n \"$(( line_number ))\" \"/etc/gdm3/greeter.dconf-defaults.bak\" > \"/etc/gdm3/greeter.dconf-defaults\"\n    printf '%s\\n' \"banner-message-text='${login_banner_text}'\" >> \"/etc/gdm3/greeter.dconf-defaults\"\n    tail -n \"+$(( line_number + 1 ))\" \"/etc/gdm3/greeter.dconf-defaults.bak\" >> \"/etc/gdm3/greeter.dconf-defaults\"\nfi\n# Clean up after ourselves.\nrm \"/etc/gdm3/greeter.dconf-defaults.bak\"\n# Check for setting in any of the DConf db directories\n# If files contain ibus or distro, ignore them.\n# The assignment assumes that individual filenames don't contain :\nreadarray -t SETTINGSFILES < <(grep -r \"\\\\[org/gnome/login-screen\\\\]\" \"/etc/dconf/db/\" \\\n                                | grep -v 'distro\\|ibus\\|gdm.d' | cut -d\":\" -f1)\nDCONFFILE=\"/etc/dconf/db/gdm.d/00-security-settings\"\nDBDIR=\"/etc/dconf/db/gdm.d\"\n\nmkdir -p \"${DBDIR}\"\n\n# Comment out the configurations in databases different from the target one\nif [ \"${#SETTINGSFILES[@]}\" -ne 0 ]\nthen\n    if grep -q \"^\\\\s*banner-message-text\\\\s*=\" \"${SETTINGSFILES[@]}\"\n    then\n        \n        sed -Ei \"s/(^\\s*)banner-message-text(\\s*=)/#\\1banner-message-text\\2/g\" \"${SETTINGSFILES[@]}\"\n    fi\nfi\n\n\n[ ! -z \"${DCONFFILE}\" ] && echo \"\" >> \"${DCONFFILE}\"\nif ! grep -q \"\\\\[org/gnome/login-screen\\\\]\" \"${DCONFFILE}\"\nthen\n    printf '%s\\n' \"[org/gnome/login-screen]\" >> ${DCONFFILE}\nfi\n\nescaped_value=\"$(sed -e 's/\\\\/\\\\\\\\/g' <<< \"'${login_banner_text}'\")\"\nif grep -q \"^\\\\s*banner-message-text\\\\s*=\" \"${DCONFFILE}\"\nthen\n        sed -i \"s/\\\\s*banner-message-text\\\\s*=\\\\s*.*/banner-message-text=${escaped_value}/g\" \"${DCONFFILE}\"\n    else\n        sed -i \"\\\\|\\\\[org/gnome/login-screen\\\\]|a\\\\banner-message-text=${escaped_value}\" \"${DCONFFILE}\"\nfi\n\ndconf update\n# No need to use dconf update, since bash_dconf_settings does that already\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAn appropriate warning message reinforces policy awareness during the logon\nprocess and facilitates possible legal action against attackers."},"shortDescription":{"text":"Set the GNOME3 Login Warning Banner Text."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-8 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 1","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_banner_etc_issue","name":"ModifyTheSystemLoginBanner","fullDescription":{"text":"To configure the system login banner edit. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\n\nThe DoD required text is either:OR:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nlogin_banner_text=''\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newlines. (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"\\n\")\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/\\n/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nlogin_banner_text=$(echo \"$login_banner_text\" | sed 's/\\\\//g')\nformatted=$(echo \"$login_banner_text\" | fold -sw 80)\ncat </etc/issue\n$formatted\nEOF\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.System use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not\nexist."},"shortDescription":{"text":"Modify the System Login Banner."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-8 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 1","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_banner_etc_issue_net","name":"ModifyTheSystemLoginBannerForRemoteConnections","fullDescription":{"text":"To configure the system login banner edit. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\nThe DoD required text is either:OR:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.System use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not\nexist."},"shortDescription":{"text":"Modify the System Login Banner for Remote Connections."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-8 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 1","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_banner_etc_motd","name":"ModifyTheSystemMessageOfTheDayBanner","fullDescription":{"text":"To configure the system message banner edit. Replace the\ndefault text with a message compliant with the local site policy or a legal\ndisclaimer.\n\nThe DoD required text is either:OR:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nmotd_banner_text=''\n\n\n# Multiple regexes transform the banner regex into a usable banner\n# 0 - Remove anchors around the banner text\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/^\\^\\(.*\\)\\$$/\\1/g')\n# 1 - Keep only the first banners if there are multiple\n#    (dod_banners contains the long and short banner)\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/^(\\(.*\\.\\)|.*)$/\\1/g')\n# 2 - Add spaces ' '. (Transforms regex for \"space or newline\" into a \" \")\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/\\[\\\\s\\\\n\\]+/ /g')\n# 3 - Adds newlines. (Transforms \"(?:\\[\\\\n\\]+|(?:\\\\n)+)\" into \"\\n\")\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/(?:\\[\\\\n\\]+|(?:\\\\\\\\n)+)/\\n/g')\n# 4 - Remove any leftover backslash. (From any parethesis in the banner, for example).\nmotd_banner_text=$(echo \"$motd_banner_text\" | sed 's/\\\\//g')\nformatted=$(echo \"$motd_banner_text\" | fold -sw 80)\n\ncat </etc/motd\n$formatted\nEOF\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.System use notifications are required only for access via login interfaces\nwith human users and are not required when such human interfaces do not\nexist."},"shortDescription":{"text":"Modify the System Message of the Day Banner."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue","name":"VerifyGroupOwnershipOfSystemLoginBanner","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper group ownership will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify Group Ownership of System Login Banner."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_issue_net","name":"VerifyGroupOwnershipOfSystemLoginBannerForRemoteConnections","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper group ownership will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify Group Ownership of System Login Banner for Remote Connections."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_motd","name":"VerifyGroupOwnershipOfMessageOfTheDayBanner","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper group ownership will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify Group Ownership of Message of the Day Banner."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_issue","name":"VerifyOwnershipOfSystemLoginBanner","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper ownership will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify ownership of System Login Banner."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_issue_net","name":"VerifyOwnershipOfSystemLoginBannerForRemoteConnections","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper ownership will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify ownership of System Login Banner for Remote Connections."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_motd","name":"VerifyOwnershipOfMessageOfTheDayBanner","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper ownership will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify ownership of Message of the Day Banner."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_issue","name":"VerifyPermissionsOnSystemLoginBanner","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper permissions will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify permissions on System Login Banner."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_issue_net","name":"VerifyPermissionsOnSystemLoginBannerForRemoteConnections","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper permissions will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify permissions on System Login Banner for Remote Connections."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_motd","name":"VerifyPermissionsOnMessageOfTheDayBanner","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nDisplay of a standardized and approved use notification before granting\naccess to the operating system ensures privacy and security notification\nverbiage used is consistent with applicable federal laws, Executive Orders,\ndirectives, policies, regulations, standards, and guidance.Proper permissions will ensure that only root user can modify the banner."},"shortDescription":{"text":"Verify permissions on Message of the Day Banner."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_account_passwords_pam_faillock_audit","name":"AccountLockoutsMustBeLogged","fullDescription":{"text":"PAM faillock locks an account due to excessive password failures, this event must be logged."},"help":{"text":"rationale:\nWithout auditing of these events it may be harder or impossible to identify what an attacker did after an attack.\nwarning:\nThis rule is deprecated in favor of therule.\nPlease consider replacing this rule in your files as it is not expected to receive\nupdates as of version."},"shortDescription":{"text":"Account Lockouts Must Be Logged."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_account_passwords_pam_faillock_dir","name":"AccountLockoutsMustPersist","fullDescription":{"text":"By setting a `dir` in the faillock configuration account lockouts will persist across reboots."},"help":{"text":"check:\nocil:ssg-account_passwords_pam_faillock_dir_ocil:questionnaire:1\nrationale:\nHaving lockouts persist across reboots ensures that account is only unlocked by an administrator.\nIf the lockouts did not persist across reboots an attack could simply reboot the system to continue brute force attacks against the accounts on the system.\nwarning:\nThis rule is deprecated in favor of therule.\nPlease consider replacing this rule in your files as it is not expected to receive\nupdates as of version."},"shortDescription":{"text":"Account Lockouts Must Persist."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 ia.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_unix_remember","name":"LimitPasswordReuse","fullDescription":{"text":"Do not allow users to reuse recent passwords. This can be accomplished by using theoption for theorPAM modules."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nvar_password_pam_unix_remember=''\n\n\nif [ -e \"/etc/pam.d/common-password\" ] ; then\n    valueRegex=\"$var_password_pam_unix_remember\" defaultValue=\"$var_password_pam_unix_remember\"\n    # non-empty values need to be preceded by an equals sign\n    [ -n \"${valueRegex}\" ] && valueRegex=\"=${valueRegex}\"\n    # add an equals sign to non-empty values\n    [ -n \"${defaultValue}\" ] && defaultValue=\"=${defaultValue}\"\n\n    # fix 'type' if it's wrong\n    if grep -q -P \"^\\\\s*(?\"'!'\"password\\\\s)[[:alnum:]]+\\\\s+[[:alnum:]]+\\\\s+pam_unix.so\" < \"/etc/pam.d/common-password\" ; then\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*)[[:alnum:]]+(\\\\s+[[:alnum:]]+\\\\s+pam_unix.so)/\\\\1password\\\\2/\" \"/etc/pam.d/common-password\"\n    fi\n\n    # fix 'control' if it's wrong\n    if grep -q -P \"^\\\\s*password\\\\s+(?\"'!'\"\\[success=[[:alnum:]].*\\])[[:alnum:]]+\\\\s+pam_unix.so\" < \"/etc/pam.d/common-password\" ; then\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*password\\\\s+)[[:alnum:]]+(\\\\s+pam_unix.so)/\\\\1\\[success=[[:alnum:]].*\\]\\\\2/\" \"/etc/pam.d/common-password\"\n    fi\n\n    # fix the value for 'option' if one exists but does not match 'valueRegex'\n    if grep -q -P \"^\\\\s*password\\\\s+\\[success=[[:alnum:]].*\\]\\\\s+pam_unix.so(\\\\s.+)?\\\\s+remember(?\"'!'\"${valueRegex}(\\\\s|\\$))\" < \"/etc/pam.d/common-password\" ; then\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*password\\\\s+\\[success=[[:alnum:]].*\\]\\\\s+pam_unix.so(\\\\s.+)?\\\\s)remember=[^[:space:]]*/\\\\1remember${defaultValue}/\" \"/etc/pam.d/common-password\"\n\n    # add 'option=default' if option is not set\n    elif grep -q -E \"^\\\\s*password\\\\s+\\[success=[[:alnum:]].*\\]\\\\s+pam_unix.so\" < \"/etc/pam.d/common-password\" &&\n            grep    -E \"^\\\\s*password\\\\s+\\[success=[[:alnum:]].*\\]\\\\s+pam_unix.so\" < \"/etc/pam.d/common-password\" | grep -q -E -v \"\\\\sremember(=|\\\\s|\\$)\" ; then\n\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*password\\\\s+\\[success=[[:alnum:]].*\\]\\\\s+pam_unix.so[^\\\\n]*)/\\\\1 remember${defaultValue}/\" \"/etc/pam.d/common-password\"\n    # add a new entry if none exists\n    elif ! grep -q -P \"^\\\\s*password\\\\s+\\[success=[[:alnum:]].*\\]\\\\s+pam_unix.so(\\\\s.+)?\\\\s+remember${valueRegex}(\\\\s|\\$)\" < \"/etc/pam.d/common-password\" ; then\n        echo \"password \\[success=[[:alnum:]].*\\] pam_unix.so remember${defaultValue}\" >> \"/etc/pam.d/common-password\"\n    fi\nelse\n    echo \"/etc/pam.d/common-password doesn't exist\" >&2\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nPreventing re-use of previous passwords helps ensure that a compromised password is not\nre-used by a user."},"shortDescription":{"text":"Limit Password Reuse."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-5 (1) (e)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) e.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_audit","name":"AccountLockoutsMustBeLogged","fullDescription":{"text":"PAM faillock locks an account due to excessive password failures, this event must be logged."},"help":{"text":"rationale:\nWithout auditing of these events it may be harder or impossible to identify what an attacker did after an attack."},"shortDescription":{"text":"Account Lockouts Must Be Logged."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_deny","name":"LockAccountsAfterFailedPasswordAttempts","fullDescription":{"text":"This rule configures the system to lock out accounts after a number of incorrect login attempts\nusing.\npam_faillock.so module requires multiple entries in pam files. These entries must be carefully\ndefined to work as expected.\n\nEnsure that the filecontains the following entry:Where count should be less than or equal toand greater than 0."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nvar_accounts_passwords_pam_faillock_deny=''\n\n\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \npam_file=\"/etc/pam.d/common-auth\"\nif ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+preauth.*$' \"$pam_file\" ; then\n    sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth' \"$pam_file\"\nfi\nif ! grep -qE '^\\s*auth\\s+\\[default=die\\]\\s+pam_faillock\\.so\\s+authfail.*$' \"$pam_file\" ; then\n    num_lines=$(sed -n 's/^auth.*success=\\([0-9]\\).*pam_unix\\.so.*/\\1/p' \"$pam_file\")\n    if [ ! -z \"$num_lines\" ]; then\n        echo \"$num_lines\"\n        pattern=\"\"\n        for ((i=1; i <= num_lines; i++)); do\n            pattern=\"${pattern}n;\"\n        done;\n        sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/{'$pattern'a auth        [default=die]      pam_faillock.so authfail\n }' \"$pam_file\"\n    else\n        sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/a auth        [default=die]      pam_faillock.so authfail' \"$pam_file\"\n    fi\nfi\nif ! grep -qE '^\\s*auth\\s+sufficient\\s+pam_faillock\\.so\\s+authsucc.*$' \"$pam_file\" ; then\n    sed -i --follow-symlinks '/^auth.*pam_faillock\\.so.*authfail.*/a auth        sufficient      pam_faillock.so authsucc' \"$pam_file\"\nfi\n\npam_file=\"/etc/pam.d/common-account\"\nif ! grep -qE '^\\s*account\\s+required\\s+pam_faillock\\.so.*$' \"$pam_file\" ; then\n    echo 'account   required     pam_faillock.so' >> \"$pam_file\"\nfi\n\nfi\n\nAUTH_FILES=(\"/etc/pam.d/common-auth\" \"/etc/pam.d/password-auth\")\n\nFAILLOCK_CONF=\"/etc/security/faillock.conf\"\nif [ -f $FAILLOCK_CONF ]; then\n    regex=\"^\\s*deny\\s*=\"\n    line=\"deny = $var_accounts_passwords_pam_faillock_deny\"\n    if ! grep -q $regex $FAILLOCK_CONF; then\n        echo $line >> $FAILLOCK_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(deny\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_accounts_passwords_pam_faillock_deny\"'|g' $FAILLOCK_CONF\n    fi\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if [ -e \"$pam_file\" ] ; then\n            PAM_FILE_PATH=\"$pam_file\"\n            if [ -f /usr/bin/authselect ]; then\n                \n                if ! authselect check; then\n                echo \"\n                authselect integrity check failed. Remediation aborted!\n                This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n                It is not recommended to manually edit the PAM files when authselect tool is available.\n                In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n                exit 1\n                fi\n\n                CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n                # If not already in use, a custom profile is created preserving the enabled features.\n                if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                    ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                    authselect create-profile hardening -b $CURRENT_PROFILE\n                    CURRENT_PROFILE=\"custom/hardening\"\n                    \n                    authselect apply-changes -b --backup=before-hardening-custom-profile\n                    authselect select $CURRENT_PROFILE\n                    for feature in $ENABLED_FEATURES; do\n                        authselect enable-feature $feature;\n                    done\n                    \n                    authselect apply-changes -b --backup=after-hardening-custom-profile\n                fi\n                PAM_FILE_NAME=$(basename \"$pam_file\")\n                PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n                authselect apply-changes -b\n            fi\n            \n        if grep -qP '^\\s*auth\\s.*\\bpam_faillock.so\\s.*\\bdeny\\b' \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks 's/(.*auth.*pam_faillock.so.*)\\bdeny\\b=?[[:alnum:]]*(.*)/\\1\\2/g' \"$PAM_FILE_PATH\"\n        fi\n            if [ -f /usr/bin/authselect ]; then\n                \n                authselect apply-changes -b\n            fi\n        else\n            echo \"$pam_file was not found\" >&2\n        fi\n    done\nelse\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if ! grep -qE '^\\s*auth.*pam_faillock\\.so (preauth|authfail).*deny' \"$pam_file\"; then\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*preauth.*silent.*/ s/$/ deny='\"$var_accounts_passwords_pam_faillock_deny\"'/' \"$pam_file\"\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*authfail.*/ s/$/ deny='\"$var_accounts_passwords_pam_faillock_deny\"'/' \"$pam_file\"\n        else\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*preauth.*silent.*\\)\\('\"deny\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_deny\"'\\3/' \"$pam_file\"\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*authfail.*\\)\\('\"deny\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_deny\"'\\3/' \"$pam_file\"\n        fi\n    done\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nBy limiting the number of failed logon attempts, the risk of unauthorized system access via\nuser password guessing, also known as brute-forcing, is reduced. Limits are imposed by locking\nthe account.\nwarning:\nIf the system relies ontool to manage PAM settings, the remediation\nwill also usetool. However, if any manual modification was made in\nPAM files, theintegrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.\nIf the system supports thefile, the pam_faillock\nparameters should be defined infile."},"shortDescription":{"text":"Lock Accounts After Failed Password Attempts."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_interval","name":"SetIntervalForCountingFailedPasswordAttempts","fullDescription":{"text":"Utilizing, thedirective configures the system\nto lock out an account after a number of incorrect login attempts within a specified time\nperiod.\n\nEnsure that the filecontains the following entry:whereisor greater."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nvar_accounts_passwords_pam_faillock_fail_interval=''\n\n\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \npam_file=\"/etc/pam.d/common-auth\"\nif ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+preauth.*$' \"$pam_file\" ; then\n    sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth' \"$pam_file\"\nfi\nif ! grep -qE '^\\s*auth\\s+\\[default=die\\]\\s+pam_faillock\\.so\\s+authfail.*$' \"$pam_file\" ; then\n    num_lines=$(sed -n 's/^auth.*success=\\([0-9]\\).*pam_unix\\.so.*/\\1/p' \"$pam_file\")\n    if [ ! -z \"$num_lines\" ]; then\n        echo \"$num_lines\"\n        pattern=\"\"\n        for ((i=1; i <= num_lines; i++)); do\n            pattern=\"${pattern}n;\"\n        done;\n        sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/{'$pattern'a auth        [default=die]      pam_faillock.so authfail\n }' \"$pam_file\"\n    else\n        sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/a auth        [default=die]      pam_faillock.so authfail' \"$pam_file\"\n    fi\nfi\nif ! grep -qE '^\\s*auth\\s+sufficient\\s+pam_faillock\\.so\\s+authsucc.*$' \"$pam_file\" ; then\n    sed -i --follow-symlinks '/^auth.*pam_faillock\\.so.*authfail.*/a auth        sufficient      pam_faillock.so authsucc' \"$pam_file\"\nfi\n\npam_file=\"/etc/pam.d/common-account\"\nif ! grep -qE '^\\s*account\\s+required\\s+pam_faillock\\.so.*$' \"$pam_file\" ; then\n    echo 'account   required     pam_faillock.so' >> \"$pam_file\"\nfi\n\nfi\n\nAUTH_FILES=(\"/etc/pam.d/common-auth\" \"/etc/pam.d/password-auth\")\n\nFAILLOCK_CONF=\"/etc/security/faillock.conf\"\nif [ -f $FAILLOCK_CONF ]; then\n    regex=\"^\\s*fail_interval\\s*=\"\n    line=\"fail_interval = $var_accounts_passwords_pam_faillock_fail_interval\"\n    if ! grep -q $regex $FAILLOCK_CONF; then\n        echo $line >> $FAILLOCK_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(fail_interval\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_accounts_passwords_pam_faillock_fail_interval\"'|g' $FAILLOCK_CONF\n    fi\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if [ -e \"$pam_file\" ] ; then\n            PAM_FILE_PATH=\"$pam_file\"\n            if [ -f /usr/bin/authselect ]; then\n                \n                if ! authselect check; then\n                echo \"\n                authselect integrity check failed. Remediation aborted!\n                This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n                It is not recommended to manually edit the PAM files when authselect tool is available.\n                In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n                exit 1\n                fi\n\n                CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n                # If not already in use, a custom profile is created preserving the enabled features.\n                if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                    ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                    authselect create-profile hardening -b $CURRENT_PROFILE\n                    CURRENT_PROFILE=\"custom/hardening\"\n                    \n                    authselect apply-changes -b --backup=before-hardening-custom-profile\n                    authselect select $CURRENT_PROFILE\n                    for feature in $ENABLED_FEATURES; do\n                        authselect enable-feature $feature;\n                    done\n                    \n                    authselect apply-changes -b --backup=after-hardening-custom-profile\n                fi\n                PAM_FILE_NAME=$(basename \"$pam_file\")\n                PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n                authselect apply-changes -b\n            fi\n            \n        if grep -qP '^\\s*auth\\s.*\\bpam_faillock.so\\s.*\\bfail_interval\\b' \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks 's/(.*auth.*pam_faillock.so.*)\\bfail_interval\\b=?[[:alnum:]]*(.*)/\\1\\2/g' \"$PAM_FILE_PATH\"\n        fi\n            if [ -f /usr/bin/authselect ]; then\n                \n                authselect apply-changes -b\n            fi\n        else\n            echo \"$pam_file was not found\" >&2\n        fi\n    done\nelse\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if ! grep -qE '^\\s*auth.*pam_faillock\\.so (preauth|authfail).*fail_interval' \"$pam_file\"; then\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*preauth.*silent.*/ s/$/ fail_interval='\"$var_accounts_passwords_pam_faillock_fail_interval\"'/' \"$pam_file\"\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*authfail.*/ s/$/ fail_interval='\"$var_accounts_passwords_pam_faillock_fail_interval\"'/' \"$pam_file\"\n        else\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*preauth.*silent.*\\)\\('\"fail_interval\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_fail_interval\"'\\3/' \"$pam_file\"\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*authfail.*\\)\\('\"fail_interval\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_fail_interval\"'\\3/' \"$pam_file\"\n        fi\n    done\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nBy limiting the number of failed logon attempts the risk of unauthorized system\naccess via user password guessing, otherwise known as brute-forcing, is reduced.\nLimits are imposed by locking the account.\nwarning:\nIf the system relies ontool to manage PAM settings, the remediation\nwill also usetool. However, if any manual modification was made in\nPAM files, theintegrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.\nIf the system supports thefile, the pam_faillock\nparameters should be defined infile."},"shortDescription":{"text":"Set Interval For Counting Failed Password Attempts."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_passwords_pam_faillock_unlock_time","name":"SetLockoutTimeForFailedPasswordAttempts","fullDescription":{"text":"This rule configures the system to lock out accounts during a specified time period after a\nnumber of incorrect login attempts using.\n\n\nEnsure that the filecontains the following entry:whereisor greater.\n\n\npam_faillock.so module requires multiple entries in pam files. These entries must be carefully\ndefined to work as expected. In order to avoid any errors when manually editing these files,\nit is recommended to use the appropriate tools, such asor,\ndepending on the OS version.\n\nIfis set to, manual intervention by an administrator is required\nto unlock a user. This should be done using thetool."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nvar_accounts_passwords_pam_faillock_unlock_time=''\n\n\nif [ -f /usr/bin/authselect ]; then\n    if ! authselect check; then\necho \"\nauthselect integrity check failed. Remediation aborted!\nThis remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\nIt is not recommended to manually edit the PAM files when authselect tool is available.\nIn cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\nexit 1\nfi\nauthselect enable-feature with-faillock\n\nauthselect apply-changes -b\nelse\n    \npam_file=\"/etc/pam.d/common-auth\"\nif ! grep -qE '^\\s*auth\\s+required\\s+pam_faillock\\.so\\s+preauth.*$' \"$pam_file\" ; then\n    sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/i auth        required      pam_faillock.so preauth' \"$pam_file\"\nfi\nif ! grep -qE '^\\s*auth\\s+\\[default=die\\]\\s+pam_faillock\\.so\\s+authfail.*$' \"$pam_file\" ; then\n    num_lines=$(sed -n 's/^auth.*success=\\([0-9]\\).*pam_unix\\.so.*/\\1/p' \"$pam_file\")\n    if [ ! -z \"$num_lines\" ]; then\n        echo \"$num_lines\"\n        pattern=\"\"\n        for ((i=1; i <= num_lines; i++)); do\n            pattern=\"${pattern}n;\"\n        done;\n        sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/{'$pattern'a auth        [default=die]      pam_faillock.so authfail\n }' \"$pam_file\"\n    else\n        sed -i --follow-symlinks '/^auth.*pam_unix\\.so.*/a auth        [default=die]      pam_faillock.so authfail' \"$pam_file\"\n    fi\nfi\nif ! grep -qE '^\\s*auth\\s+sufficient\\s+pam_faillock\\.so\\s+authsucc.*$' \"$pam_file\" ; then\n    sed -i --follow-symlinks '/^auth.*pam_faillock\\.so.*authfail.*/a auth        sufficient      pam_faillock.so authsucc' \"$pam_file\"\nfi\n\npam_file=\"/etc/pam.d/common-account\"\nif ! grep -qE '^\\s*account\\s+required\\s+pam_faillock\\.so.*$' \"$pam_file\" ; then\n    echo 'account   required     pam_faillock.so' >> \"$pam_file\"\nfi\n\nfi\n\nAUTH_FILES=(\"/etc/pam.d/common-auth\" \"/etc/pam.d/password-auth\")\n\nFAILLOCK_CONF=\"/etc/security/faillock.conf\"\nif [ -f $FAILLOCK_CONF ]; then\n    regex=\"^\\s*unlock_time\\s*=\"\n    line=\"unlock_time = $var_accounts_passwords_pam_faillock_unlock_time\"\n    if ! grep -q $regex $FAILLOCK_CONF; then\n        echo $line >> $FAILLOCK_CONF\n    else\n        sed -i --follow-symlinks 's|^\\s*\\(unlock_time\\s*=\\s*\\)\\(\\S\\+\\)|\\1'\"$var_accounts_passwords_pam_faillock_unlock_time\"'|g' $FAILLOCK_CONF\n    fi\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if [ -e \"$pam_file\" ] ; then\n            PAM_FILE_PATH=\"$pam_file\"\n            if [ -f /usr/bin/authselect ]; then\n                \n                if ! authselect check; then\n                echo \"\n                authselect integrity check failed. Remediation aborted!\n                This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n                It is not recommended to manually edit the PAM files when authselect tool is available.\n                In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n                exit 1\n                fi\n\n                CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n                # If not already in use, a custom profile is created preserving the enabled features.\n                if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n                    ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n                    authselect create-profile hardening -b $CURRENT_PROFILE\n                    CURRENT_PROFILE=\"custom/hardening\"\n                    \n                    authselect apply-changes -b --backup=before-hardening-custom-profile\n                    authselect select $CURRENT_PROFILE\n                    for feature in $ENABLED_FEATURES; do\n                        authselect enable-feature $feature;\n                    done\n                    \n                    authselect apply-changes -b --backup=after-hardening-custom-profile\n                fi\n                PAM_FILE_NAME=$(basename \"$pam_file\")\n                PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n                authselect apply-changes -b\n            fi\n            \n        if grep -qP '^\\s*auth\\s.*\\bpam_faillock.so\\s.*\\bunlock_time\\b' \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks 's/(.*auth.*pam_faillock.so.*)\\bunlock_time\\b=?[[:alnum:]]*(.*)/\\1\\2/g' \"$PAM_FILE_PATH\"\n        fi\n            if [ -f /usr/bin/authselect ]; then\n                \n                authselect apply-changes -b\n            fi\n        else\n            echo \"$pam_file was not found\" >&2\n        fi\n    done\nelse\n    for pam_file in \"${AUTH_FILES[@]}\"\n    do\n        if ! grep -qE '^\\s*auth.*pam_faillock\\.so (preauth|authfail).*unlock_time' \"$pam_file\"; then\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*preauth.*silent.*/ s/$/ unlock_time='\"$var_accounts_passwords_pam_faillock_unlock_time\"'/' \"$pam_file\"\n            sed -i --follow-symlinks '/^auth.*required.*pam_faillock\\.so.*authfail.*/ s/$/ unlock_time='\"$var_accounts_passwords_pam_faillock_unlock_time\"'/' \"$pam_file\"\n        else\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*preauth.*silent.*\\)\\('\"unlock_time\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_unlock_time\"'\\3/' \"$pam_file\"\n            sed -i --follow-symlinks 's/\\(^auth.*required.*pam_faillock\\.so.*authfail.*\\)\\('\"unlock_time\"'=\\)[0-9]\\+\\(.*\\)/\\1\\2'\"$var_accounts_passwords_pam_faillock_unlock_time\"'\\3/' \"$pam_file\"\n        fi\n    done\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nBy limiting the number of failed logon attempts the risk of unauthorized system\naccess via user password guessing, otherwise known as brute-forcing, is reduced.\nLimits are imposed by locking the account."},"shortDescription":{"text":"Set Lockout Time for Failed Password Attempts."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_dcredit","name":"EnsurePAMEnforcesPasswordRequirements-MinimumDigitCharacters","fullDescription":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of digits in a password. When set to a negative number, any password will be required to\ncontain that many digits. When set to a positive number, pam_pwquality will grant +1 additional\nlength credit for each digit. Modify thesetting into require the use of a digit in passwords."},"help":{"text":"rationale:\nUse of a complex password helps to increase the time and resources required\nto compromise the password. Password complexity, or strength, is a measure of\nthe effectiveness of a password in resisting attempts at guessing and brute-force\nattacks.Password complexity is one factor of several that determines how long it takes\nto crack a password. The more complex the password, the greater the number of\npossible combinations that need to be tested before the password is compromised.\nRequiring digits makes password guessing attacks more difficult by ensuring a larger\nsearch space."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Minimum Digit Characters."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_lcredit","name":"EnsurePAMEnforcesPasswordRequirements-MinimumLowercaseCharacters","fullDescription":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of lowercase letters in a password. When set to a negative number, any password will be required to\ncontain that many lowercase characters. When set to a positive number, pam_pwquality will grant +1 additional\nlength credit for each lowercase character. Modify thesetting into require the use of a lowercase character in passwords."},"help":{"text":"rationale:\nUse of a complex password helps to increase the time and resources required\nto compromise the password. Password complexity, or strength, is a measure of\nthe effectiveness of a password in resisting attempts at guessing and brute-force\nattacks.Password complexity is one factor of several that determines how long it takes\nto crack a password. The more complex the password, the greater the number of\npossble combinations that need to be tested before the password is compromised.\nRequiring a minimum number of lowercase characters makes password guessing attacks\nmore difficult by ensuring a larger search space."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Minimum Lowercase Characters."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_minclass","name":"EnsurePAMEnforcesPasswordRequirements-MinimumDifferentCategories","fullDescription":{"text":"The pam_pwquality module'sparameter controls\nrequirements for usage of different character classes, or types, of character\nthat must exist in a password before it is considered valid. For example,\nsetting this value to three (3) requires that any password must have characters\nfrom at least three different categories in order to be approved. The default\nvalue is zero (0), meaning there are no required classes. There are four\ncategories available:Modify thesetting inentry\nto requirediffering categories of characters when changing passwords."},"help":{"text":"rationale:\nUse of a complex password helps to increase the time and resources required to compromise the password.\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts\nat guessing and brute-force attacks.Password complexity is one factor of several that determines how long it takes to crack a password. The\nmore complex the password, the greater the number of possible combinations that need to be tested before\nthe password is compromised.Requiring a minimum number of character categories makes password guessing attacks more difficult\nby ensuring a larger search space."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Minimum Different Categories."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_minlen","name":"EnsurePAMEnforcesPasswordRequirements-MinimumLength","fullDescription":{"text":"The pam_pwquality module'sparameter controls requirements for\nminimum characters required in a password. Addafter pam_pwquality to set minimum password length requirements."},"help":{"text":"rationale:\nThe shorter the password, the lower the number of possible combinations\nthat need to be tested before the password is compromised.Password complexity, or strength, is a measure of the effectiveness of a\npassword in resisting attempts at guessing and brute-force attacks.\nPassword length is one factor of several that helps to determine strength\nand how long it takes to crack a password. Use of more characters in a password\nhelps to exponentially increase the time and/or resources required to\ncompromise the password."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Minimum Length."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_ocredit","name":"EnsurePAMEnforcesPasswordRequirements-MinimumSpecialCharacters","fullDescription":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of special (or \"other\") characters in a password. When set to a negative number,\nany password will be required to contain that many special characters.\nWhen set to a positive number, pam_pwquality will grant +1\nadditional length credit for each special character. Modify thesetting\ninto equalto require use of a special character in passwords."},"help":{"text":"rationale:\nUse of a complex password helps to increase the time and resources required\nto compromise the password. Password complexity, or strength, is a measure of\nthe effectiveness of a password in resisting attempts at guessing and brute-force\nattacks.Password complexity is one factor of several that determines how long it takes\nto crack a password. The more complex the password, the greater the number of\npossible combinations that need to be tested before the password is compromised.\nRequiring a minimum number of special characters makes password guessing attacks\nmore difficult by ensuring a larger search space."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Minimum Special Characters."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_retry","name":"EnsurePAMEnforcesPasswordRequirements-AuthenticationRetryPromptsPermittedPer-Session","fullDescription":{"text":"To configure the number of retry prompts that are permitted per-session:\n\nEdit thestatement into show, or a lower value if site\npolicy is more restrictive. The DoD requirement is a maximum of 3 prompts\nper session."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nvar_password_pam_retry=''\n\n\nif [ -e \"/etc/pam.d/common-password\" ] ; then\n    valueRegex=\"$var_password_pam_retry\" defaultValue=\"$var_password_pam_retry\"\n    # non-empty values need to be preceded by an equals sign\n    [ -n \"${valueRegex}\" ] && valueRegex=\"=${valueRegex}\"\n    # add an equals sign to non-empty values\n    [ -n \"${defaultValue}\" ] && defaultValue=\"=${defaultValue}\"\n\n    # fix 'type' if it's wrong\n    if grep -q -P \"^\\\\s*(?\"'!'\"password\\\\s)[[:alnum:]]+\\\\s+[[:alnum:]]+\\\\s+pam_pwquality.so\" < \"/etc/pam.d/common-password\" ; then\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*)[[:alnum:]]+(\\\\s+[[:alnum:]]+\\\\s+pam_pwquality.so)/\\\\1password\\\\2/\" \"/etc/pam.d/common-password\"\n    fi\n\n    # fix 'control' if it's wrong\n    if grep -q -P \"^\\\\s*password\\\\s+(?\"'!'\"requisite)[[:alnum:]]+\\\\s+pam_pwquality.so\" < \"/etc/pam.d/common-password\" ; then\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*password\\\\s+)[[:alnum:]]+(\\\\s+pam_pwquality.so)/\\\\1requisite\\\\2/\" \"/etc/pam.d/common-password\"\n    fi\n\n    # fix the value for 'option' if one exists but does not match 'valueRegex'\n    if grep -q -P \"^\\\\s*password\\\\s+requisite\\\\s+pam_pwquality.so(\\\\s.+)?\\\\s+retry(?\"'!'\"${valueRegex}(\\\\s|\\$))\" < \"/etc/pam.d/common-password\" ; then\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*password\\\\s+requisite\\\\s+pam_pwquality.so(\\\\s.+)?\\\\s)retry=[^[:space:]]*/\\\\1retry${defaultValue}/\" \"/etc/pam.d/common-password\"\n\n    # add 'option=default' if option is not set\n    elif grep -q -E \"^\\\\s*password\\\\s+requisite\\\\s+pam_pwquality.so\" < \"/etc/pam.d/common-password\" &&\n            grep    -E \"^\\\\s*password\\\\s+requisite\\\\s+pam_pwquality.so\" < \"/etc/pam.d/common-password\" | grep -q -E -v \"\\\\sretry(=|\\\\s|\\$)\" ; then\n\n        sed --follow-symlinks -i -E -e \"s/^(\\\\s*password\\\\s+requisite\\\\s+pam_pwquality.so[^\\\\n]*)/\\\\1 retry${defaultValue}/\" \"/etc/pam.d/common-password\"\n    # add a new entry if none exists\n    elif ! grep -q -P \"^\\\\s*password\\\\s+requisite\\\\s+pam_pwquality.so(\\\\s.+)?\\\\s+retry${valueRegex}(\\\\s|\\$)\" < \"/etc/pam.d/common-password\" ; then\n        echo \"password requisite pam_pwquality.so retry${defaultValue}\" >> \"/etc/pam.d/common-password\"\n    fi\nelse\n    echo \"/etc/pam.d/common-password doesn't exist\" >&2\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nSetting the password retry prompts that are permitted on a per-session basis to a low value\nrequires some software, such as SSH, to re-connect. This can slow down and\ndraw additional attention to some types of password-guessing attacks. Note that this\nis different from account lockout, which is provided by the pam_faillock module."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Authentication Retry Prompts Permitted Per-Session."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_pam_ucredit","name":"EnsurePAMEnforcesPasswordRequirements-MinimumUppercaseCharacters","fullDescription":{"text":"The pam_pwquality module'sparameter controls requirements for\nusage of uppercase letters in a password. When set to a negative number, any password will be required to\ncontain that many uppercase characters. When set to a positive number, pam_pwquality will grant +1 additional\nlength credit for each uppercase character. Modify thesetting into require the use of an uppercase character in passwords."},"help":{"text":"rationale:\nUse of a complex password helps to increase the time and resources required to compromise the password.\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts\nat guessing and brute-force attacks.Password complexity is one factor of several that determines how long it takes to crack a password. The more\ncomplex the password, the greater the number of possible combinations that need to be tested before\nthe password is compromised."},"shortDescription":{"text":"Ensure PAM Enforces Password Requirements - Minimum Uppercase Characters."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_password_hashing_algorithm_logindefs","name":"SetPasswordHashingAlgorithmIn/etc/login.defs","fullDescription":{"text":"In, add or correct the following line to ensure\nthe system will useas the hashing algorithm:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'login' 2>/dev/null | grep -q installed; then\n\nvar_password_hashing_algorithm=''\n\n\nif grep --silent ^ENCRYPT_METHOD /etc/login.defs ; then\n\tsed -i \"s/^ENCRYPT_METHOD .*/ENCRYPT_METHOD $var_password_hashing_algorithm/g\" /etc/login.defs\nelse\n\techo \"\" >> /etc/login.defs\n\techo \"ENCRYPT_METHOD $var_password_hashing_algorithm\" >> /etc/login.defs\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nPasswords need to be protected at all times, and encryption is the standard method for protecting passwords.\nIf passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised. Passwords\nthat are encrypted with a weak algorithm are no more protected than if they are kept in plain text.Using a stronger hashing algorithm makes password cracking attacks more difficult."},"shortDescription":{"text":"Set Password Hashing Algorithm in /etc/login.defs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (c)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_disallow_bypass_password_sudo","name":"DisallowConfigurationToBypassPasswordRequirementsForPrivilegeEscalation","fullDescription":{"text":"Verify the operating system is not configured to bypass password requirements for privilege\nescalation. Check the configuration of the \"/etc/pam.d/sudo\" file with the following command:If any occurrences of \"pam_succeed_if\" is returned from the command, this is a finding."},"help":{"text":"rationale:\nWithout re-authentication, users may access resources or perform tasks for which they do not\nhave authorization. When operating systems provide the capability to escalate a functional\ncapability, it is critical the user re-authenticate."},"shortDescription":{"text":"Disallow Configuration to Bypass Password Requirements for Privilege Escalation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_display_login_attempts","name":"EnsurePAMDisplaysLastLogon/AccessNotification","fullDescription":{"text":"To configure the system to notify users of last logon/access\nusing, add or correct thesettings into read as follows:And make sure that theoption is not set formodule."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nif [ -e \"/etc/pam.d/login\" ] ; then\n    PAM_FILE_PATH=\"/etc/pam.d/login\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"/etc/pam.d/login\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    if ! grep -qP '^\\s*session\\s+'\"required\"'\\s+pam_lastlog.so\\s*.*' \"$PAM_FILE_PATH\"; then\n            # Line matching group + control + module was not found. Check group + module.\n            if [ \"$(grep -cP '^\\s*session\\s+.*\\s+pam_lastlog.so\\s*' \"$PAM_FILE_PATH\")\" -eq 1 ]; then\n                # The control is updated only if one single line matches.\n                sed -i -E --follow-symlinks 's/^(\\s*session\\s+).*(\\bpam_lastlog.so.*)/\\1'\"required\"' \\2/' \"$PAM_FILE_PATH\"\n            else\n                sed -i --follow-symlinks '1i session     '\"required\"'    pam_lastlog.so' \"$PAM_FILE_PATH\"\n            fi\n        fi\n        # Check the option\n        if ! grep -qP '^\\s*session\\s+'\"required\"'\\s+pam_lastlog.so\\s*.*\\sshowfailed\\b' \"$PAM_FILE_PATH\"; then\n            sed -i -E --follow-symlinks '/\\s*session\\s+'\"required\"'\\s+pam_lastlog.so.*/ s/$/ showfailed/' \"$PAM_FILE_PATH\"\n        fi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nelse\n    echo \"/etc/pam.d/login was not found\" >&2\nfi\nif [ -e \"/etc/pam.d/login\" ] ; then\n    PAM_FILE_PATH=\"/etc/pam.d/login\"\n    if [ -f /usr/bin/authselect ]; then\n        \n        if ! authselect check; then\n        echo \"\n        authselect integrity check failed. Remediation aborted!\n        This remediation could not be applied because an authselect profile was not selected or the selected profile is not intact.\n        It is not recommended to manually edit the PAM files when authselect tool is available.\n        In cases where the default authselect profile does not cover a specific demand, a custom authselect profile is recommended.\"\n        exit 1\n        fi\n\n        CURRENT_PROFILE=$(authselect current -r | awk '{ print $1 }')\n        # If not already in use, a custom profile is created preserving the enabled features.\n        if [[ ! $CURRENT_PROFILE == custom/* ]]; then\n            ENABLED_FEATURES=$(authselect current | tail -n+3 | awk '{ print $2 }')\n            authselect create-profile hardening -b $CURRENT_PROFILE\n            CURRENT_PROFILE=\"custom/hardening\"\n            \n            authselect apply-changes -b --backup=before-hardening-custom-profile\n            authselect select $CURRENT_PROFILE\n            for feature in $ENABLED_FEATURES; do\n                authselect enable-feature $feature;\n            done\n            \n            authselect apply-changes -b --backup=after-hardening-custom-profile\n        fi\n        PAM_FILE_NAME=$(basename \"/etc/pam.d/login\")\n        PAM_FILE_PATH=\"/etc/authselect/$CURRENT_PROFILE/$PAM_FILE_NAME\"\n\n        authselect apply-changes -b\n    fi\n    \nif grep -qP '^\\s*session\\s.*\\bpam_lastlog.so\\s.*\\bsilent\\b' \"$PAM_FILE_PATH\"; then\n    sed -i -E --follow-symlinks 's/(.*session.*pam_lastlog.so.*)\\bsilent\\b=?[[:alnum:]]*(.*)/\\1\\2/g' \"$PAM_FILE_PATH\"\nfi\n    if [ -f /usr/bin/authselect ]; then\n        \n        authselect apply-changes -b\n    fi\nelse\n    echo \"/etc/pam.d/login was not found\" >&2\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nUsers need to be aware of activity that occurs regarding\ntheir account. Providing users with information regarding the number\nof unsuccessful attempts that were made to login to their account\nallows the user to determine if any unauthorized activity has occurred\nand gives them an opportunity to notify administrators."},"shortDescription":{"text":"Ensure PAM Displays Last Logon/Access Notification."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-9 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_burstaction","name":"DisableCtrl-Alt-DelBurstAction","fullDescription":{"text":"By default,will reboot the system if thekey sequence is pressed Ctrl-Alt-Delete more than 7 times in 2 seconds.To configure the system to ignore thesetting, add or modify the following to:."},"help":{"text":"rationale:\nA locally logged-in user who presses Ctrl-Alt-Del, when at the console,\ncan reboot the system. If accidentally pressed, as could happen in\nthe case of mixed OS environment, this can create the risk of short-term\nloss of availability of systems due to unintentional reboot."},"shortDescription":{"text":"Disable Ctrl-Alt-Del Burst Action."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_disable_ctrlaltdel_reboot","name":"DisableCtrl-Alt-DelRebootActivation","fullDescription":{"text":"By default,will reboot the system if thekey sequence is pressed.To configure the system to ignore thekey sequence from the\n\ncommand line instead of rebooting the system, do either of the following:orDo not simply delete thefile,\nas this file may be restored during future system updates."},"help":{"text":"rationale:\nA locally logged-in user who presses Ctrl-Alt-Del, when at the console,\ncan reboot the system. If accidentally pressed, as could happen in\nthe case of mixed OS environment, this can create the risk of short-term\nloss of availability of systems due to unintentional reboot."},"shortDescription":{"text":"Disable Ctrl-Alt-Del Reboot Activation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_account_disable_post_pw_expiration","name":"SetAccountExpirationFollowingInactivity","fullDescription":{"text":"To specify the number of days after a password expires (which\nsignifies inactivity) until an account is permanently disabled, add or correct\nthe following line in:If a password is currently on the verge of expiration, thenday(s) remain(s) until the account is automatically\ndisabled. However, if the password will not expire for another 60 days, then 60\ndays plusday(s) could\nelapse until the account would be automatically disabled. See theman page for more information."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'login' 2>/dev/null | grep -q installed; then\n\nvar_account_disable_post_pw_expiration=''\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^INACTIVE\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s=%s\" \"$stripped_key\" \"$var_account_disable_post_pw_expiration\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^INACTIVE\\\\>\" \"/etc/default/useradd\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^INACTIVE\\\\>.*/$escaped_formatted_output/gi\" \"/etc/default/useradd\"\nelse\n    if [[ -s \"/etc/default/useradd\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/default/useradd\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/default/useradd\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/default/useradd\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nInactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system.\nDisabling inactive accounts ensures that accounts which may not have been responsibly removed are not available to attackers who may have compromised their credentials.\nOwners of inactive accounts will not notice if unauthorized access to their user account has been obtained."},"shortDescription":{"text":"Set Account Expiration Following Inactivity."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-2 (3) (d)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-4 e","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-4 e.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_account_unique_name","name":"EnsureAllAccountsOnTheSystemHaveUniqueNames","fullDescription":{"text":"Ensure accounts on the system have unique names.\n\nTo ensure all accounts have unique names, run the following command:If a username is returned, change or delete the username."},"help":{"text":"rationale:\nUnique usernames allow for accountability on the system."},"shortDescription":{"text":"Ensure All Accounts on the System Have Unique Names."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-8","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_account_use_centralized_automated_auth","name":"UseCentralizedAndAutomatedAuthentication","fullDescription":{"text":"Implement an automated system for managing user accounts that minimizes the\nrisk of errors, either intentional or deliberate. This system\nshould integrate with an existing enterprise user management system, such as\none based on Identity Management tools such as Active Directory, Kerberos,\nDirectory Server, etc."},"help":{"text":"check:\nocil:ssg-account_use_centralized_automated_auth_ocil:questionnaire:1\nrationale:\nA comprehensive account management process that includes automation helps to\nensure the accounts designated as requiring attention are consistently and\npromptly addressed. Enterprise environments make user account management\nchallenging and complex. A user management process requiring administrators to\nmanually address account management functions adds risk of potential\noversight."},"shortDescription":{"text":"Use Centralized and Automated Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ensure_shadow_group_empty","name":"EnsureShadowGroupIsEmpty","fullDescription":{"text":"The shadow group allows system programs which require access the ability\nto read the /etc/shadow file. No users should be assigned to the shadow group."},"help":{"text":"fix:\nsed -ri 's/(^shadow:[^:]*:[^:]*:)([^:]+$)/\\1/' /etc/group\nrationale:\nAny users assigned to the shadow group would be granted read access to the\n/etc/shadow file. If attackers can gain read access to the /etc/shadow file,\nthey can easily run a password cracking program against the hashed passwords\nto break them. Other security information that is stored in the /etc/shadow\nfile (such as expiration) could also be useful to subvert additional user\naccounts.\nwarning:\nThis rule remediation will ensure the group membership is empty in /etc/group. To avoid any\ndisruption the remediation won't change the primary group of users in /etc/passwd if any\nuser has the shadow GID as primary group."},"shortDescription":{"text":"Ensure shadow Group is Empty."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_policy_temp_passwords_immediate_change","name":"PolicyRequiresImmediateChangeOfTemporaryPasswords","fullDescription":{"text":"Temporary passwords for Ubuntu 22.04 operating system logons must\nrequire an immediate change to a permanent password.\n\nVerify that a policy exists that ensures when a user is created, it is\ncreating using a method that forces a user to change their password upon\ntheir next login."},"help":{"text":"check:\nocil:ssg-policy_temp_passwords_immediate_change_ocil:questionnaire:1\nrationale:\nWithout providing this capability, an account may be created without a\npassword. Nonrepudiation cannot be guaranteed once an account is created if\na user is not forced to change the temporary password upon initial logon.\n\nTemporary passwords are typically used to allow access when new accounts\nare created or passwords are changed. It is common practice for\nadministrators to create temporary passwords for user accounts that allow\nthe users to log on, yet force them to change the password once they have\nsuccessfully authenticated."},"shortDescription":{"text":"Policy Requires Immediate Change of Temporary Passwords."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-5 (1) (f)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_maximum_age_login_defs","name":"SetPasswordMaximumAge","fullDescription":{"text":"To specify password maximum age for new accounts,\nedit the fileand add or correct the following line:A value of 180 days is sufficient for many environments.\nThe DoD requirement is 60.\nThe profile requirement is."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'login' 2>/dev/null | grep -q installed; then\n\nvar_accounts_maximum_age_login_defs=''\n\n\ngrep -q ^PASS_MAX_DAYS /etc/login.defs && \\\n  sed -i \"s/PASS_MAX_DAYS.*/PASS_MAX_DAYS     $var_accounts_maximum_age_login_defs/g\" /etc/login.defs\nif ! [ $? -eq 0 ]; then\n    echo \"PASS_MAX_DAYS      $var_accounts_maximum_age_login_defs\" >> /etc/login.defs\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAny password, no matter how complex, can eventually be cracked. Therefore, passwords\nneed to be changed periodically. If the operating system does not limit the lifetime\nof passwords and force users to change their passwords, there is the risk that the\noperating system passwords could be compromised.Setting the password maximum age ensures users are required to\nperiodically change their passwords. Requiring shorter password lifetimes\nincreases the risk of users writing down the password in a convenient\nlocation subject to physical compromise."},"shortDescription":{"text":"Set Password Maximum Age."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (d)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_minimum_age_login_defs","name":"SetPasswordMinimumAge","fullDescription":{"text":"To specify password minimum age for new accounts,\nedit the fileand add or correct the following line:A value of 1 day is considered sufficient for many\nenvironments. The DoD requirement is 1.\nThe profile requirement is."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'login' 2>/dev/null | grep -q installed; then\n\nvar_accounts_minimum_age_login_defs=''\n\n\ngrep -q ^PASS_MIN_DAYS /etc/login.defs && \\\n  sed -i \"s/PASS_MIN_DAYS.*/PASS_MIN_DAYS     $var_accounts_minimum_age_login_defs/g\" /etc/login.defs\nif ! [ $? -eq 0 ]; then\n    echo \"PASS_MIN_DAYS      $var_accounts_minimum_age_login_defs\" >> /etc/login.defs\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nEnforcing a minimum password lifetime helps to prevent repeated password\nchanges to defeat the password reuse or history enforcement requirement. If\nusers are allowed to immediately and continually change their password,\nthen the password could be repeatedly changed in a short period of time to\ndefeat the organization's policy regarding password reuse.Setting the minimum password age protects against users cycling back to a\nfavorite password after satisfying the password reuse requirement."},"shortDescription":{"text":"Set Password Minimum Age."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (d)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_minlen_login_defs","name":"SetPasswordMinimumLengthInLogin.defs","fullDescription":{"text":"To specify password length requirements for new accounts, edit the fileand add or correct the following line:The DoD requirement is.\nThe FISMA requirement is.\nThe profile requirement is.\nIf a program consultsand also another PAM module\n(such as) during a password change operation, then\nthe most restrictive must be satisfied. See PAM section for more\ninformation about enforcing password quality requirements."},"help":{"text":"rationale:\nRequiring a minimum password length makes password\ncracking attacks more difficult by ensuring a larger\nsearch space. However, any security benefit from an onerous requirement\nmust be carefully weighed against usability problems, support costs, or counterproductive\nbehavior that may result."},"shortDescription":{"text":"Set Password Minimum Length in login.defs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_set_max_life_existing","name":"SetExistingPasswordsMaximumAge","fullDescription":{"text":"Configure non-compliant accounts to enforce a-day maximum password lifetime\nrestriction by running the following command:."},"help":{"text":"fix:\nvar_accounts_maximum_age_login_defs=''\n\n\nwhile IFS= read -r i; do\n    \n    chage -M $var_accounts_maximum_age_login_defs $i\n\ndone <   <(awk -v var=\"$var_accounts_maximum_age_login_defs\" -F: '(/^[^:]+:[^!*]/ && ($5 > var || $5 == \"\")) {print $1}' /etc/shadow)\nrationale:\nAny password, no matter how complex, can eventually be cracked. Therefore,\npasswords need to be changed periodically. If the operating system does\nnot limit the lifetime of passwords and force users to change their\npasswords, there is the risk that the operating system passwords could be\ncompromised."},"shortDescription":{"text":"Set Existing Passwords Maximum Age."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (d)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_set_min_life_existing","name":"SetExistingPasswordsMinimumAge","fullDescription":{"text":"Configure non-compliant accounts to enforce a 24 hours/1 day minimum password\nlifetime by running the following command:."},"help":{"text":"rationale:\nEnforcing a minimum password lifetime helps to prevent repeated password\nchanges to defeat the password reuse or history enforcement requirement. If\nusers are allowed to immediately and continually change their password, the\npassword could be repeatedly changed in a short period of time to defeat the\norganization's policy regarding password reuse."},"shortDescription":{"text":"Set Existing Passwords Minimum Age."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (d)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_warn_age_login_defs","name":"SetPasswordWarningAge","fullDescription":{"text":"To specify how many days prior to password\nexpiration that a warning will be issued to users,\nedit the fileand add or correct\n the following line:The DoD requirement is 7.\nThe profile requirement is."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'login' 2>/dev/null | grep -q installed; then\n\nvar_accounts_password_warn_age_login_defs=''\n\n\ngrep -q ^PASS_WARN_AGE /etc/login.defs && \\\nsed -i \"s/PASS_WARN_AGE.*/PASS_WARN_AGE\\t$var_accounts_password_warn_age_login_defs/g\" /etc/login.defs\nif ! [ $? -eq 0 ]\nthen\n  echo -e \"PASS_WARN_AGE\\t$var_accounts_password_warn_age_login_defs\" >> /etc/login.defs\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nSetting the password warning age enables users to\nmake the change at a practical time."},"shortDescription":{"text":"Set Password Warning Age."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 f.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_all_shadowed","name":"VerifyAllAccountPasswordHashesAreShadowed","fullDescription":{"text":"If any password hashes are stored in(in the second field,\ninstead of anor), the cause of this misconfiguration should be\ninvestigated. The account should have its password reset and the hash should be\nproperly stored, or the account should be deleted entirely."},"help":{"text":"rationale:\nThe hashes for all user account passwords should be stored in\nthe fileand never in,\nwhich is readable by all users."},"shortDescription":{"text":"Verify All Account Password Hashes are Shadowed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 h.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_password_last_change_is_in_past","name":"EnsureAllUsersLastPasswordChangeDateIsInThePast","fullDescription":{"text":"All users should have a password change date in the past."},"help":{"text":"rationale:\nIf a user recorded password change date is in the future then they could\nbypass any set password expiration.\nwarning:\nAutomatic remediation is not available, in order to avoid any system disruption."},"shortDescription":{"text":"Ensure all users last password change date is in the past."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_gid_passwd_group_same","name":"AllGIDsReferencedIn/etc/passwdMustBeDefinedIn/etc/group","fullDescription":{"text":"Add a group to the system for each GID referenced without a corresponding group."},"help":{"text":"rationale:\nIf a user is assigned the Group Identifier (GID) of a group not existing on the system, and a group\nwith the Group Identifier (GID) is subsequently created, the user may have unintended rights to\nany files associated with the group."},"shortDescription":{"text":"All GIDs referenced in /etc/passwd must be defined in /etc/group."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_empty_passwords","name":"PreventLoginToAccountsWithEmptyPassword","fullDescription":{"text":"If an account is configured for password authentication\nbut does not have an assigned password, it may be possible to log\ninto the account without authentication. Remove any instances of theinandto prevent logins with empty passwords."},"help":{"text":"rationale:\nIf an account has an empty password, anyone could log in and\nrun commands with the privileges of that account. Accounts with\nempty passwords should never be used in operational environments.\nwarning:\nIf the system relies ontool to manage PAM settings, the remediation\nwill also usetool. However, if any manual modification was made in\nPAM files, theintegrity check will fail and the remediation will be\naborted in order to preserve intentional changes. In this case, an informative message will\nbe shown in the remediation report.\nNote that this rule is not applicable for systems running within a\ncontainer. Having user with empty password within a container is not\nconsidered a risk, because it should not be possible to directly login into\na container anyway."},"shortDescription":{"text":"Prevent Login to Accounts With Empty Password."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_empty_passwords_etc_shadow","name":"EnsureThereAreNoAccountsWithBlankOrNullPasswords","fullDescription":{"text":"Check the \"/etc/shadow\" file for blank passwords with the\nfollowing command:If the command returns any results, this is a finding.\nConfigure all accounts on the system to have a password or lock\nthe account with the following commands:\nPerform a password reset:Lock an account:."},"help":{"text":"rationale:\nIf an account has an empty password, anyone could log in and\nrun commands with the privileges of that account. Accounts with\nempty passwords should never be used in operational environments.\nwarning:\nNote that this rule is not applicable for systems running within a container. Having user with empty password within a container is not considered a risk, because it should not be possible to directly login into a container anyway."},"shortDescription":{"text":"Ensure There Are No Accounts With Blank or Null Passwords."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_netrc_files","name":"VerifyNoNetrcFilesExist","fullDescription":{"text":"Thefiles contain login information\nused to auto-login into FTP servers and reside in the user's home\ndirectory. These files may contain unencrypted passwords to\nremote FTP servers making them susceptible to access by unauthorized\nusers and should not be used.  Anyfiles should be removed."},"help":{"text":"rationale:\nUnencrypted passwords for remote FTP servers may be stored infiles."},"shortDescription":{"text":"Verify No netrc Files Exist."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (c)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (7)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 h.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_no_uid_except_zero","name":"VerifyOnlyRootHasUID0","fullDescription":{"text":"If any account other than root has a UID of 0, this misconfiguration should\nbe investigated and the accounts other than root should be removed or have\ntheir UID changed.If the account is associated with system commands or applications the UID\nshould be changed to one greater than \"0\" but less than \"1000.\"\nOtherwise assign a UID greater than \"1000\" that has not already been\nassigned."},"help":{"text":"rationale:\nAn account has root authority if it has a UID of 0. Multiple accounts\nwith a UID of 0 afford more opportunity for potential intruders to\nguess a password for a privileged account. Proper configuration of\nsudo is recommended to afford multiple system administrators\naccess to root privileges in an accountable manner."},"shortDescription":{"text":"Verify Only Root Has UID 0."},"defaultConfiguration":{"level":"error"},"properties":{"security-severity":"7","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-4 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_root_gid_zero","name":"VerifyRootHasAPrimaryGID0","fullDescription":{"text":"Theuser should have a primary group of 0."},"help":{"text":"rationale:\nTo help ensure that root-owned files are not inadvertently exposed to other users."},"shortDescription":{"text":"Verify Root Has A Primary GID 0."},"defaultConfiguration":{"level":"error"},"properties":{"security-severity":"7","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ensure_pam_wheel_group_empty","name":"EnsureTheGroupUsedByPam_wheelModuleExistsOnSystemAndIsEmpty","fullDescription":{"text":"Ensure that the groupreferenced by the pam_wheelparameter exists and has no\nmembers. This ensures that no user can run commands with altered\nprivileges through thecommand."},"help":{"text":"rationale:\nTheprogram allows to run commands with a substitute user and\ngroup ID. It is commonly used to run commands as the root user. Limiting\naccess to such command is considered a good security practice."},"shortDescription":{"text":"Ensure the Group Used by pam_wheel Module Exists on System and is Empty."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ensure_root_password_configured","name":"EnsureAuthenticationRequiredForSingleUserMode","fullDescription":{"text":"Single user mode is used for recovery when the system detects an\nissue during boot or by manual selection from the bootloader."},"help":{"text":"rationale:\nRequiring authentication in single user mode prevents an unauthorized\nuser from rebooting the system into single user to gain root privileges\nwithout credentials."},"shortDescription":{"text":"Ensure Authentication Required for Single User Mode."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_direct_root_logins","name":"DirectRootLoginsNotAllowed","fullDescription":{"text":"To further limit access to theaccount, administrators\ncan disable root logins at the console by editing thefile.\nThis file lists all devices the root user is allowed to login to. If the file does\nnot exist at all, the root user can login through any communication device on the\nsystem, whether via the console or via a raw network interface. This is dangerous\nas user can login to the system as root via Telnet, which sends the password in\nplain text over the network. By default, Ubuntu 22.04'sfile only allows the root user to login at the console\nphysically attached to the system. To prevent root from logging in, remove the\ncontents of this file. To prevent direct root logins, remove the contents of this\nfile by typing the following command:."},"help":{"text":"rationale:\nDisabling direct root logins ensures proper accountability and multifactor\nauthentication to privileged accounts. Users will first login, then escalate\nto privileged (root) access via su / sudo. This is required for FISMA Low\nand FISMA Moderate systems.\nwarning:\nThis rule only checks thefile existence and its content.\nIf you need to restrict user access using thefile, make sure\nthePAM module is properly enabled in relevant PAM files."},"shortDescription":{"text":"Direct root Logins Not Allowed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_password_auth_for_systemaccounts","name":"EnsureThatSystemAccountsAreLocked","fullDescription":{"text":"Some accounts are not associated with a human user of the system, and exist to perform some\nadministrative functions. An attacker should not be able to log into these accounts.System accounts are those user accounts with a user ID less than.\nIf any system account other than,,,andhas an unlocked password, disable it with the command:."},"help":{"text":"rationale:\nDisabling authentication for default system accounts makes it more difficult for attackers\nto make use of them to compromise a system."},"shortDescription":{"text":"Ensure that System Accounts Are Locked."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_shelllogin_for_systemaccounts","name":"EnsureThatSystemAccountsDoNotRunAShellUponLogin","fullDescription":{"text":"Some accounts are not associated with a human user of the system, and exist to perform some\nadministrative functions. Should an attacker be able to log into these accounts, they should\nnot be granted access to a shell.The login shell for each local account is stored in the last field of each line in. System accounts are those user accounts with a user ID less than. The user ID is stored in the third field. If any system account\nother thanhas a login shell, disable it with the command:."},"help":{"text":"rationale:\nEnsuring shells are not given to system accounts upon login makes it more difficult for\nattackers to make use of system accounts.\nwarning:\nDo not perform the steps in this section on the root account. Doing so might cause the\nsystem to become inaccessible."},"shortDescription":{"text":"Ensure that System Accounts Do Not Run a Shell Upon Login."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_prevent_direct_root_logins","name":"DirectRootLoginsAreNotAllowed","fullDescription":{"text":"Configure the operating system to prevent direct logins to theaccount by performing the following operations:."},"help":{"text":"check:\nocil:ssg-prevent_direct_root_logins_ocil:questionnaire:1\nrationale:\nDisabling direct root logins ensures proper accountability and\nmultifactor authentication to privileged accounts."},"shortDescription":{"text":"Direct root Logins Are Not Allowed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_restrict_serial_port_logins","name":"RestrictSerialPortRootLogins","fullDescription":{"text":"To restrict root logins on serial ports,\nensure lines of this form do not appear in:."},"help":{"text":"fix:\nsed -i '/ttyS/d' /etc/securetty\nrationale:\nPreventing direct root login to serial port interfaces\nhelps ensure accountability for actions taken on the systems\nusing the root account."},"shortDescription":{"text":"Restrict Serial Port Root Logins."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_securetty_root_login_console_only","name":"RestrictVirtualConsoleRootLogins","fullDescription":{"text":"To restrict root logins through the (deprecated) virtual console devices,\nensure lines of this form do not appear in:."},"help":{"text":"fix:\nsed -i '/^vc\\//d' /etc/securetty\nrationale:\nPreventing direct root login to virtual console devices\nhelps ensure accountability for actions taken on the system\nusing the root account."},"shortDescription":{"text":"Restrict Virtual Console Root Logins."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_use_pam_wheel_group_for_su","name":"EnforceUsageOfPam_wheelWithGroupParameterForSuAuthentication","fullDescription":{"text":"To ensure that only users who are members of the group set in thepam_wheel parameter can run commands with altered\nprivileges through thecommand, make sure that the\nfollowing line exists in the file:."},"help":{"text":"rationale:\nTheprogram allows to run commands with a substitute\nuser and group ID. It is commonly used to run commands as the root\nuser. Limiting access to such command is considered a good security\npractice."},"shortDescription":{"text":"Enforce Usage of pam_wheel with Group Parameter for su Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_account_unique_id","name":"EnsureAllAccountsOnTheSystemHaveUniqueUserIDs","fullDescription":{"text":"Change user IDs (UIDs), or delete accounts, so each has a unique name."},"help":{"text":"rationale:\nTo assure accountability and prevent unauthenticated access, interactive users must be identified and authenticated to prevent potential misuse and compromise of the system.\nwarning:\nAutomatic remediation of this control is not available due to unique requirements of each\nsystem."},"shortDescription":{"text":"Ensure All Accounts on the System Have Unique User IDs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-8","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_group_unique_id","name":"EnsureAllGroupsOnTheSystemHaveUniqueGroupID","fullDescription":{"text":"Change the group name or delete groups, so each has a unique id."},"help":{"text":"rationale:\nTo assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.\nwarning:\nAutomatic remediation of this control is not available due to the unique requirements of each system."},"shortDescription":{"text":"Ensure All Groups on the System Have Unique Group ID."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_group_unique_name","name":"EnsureAllGroupsOnTheSystemHaveUniqueGroupNames","fullDescription":{"text":"Change the group name or delete groups, so each has a unique name."},"help":{"text":"rationale:\nTo assure accountability and prevent unauthenticated access, groups must be identified uniquely to prevent potential misuse and compromise of the system.\nwarning:\nAutomatic remediation of this control is not available due to the unique requirements of each system."},"shortDescription":{"text":"Ensure All Groups on the System Have Unique Group Names."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_root_path_dirs_no_write","name":"EnsureThatRoot'sPathDoesNotIncludeWorldOrGroup-WritableDirectories","fullDescription":{"text":"For each element in root's path, run:and ensure that write permissions are disabled for group and\nother."},"help":{"text":"rationale:\nSuch entries increase the risk that root could\nexecute code provided by unprivileged users,\nand potentially malicious code."},"shortDescription":{"text":"Ensure that Root's Path Does Not Include World or Group-Writable Directories."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_root_path_no_dot","name":"EnsureThatRoot'sPathDoesNotIncludeRelativePathsOrNullDirectories","fullDescription":{"text":"Ensure that none of the directories in root's path is equal to a singlecharacter, or\nthat it contains any instances that lead to relative path traversal, such asor beginning a path without the slash () character.\nAlso ensure that there are no \"empty\" elements in the path, such as in these examples:These empty elements have the same effect as a singlecharacter."},"help":{"text":"check:\noval:ssg-root_path_no_dot:def:1\nrationale:\nIncluding these entries increases the risk that root could\nexecute code from an untrusted location."},"shortDescription":{"text":"Ensure that Root's Path Does Not Include Relative Paths or Null Directories."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_umask_etc_bashrc","name":"EnsureTheDefaultBashUmaskIsSetCorrectly","fullDescription":{"text":"To ensure the default umask for users of the Bash shell is set properly,\nadd or correct thesetting into read\nas follows:."},"help":{"text":"rationale:\nThe umask value influences the permissions assigned to files when they are created.\nA misconfigured umask value could result in files with excessive permissions that can be read or\nwritten to by unauthorized users."},"shortDescription":{"text":"Ensure the Default Bash Umask is Set Correctly."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_umask_etc_login_defs","name":"EnsureTheDefaultUmaskIsSetCorrectlyInLogin.defs","fullDescription":{"text":"To ensure the default umask controlled byis set properly,\nadd or correct thesetting into read as follows:."},"help":{"text":"rationale:\nThe umask value influences the permissions assigned to files when they are created.\nA misconfigured umask value could result in files with excessive permissions that can be read and\nwritten to by unauthorized users."},"shortDescription":{"text":"Ensure the Default Umask is Set Correctly in login.defs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_umask_etc_profile","name":"EnsureTheDefaultUmaskIsSetCorrectlyIn/etc/profile","fullDescription":{"text":"To ensure the default umask controlled byis set properly,\nadd or correct thesetting into read as follows:Note thatalso reads scrips withindirectory.\nThese scripts are also valid files to set umask value. Therefore, they should also be\nconsidered during the check and properly remediated, if necessary."},"help":{"text":"rationale:\nThe umask value influences the permissions assigned to files when they are created.\nA misconfigured umask value could result in files with excessive permissions that can be read or\nwritten to by unauthorized users."},"shortDescription":{"text":"Ensure the Default Umask is Set Correctly in /etc/profile."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_umask_interactive_users","name":"EnsureTheDefaultUmaskIsSetCorrectlyForInteractiveUsers","fullDescription":{"text":"Remove theenvironment variable from all interactive users initialization files."},"help":{"text":"rationale:\nThe umask controls the default access mode assigned to newly created files. A\numask of 077 limits new files to mode 700 or less permissive. Although umask can\nbe represented as a four-digit number, the first digit representing special\naccess modes is typically ignored or required to be 0. This requirement\napplies to the globally configured system defaults and the local interactive\nuser defaults for each account on the system."},"shortDescription":{"text":"Ensure the Default Umask is Set Correctly For Interactive Users."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_logon_fail_delay","name":"EnsureTheLogonFailureDelayIsSetCorrectlyInLogin.defs","fullDescription":{"text":"To ensure the logon failure delay controlled byis set properly,\nadd or correct thesetting into read as follows:."},"help":{"text":"rationale:\nIncreasing the time between a failed authentication attempt and re-prompting to\nenter credentials helps to slow a single-threaded brute force attack."},"shortDescription":{"text":"Ensure the Logon Failure Delay is Set Correctly in login.defs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_max_concurrent_login_sessions","name":"LimitTheNumberOfConcurrentLoginSessionsAllowedPerUser","fullDescription":{"text":"Limiting the number of allowed users and sessions per user can limit risks related to Denial of\nService attacks. This addresses concurrent sessions for a single account and does not address\nconcurrent sessions by a single user via multiple accounts. To set the number of concurrent\nsessions per user add the following line inor\na file under:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'libpam-runtime' 2>/dev/null | grep -q installed; then\n\nvar_accounts_max_concurrent_login_sessions=''\n\n\nif grep -q '^[^#]*\\' /etc/security/limits.d/*.conf; then\n\tsed -i \"/^[^#]*\\/ s/maxlogins.*/maxlogins $var_accounts_max_concurrent_login_sessions/\" /etc/security/limits.d/*.conf\nelif grep -q '^[^#]*\\' /etc/security/limits.conf; then\n\tsed -i \"/^[^#]*\\/ s/maxlogins.*/maxlogins $var_accounts_max_concurrent_login_sessions/\" /etc/security/limits.conf\nelse\n\techo \"*\thard\tmaxlogins\t$var_accounts_max_concurrent_login_sessions\" >> /etc/security/limits.conf\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nLimiting simultaneous user logins can insulate the system from denial of service\nproblems caused by excessive logins. Automated login processes operating improperly or\nmaliciously may result in an exceptional number of simultaneous login sessions."},"shortDescription":{"text":"Limit the Number of Concurrent Login Sessions Allowed Per User."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_polyinstantiated_tmp","name":"ConfigurePolyinstantiationOf/tmpDirectories","fullDescription":{"text":"To configure polyinstantiated /tmp directories, first create the parent directories\nwhich will hold the polyinstantiation child directories. Use the following command:Then, add the following entry to:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif ! ( [ \"${container:-}\" == \"bwrap-osbuild\" ] ); then\n\n#!/bin/bash\n\n# shellcheck disable=SC2174\nmkdir -p --mode 000 /tmp/tmp-inst\nchmod 000 /tmp/tmp-inst\nchcon --reference=/tmp /tmp/tmp-inst\n\nif ! grep -Eq '^\\s*/tmp\\s+/tmp/tmp-inst/\\s+level\\s+root,adm$' /etc/security/namespace.conf ; then\n    if grep -Eq '^\\s*/tmp\\s+' /etc/security/namespace.conf ; then\n        sed -i '/^\\s*\\/tmp/d' /etc/security/namespace.conf\n    fi\n    echo \"/tmp     /tmp/tmp-inst/        level      root,adm\" >> /etc/security/namespace.conf\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nPolyinstantiation of temporary directories is a proactive security measure\nwhich reduces chances of attacks that are made possible by /tmp\ndirectories being world-writable."},"shortDescription":{"text":"Configure Polyinstantiation of /tmp Directories."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_polyinstantiated_var_tmp","name":"ConfigurePolyinstantiationOf/var/tmpDirectories","fullDescription":{"text":"To configure polyinstantiated /tmp directories, first create the parent directories\nwhich will hold the polyinstantiation child directories. Use the following command:Then, add the following entry to:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif ! ( [ \"${container:-}\" == \"bwrap-osbuild\" ] ); then\n\n#!/bin/bash\n\n# shellcheck disable=SC2174\nmkdir -p --mode 000 /var/tmp/tmp-inst\nchmod 000 /var/tmp/tmp-inst\nchcon --reference=/var/tmp /var/tmp/tmp-inst\n\nif ! grep -Eq '^\\s*/var/tmp\\s+/var/tmp/tmp-inst/\\s+level\\s+root,adm$' /etc/security/namespace.conf ; then\n    if grep -Eq '^\\s*/var/tmp\\s+' /etc/security/namespace.conf ; then\n        sed -i '/^\\s*\\/var\\/tmp/d' /etc/security/namespace.conf\n    fi\n    echo \"/var/tmp /var/tmp/tmp-inst/    level      root,adm\" >> /etc/security/namespace.conf\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nPolyinstantiation of temporary directories is a proactive security measure\nwhich reduces chances of attacks that are made possible by /var/tmp\ndirectories being world-writable."},"shortDescription":{"text":"Configure Polyinstantiation of /var/tmp Directories."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_tmout","name":"SetInteractiveSessionTimeout","fullDescription":{"text":"Setting theoption inensures that\nall user sessions will terminate based on inactivity.\nThe value of TMOUT should be exported and read only.\nThesetting in a file loaded by, e.g.should read as follows:readonly TMOUT\nexport TMOUT."},"help":{"text":"rationale:\nTerminating an idle session within a short time period reduces\nthe window of opportunity for unauthorized personnel to take control of a\nmanagement session enabled on the console or console port that has been\nleft unattended."},"shortDescription":{"text":"Set Interactive Session Timeout."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-12","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_user_dot_group_ownership","name":"UserInitializationFilesMustBeGroup-OwnedByThePrimaryGroup","fullDescription":{"text":"Change the group owner of interactive users files to the group found\ninfor the user. To change the group owner of a local\ninteractive user home directory, use the following command:This rule ensures every initialization file related to an interactive user\nis group-owned by an interactive user."},"help":{"text":"rationale:\nLocal initialization files for interactive users are used to configure the\nuser's shell environment upon logon. Malicious modification of these files could\ncompromise accounts upon logon.\nwarning:\nDue to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the group-ownership\nof their respective initialization files."},"shortDescription":{"text":"User Initialization Files Must Be Group-Owned By The Primary Group."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_user_dot_no_world_writable_programs","name":"UserInitializationFilesMustNotRunWorld-WritablePrograms","fullDescription":{"text":"Set the mode on files being executed by the user initialization files with the\nfollowing command:."},"help":{"text":"fix:\nreadarray -t world_writable_files < <(find / -xdev -type f -perm -0002 2> /dev/null)\nreadarray -t interactive_home_dirs < <(awk -F':' '{ if ($3 >= 1000 && $3 != 65534) print $6 }' /etc/passwd)\n\nfor world_writable in \"${world_writable_files[@]}\"; do\n    for homedir in \"${interactive_home_dirs[@]}\"; do\n        if grep -q -d skip \"$world_writable\" \"$homedir\"/.*; then\n            chmod o-w $world_writable\n            break\n        fi\n    done\ndone\nrationale:\nIf user start-up files execute world-writable programs, especially in\nunprotected directories, they could be maliciously modified to destroy user\nfiles or otherwise compromise the system at the user level. If the system is\ncompromised at the user level, it is easier to elevate privileges to eventually\ncompromise the system at the root and network level."},"shortDescription":{"text":"User Initialization Files Must Not Run World-Writable Programs."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_user_dot_user_ownership","name":"UserInitializationFilesMustBeOwnedByThePrimaryUser","fullDescription":{"text":"Set the owner of the user initialization files for interactive users to\nthe primary owner with the following command:This rule ensures every initialization file related to an interactive user\nis owned by an interactive user."},"help":{"text":"rationale:\nLocal initialization files are used to configure the user's shell environment\nupon logon. Malicious modification of these files could compromise accounts upon\nlogon.\nwarning:\nDue to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the ownership of\ntheir respective initialization files."},"shortDescription":{"text":"User Initialization Files Must Be Owned By the Primary User."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_accounts_user_interactive_home_directory_exists","name":"AllInteractiveUsersHomeDirectoriesMustExist","fullDescription":{"text":"Create home directories to all local interactive users that currently do not\nhave a home directory assigned. Use the following commands to create the user\nhome directory assigned in:."},"help":{"text":"rationale:\nIf a local interactive user has a home directory defined that does not exist,\nthe user may be given access to the / directory as the current working directory\nupon logon. This could create a Denial of Service because the user would not be\nable to access their logon configuration files, and it may give them visibility\nto system files they normally would not be able to access."},"shortDescription":{"text":"All Interactive Users Home Directories Must Exist."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupownership_home_directories","name":"AllInteractiveUserHomeDirectoriesMustBeGroup-OwnedByThePrimaryGroup","fullDescription":{"text":"Change the group owner of interactive users home directory to the\ngroup found in. To change the group owner of\ninteractive users home directory, use the following command:This rule ensures every home directory related to an interactive user is\ngroup-owned by an interactive user. It also ensures that interactive users\nare group-owners of one and only one home directory."},"help":{"text":"rationale:\nIf the Group Identifier (GID) of a local interactive users home directory is\nnot the same as the primary GID of the user, this would allow unauthorized\naccess to the users files, and users that share the same group may not be\nable to access files that they legitimately should.\nwarning:\nDue to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the group-ownership\nof their respective home directories."},"shortDescription":{"text":"All Interactive User Home Directories Must Be Group-Owned By The Primary Group."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_home_directories","name":"AllInteractiveUserHomeDirectoriesMustBeOwnedByThePrimaryUser","fullDescription":{"text":"Change the owner of interactive users home directories to that correct\nowner. To change the owner of a interactive users home directory, use\nthe following command:This rule ensures every home directory related to an interactive user is\nowned by an interactive user. It also ensures that interactive users are\nowners of one and only one home directory."},"help":{"text":"rationale:\nIf a local interactive user does not own their home directory, unauthorized\nusers could access or modify the user's files, and the users may not be able to\naccess their own files.\nwarning:\nDue to OVAL limitation, this rule can report a false negative in a\nspecific situation where two interactive users swap the ownership of\ntheir respective home directories."},"shortDescription":{"text":"All Interactive User Home Directories Must Be Owned By The Primary User."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_home_directories","name":"AllInteractiveUserHomeDirectoriesMustHaveMode0750OrLessPermissive","fullDescription":{"text":"Change the mode of interactive users home directories to. To\nchange the mode of interactive users home directory, use the\nfollowing command:."},"help":{"text":"rationale:\nExcessive permissions on local interactive user home directories may allow\nunauthorized access to user files by other users."},"shortDescription":{"text":"All Interactive User Home Directories Must Have mode 0750 Or Less Permissive."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_home_dirs","name":"EnsureThatUserHomeDirectoriesAreNotGroup-WritableOrWorld-Readable","fullDescription":{"text":"For each human user of the system, view the\npermissions of the user's home directory:Ensure that the directory is not group-writable and that it\nis not world-readable. If necessary, repair the permissions:."},"help":{"text":"rationale:\nUser home directories contain many configuration files which\naffect the behavior of a user's account. No user should ever have\nwrite permission to another user's home directory. Group shared\ndirectories can be configured in sub-directories or elsewhere in the\nfilesystem if they are needed. Typically, user home directories\nshould not be world-readable, as it would disclose file names\nto other users. If a subset of users need read access\nto one another's home directories, this can be provided using\ngroups or ACLs."},"shortDescription":{"text":"Ensure that User Home Directories are not Group-Writable or World-Readable."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chmod","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Chmod","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect.  Here the system calls\nhave been placed independent of other system calls.  Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - chmod."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_chown","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Chown","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect.  Here the system calls\nhave been placed independent of other system calls.  Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - chown."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmod","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Fchmod","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - fchmod."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchmodat","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Fchmodat","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - fchmodat."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchown","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Fchown","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - fchown."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fchownat","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Fchownat","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - fchownat."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fremovexattr","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Fremovexattr","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root.If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - fremovexattr."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_fsetxattr","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Fsetxattr","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - fsetxattr."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lchown","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Lchown","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - lchown."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lremovexattr","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Lremovexattr","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root.If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - lremovexattr."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_lsetxattr","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Lsetxattr","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - lsetxattr."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_removexattr","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Removexattr","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root.If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default), add the\nfollowing line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - removexattr."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_setxattr","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Setxattr","fullDescription":{"text":"At a minimum, the audit system should collect file permission\nchanges for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - setxattr."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_umount","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Umount","fullDescription":{"text":"At a minimum, the audit system should collect file system umount\nchanges. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - umount."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_dac_modification_umount2","name":"RecordEventsThatModifyTheSystem'sDiscretionaryAccessControls-Umount2","fullDescription":{"text":"At a minimum, the audit system should collect file system umount2\nchanges. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following line to a file with suffixin the directory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:."},"help":{"text":"rationale:\nThe changing of file permissions could indicate that a user is attempting to\ngain access to information that would otherwise be disallowed. Auditing DAC modifications\ncan facilitate the identification of patterns of abuse among both authorized and\nunauthorized users.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Events that Modify the System's Discretionary Access Controls - umount2."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_execution_chacl","name":"RecordAnyAttemptsToRunChacl","fullDescription":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"help":{"text":"rationale:\nWithout generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one.\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Record Any Attempts to Run chacl."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_execution_setfacl","name":"RecordAnyAttemptsToRunSetfacl","fullDescription":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"help":{"text":"rationale:\nWithout generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one.\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Record Any Attempts to Run setfacl."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_execution_chcon","name":"RecordAnyAttemptsToRunChcon","fullDescription":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Record Any Attempts to Run chcon."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rename","name":"EnsureAuditdCollectsFileDeletionEventsByUser-Rename","fullDescription":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"rationale:\nAuditing file deletions will create an audit trail for files that are removed\nfrom the system. The audit trail could aid in system troubleshooting, as well as, detecting\nmalicious processes that attempt to delete log files to conceal their presence."},"shortDescription":{"text":"Ensure auditd Collects File Deletion Events by User - rename."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_renameat","name":"EnsureAuditdCollectsFileDeletionEventsByUser-Renameat","fullDescription":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"rationale:\nAuditing file deletions will create an audit trail for files that are removed\nfrom the system. The audit trail could aid in system troubleshooting, as well as, detecting\nmalicious processes that attempt to delete log files to conceal their presence."},"shortDescription":{"text":"Ensure auditd Collects File Deletion Events by User - renameat."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_rmdir","name":"EnsureAuditdCollectsFileDeletionEventsByUser-Rmdir","fullDescription":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"rationale:\nAuditing file deletions will create an audit trail for files that are removed\nfrom the system. The audit trail could aid in system troubleshooting, as well as, detecting\nmalicious processes that attempt to delete log files to conceal their presence."},"shortDescription":{"text":"Ensure auditd Collects File Deletion Events by User - rmdir."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlink","name":"EnsureAuditdCollectsFileDeletionEventsByUser-Unlink","fullDescription":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"rationale:\nAuditing file deletions will create an audit trail for files that are removed\nfrom the system. The audit trail could aid in system troubleshooting, as well as, detecting\nmalicious processes that attempt to delete log files to conceal their presence."},"shortDescription":{"text":"Ensure auditd Collects File Deletion Events by User - unlink."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_file_deletion_events_unlinkat","name":"EnsureAuditdCollectsFileDeletionEventsByUser-Unlinkat","fullDescription":{"text":"At a minimum, the audit system should collect file deletion events\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"rationale:\nAuditing file deletions will create an audit trail for files that are removed\nfrom the system. The audit trail could aid in system troubleshooting, as well as, detecting\nmalicious processes that attempt to delete log files to conceal their presence."},"shortDescription":{"text":"Ensure auditd Collects File Deletion Events by User - unlinkat."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_creat","name":"RecordUnsuccessfulAccessAttemptsToFiles-Creat","fullDescription":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"help":{"text":"rationale:\nUnsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing\nthese events could serve as evidence of potential system compromise.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Unsuccessful Access Attempts to Files - creat."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_ftruncate","name":"RecordUnsuccessfulAccessAttemptsToFiles-Ftruncate","fullDescription":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"help":{"text":"rationale:\nUnsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing\nthese events could serve as evidence of potential system compromise.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Unsuccessful Access Attempts to Files - ftruncate."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open","name":"RecordUnsuccessfulAccessAttemptsToFiles-Open","fullDescription":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"help":{"text":"rationale:\nUnsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing\nthese events could serve as evidence of potential system compromise.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Unsuccessful Access Attempts to Files - open."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_open_by_handle_at","name":"RecordUnsuccessfulAccessAttemptsToFiles-Open_by_handle_at","fullDescription":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"help":{"text":"rationale:\nUnsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing\nthese events could serve as evidence of potential system compromise.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Unsuccessful Access Attempts to Files - open_by_handle_at."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_openat","name":"RecordUnsuccessfulAccessAttemptsToFiles-Openat","fullDescription":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"help":{"text":"rationale:\nUnsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing\nthese events could serve as evidence of potential system compromise.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Unsuccessful Access Attempts to Files - openat."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_unsuccessful_file_modification_truncate","name":"RecordUnsuccessfulAccessAttemptsToFiles-Truncate","fullDescription":{"text":"At a minimum, the audit system should collect unauthorized file\naccesses for all users and root. If thedaemon is configured\nto use theprogram to read audit rules during daemon\nstartup (the default), add the following lines to a file with suffixin the directory:If the system is 64 bit then also add the following lines:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:If the system is 64 bit then also add the following lines:."},"help":{"text":"rationale:\nUnsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing\nthese events could serve as evidence of potential system compromise.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect. Here the system calls\nhave been placed independent of other system calls. Grouping these system\ncalls with others as identifying earlier in this guide is more efficient."},"shortDescription":{"text":"Record Unsuccessful Access Attempts to Files - truncate."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_delete","name":"EnsureAuditdCollectsInformationOnKernelModuleUnloading-Delete_module","fullDescription":{"text":"To capture kernel module unloading events, use following line, setting ARCH to\neither b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:Place to add the line depends on a waydaemon is configured. If it is configured\nto use theprogram (the default), add the line to a file with suffixin the directory.\n\nIf thedaemon is configured to use theutility,\nadd the line to file."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# First perform the remediation of the syscall rule\n# Retrieve hardware architecture of the underlying system\n# Note: 32-bit and 64-bit kernel syscall numbers not always line up =>\n#       it's required on a 64-bit system to check also for the presence\n#       of 32-bit's equivalent of the corresponding rule.\n#       (See `man 7 audit.rules` for details )\n[ \"$(getconf LONG_BIT)\" = \"32\" ] && RULE_ARCHS=(\"b32\") || RULE_ARCHS=(\"b32\" \"b64\")\n\nfor ARCH in \"${RULE_ARCHS[@]}\"\ndo\n\tACTION_ARCH_FILTERS=\"-a always,exit -F arch=$ARCH\"\n\tOTHER_FILTERS=\"\"\n\t\n\tAUID_FILTERS=\"\"\n\t\n\tSYSCALL=\"delete_module\"\n\tKEY=\"modules\"\n\tSYSCALL_GROUPING=\"delete_module\"\n\t# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe removal of kernel modules can be used to alter the behavior of\nthe kernel and potentially introduce malicious code into kernel space. It is important\nto have an audit trail of modules that have been introduced into the kernel."},"shortDescription":{"text":"Ensure auditd Collects Information on Kernel Module Unloading - delete_module."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_finit","name":"EnsureAuditdCollectsInformationOnKernelModuleLoadingAndUnloading-Finit_module","fullDescription":{"text":"If thedaemon is configured to use theprogram\nto read audit rules during daemon startup (the default), add the following lines to a file\nwith suffixin the directoryto capture kernel module\nloading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system:If thedaemon is configured to use theutility to read audit\nrules during daemon startup, add the following lines tofile\nin order to capture kernel module loading and unloading events, setting ARCH to either b32 or\nb64 as appropriate for your system:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# First perform the remediation of the syscall rule\n# Retrieve hardware architecture of the underlying system\n# Note: 32-bit and 64-bit kernel syscall numbers not always line up =>\n#       it's required on a 64-bit system to check also for the presence\n#       of 32-bit's equivalent of the corresponding rule.\n#       (See `man 7 audit.rules` for details )\n[ \"$(getconf LONG_BIT)\" = \"32\" ] && RULE_ARCHS=(\"b32\") || RULE_ARCHS=(\"b32\" \"b64\")\n\nfor ARCH in \"${RULE_ARCHS[@]}\"\ndo\n\tACTION_ARCH_FILTERS=\"-a always,exit -F arch=$ARCH\"\n\tOTHER_FILTERS=\"\"\n\t\n\tAUID_FILTERS=\"\"\n\t\n\tSYSCALL=\"finit_module\"\n\tKEY=\"modules\"\n\tSYSCALL_GROUPING=\"init_module finit_module\"\n\t# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe addition/removal of kernel modules can be used to alter the behavior of\nthe kernel and potentially introduce malicious code into kernel space. It is important\nto have an audit trail of modules that have been introduced into the kernel."},"shortDescription":{"text":"Ensure auditd Collects Information on Kernel Module Loading and Unloading - finit_module."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_kernel_module_loading_init","name":"EnsureAuditdCollectsInformationOnKernelModuleLoading-Init_module","fullDescription":{"text":"To capture kernel module loading events, use following line, setting ARCH to\neither b32 for 32-bit system, or having two lines for both b32 and b64 in case your system is 64-bit:Place to add the line depends on a waydaemon is configured. If it is configured\nto use theprogram (the default), add the line to a file with suffixin the directory.\n\nIf thedaemon is configured to use theutility,\nadd the line to file."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# First perform the remediation of the syscall rule\n# Retrieve hardware architecture of the underlying system\n# Note: 32-bit and 64-bit kernel syscall numbers not always line up =>\n#       it's required on a 64-bit system to check also for the presence\n#       of 32-bit's equivalent of the corresponding rule.\n#       (See `man 7 audit.rules` for details )\n[ \"$(getconf LONG_BIT)\" = \"32\" ] && RULE_ARCHS=(\"b32\") || RULE_ARCHS=(\"b32\" \"b64\")\n\nfor ARCH in \"${RULE_ARCHS[@]}\"\ndo\n\tACTION_ARCH_FILTERS=\"-a always,exit -F arch=$ARCH\"\n\tOTHER_FILTERS=\"\"\n\t\n\tAUID_FILTERS=\"\"\n\t\n\tSYSCALL=\"init_module\"\n\tKEY=\"modules\"\n\tSYSCALL_GROUPING=\"init_module finit_module\"\n\t# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe addition of kernel modules can be used to alter the behavior of\nthe kernel and potentially introduce malicious code into kernel space. It is important\nto have an audit trail of modules that have been introduced into the kernel."},"shortDescription":{"text":"Ensure auditd Collects Information on Kernel Module Loading - init_module."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_login_events_faillog","name":"RecordAttemptsToAlterLogonAndLogoutEvents-Faillog","fullDescription":{"text":"The audit system already collects login information for all users\nand root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing logon events:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for unattempted manual\nedits of files involved in storing logon events:."},"help":{"text":"rationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Logon and Logout Events - faillog."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_login_events_lastlog","name":"RecordAttemptsToAlterLogonAndLogoutEvents-Lastlog","fullDescription":{"text":"The audit system already collects login information for all users\nand root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing logon events:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for unattempted manual\nedits of files involved in storing logon events:."},"help":{"text":"rationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Logon and Logout Events - lastlog."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_login_events_tallylog","name":"RecordAttemptsToAlterLogonAndLogoutEvents-Tallylog","fullDescription":{"text":"The audit system already collects login information for all users\nand root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing logon events:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for unattempted manual\nedits of files involved in storing logon events:."},"help":{"text":"rationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Logon and Logout Events - tallylog."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_init","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Init","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of the init command may cause availability issues for the system."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - init."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_poweroff","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Poweroff","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of the poweroff command may cause availability issues for the system."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - poweroff."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_reboot","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Reboot","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of the reboot command may cause availability issues for the system."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - reboot."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_privileged_commands_shutdown","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Shutdown","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of the shutdown command may cause availability issues for the system."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - shutdown."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands","fullDescription":{"text":"The audit system should collect information about usage of privileged commands for all users.\nThese are commands with suid or sgid bits on and they are specially risky in local block\ndevice partitions not mounted with noexec and nosuid options. Therefore, these partitions\nshould be first identified by the following command:For all partitions listed by the previous command, it is necessary to search for\nsetuid / setgid programs using the following command:For each setuid / setgid program identified by the previous command, an audit rule must be\npresent in the appropriate place using the following line structure:If thedaemon is configured to use theprogram to read\naudit rules during daemon startup, add the line to a file with suffixin thedirectory, replacing thepart with the full path\nof that setuid / setgid identified program.\n\nIf thedaemon is configured to use theutility instead, add\nthe line to thefile, also replacing thepart\nwith the full path of that setuid / setgid identified program."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nACTION_ARCH_FILTERS=\"-a always,exit\"\nAUID_FILTERS=\"-F auid>=1000 -F auid!=unset\"\nSYSCALL=\"\"\nKEY=\"privileged\"\nSYSCALL_GROUPING=\"\"\n\nFILTER_NODEV=$(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,)\nPARTITIONS=$(findmnt -n -l -k -it $FILTER_NODEV | grep -Pv \"noexec|nosuid|/proc($|/.*$)\" | awk '{ print $1 }')\nfor PARTITION in $PARTITIONS; do\n  PRIV_CMDS=$(find \"${PARTITION}\" -xdev -perm /6000 -type f 2>/dev/null)\n  for PRIV_CMD in $PRIV_CMDS; do\n    OTHER_FILTERS=\"-F path=$PRIV_CMD -F perm=x\"\n    # Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n    unset syscall_a\n    unset syscall_grouping\n    unset syscall_string\n    unset syscall\n    unset file_to_edit\n    unset rule_to_edit\n    unset rule_syscalls_to_edit\n    unset other_string\n    unset auid_string\n    unset full_rule\n\n    # Load macro arguments into arrays\n    read -a syscall_a <<< $SYSCALL\n    read -a syscall_grouping <<< $SYSCALL_GROUPING\n\n    # Create a list of audit *.rules files that should be inspected for presence and correctness\n    # of a particular audit rule. The scheme is as follows:\n    #\n    # -----------------------------------------------------------------------------------------\n    #  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n    # -----------------------------------------------------------------------------------------\n    #        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n    # -----------------------------------------------------------------------------------------\n    #        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n    #        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n    # -----------------------------------------------------------------------------------------\n    #\n    files_to_inspect=()\n\n\n    # If audit tool is 'augenrules', then check if the audit rule is defined\n    # If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n    # If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\n    default_file=\"/etc/audit/rules.d/$KEY.rules\"\n    # As other_filters may include paths, lets use a different delimiter for it\n    # The \"F\" script expression tells sed to print the filenames where the expressions matched\n    readarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n    # Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\n    if [ ${#files_to_inspect[@]} -eq \"0\" ]\n    then\n        file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n        files_to_inspect=(\"$file_to_inspect\")\n        if [ ! -e \"$file_to_inspect\" ]\n        then\n            touch \"$file_to_inspect\"\n            chmod 0640 \"$file_to_inspect\"\n        fi\n    fi\n\n    # After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\n    skip=1\n\n    for audit_file in \"${files_to_inspect[@]}\"\n    do\n        # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n        # i.e, collect rules that match:\n        # * the action, list and arch, (2-nd argument)\n        # * the other filters, (3-rd argument)\n        # * the auid filters, (4-rd argument)\n        readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n        candidate_rules=()\n        # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n        for s_rule in \"${similar_rules[@]}\"\n        do\n            # Strip all the options and fields we know of,\n            # than check if there was any field left over\n            extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n            grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n        done\n\n        if [[ ${#syscall_a[@]} -ge 1 ]]\n        then\n            # Check if the syscall we want is present in any of the similar existing rules\n            for rule in \"${candidate_rules[@]}\"\n            do\n                rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n                all_syscalls_found=0\n                for syscall in \"${syscall_a[@]}\"\n                do\n                    grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                       # A syscall was not found in the candidate rule\n                       all_syscalls_found=1\n                       }\n                done\n                if [[ $all_syscalls_found -eq 0 ]]\n                then\n                    # We found a rule with all the syscall(s) we want; skip rest of macro\n                    skip=0\n                    break\n                fi\n\n                # Check if this rule can be grouped with our target syscall and keep track of it\n                for syscall_g in \"${syscall_grouping[@]}\"\n                do\n                    if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                    then\n                        file_to_edit=${audit_file}\n                        rule_to_edit=${rule}\n                        rule_syscalls_to_edit=${rule_syscalls}\n                    fi\n                done\n            done\n        else\n            # If there is any candidate rule, it is compliant; skip rest of macro\n            if [ \"${#candidate_rules[@]}\" -gt 0 ]\n            then\n                skip=0\n            fi\n        fi\n\n        if [ \"$skip\" -eq 0 ]; then\n            break\n        fi\n    done\n\n    if [ \"$skip\" -ne 0 ]; then\n        # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n        # At this point we know if we need to either append the $full_rule or group\n        # the syscall together with an exsiting rule\n\n        # Append the full_rule if it cannot be grouped to any other rule\n        if [ -z ${rule_to_edit+x} ]\n        then\n            # Build full_rule while avoid adding double spaces when other_filters is empty\n            if [ \"${#syscall_a[@]}\" -gt 0 ]\n            then\n                syscall_string=\"\"\n                for syscall in \"${syscall_a[@]}\"\n                do\n                    syscall_string+=\" -S $syscall\"\n                done\n            fi\n            other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n            auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n            full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n            echo \"$full_rule\" >> \"$default_file\"\n            chmod o-rwx ${default_file}\n        else\n            # Check if the syscalls are declared as a comma separated list or\n            # as multiple -S parameters\n            if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n            then\n                delimiter=\",\"\n            else\n                delimiter=\" -S \"\n            fi\n            new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n                   # A syscall was not found in the candidate rule\n                   new_grouped_syscalls+=\"${delimiter}${syscall}\"\n                   }\n            done\n\n            # Group the syscall in the rule\n            sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n        fi\n    fi\n    unset syscall_a\n    unset syscall_grouping\n    unset syscall_string\n    unset syscall\n    unset file_to_edit\n    unset rule_to_edit\n    unset rule_syscalls_to_edit\n    unset other_string\n    unset auid_string\n    unset full_rule\n\n    # Load macro arguments into arrays\n    read -a syscall_a <<< $SYSCALL\n    read -a syscall_grouping <<< $SYSCALL_GROUPING\n\n    # Create a list of audit *.rules files that should be inspected for presence and correctness\n    # of a particular audit rule. The scheme is as follows:\n    #\n    # -----------------------------------------------------------------------------------------\n    #  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n    # -----------------------------------------------------------------------------------------\n    #        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n    # -----------------------------------------------------------------------------------------\n    #        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n    #        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n    # -----------------------------------------------------------------------------------------\n    #\n    files_to_inspect=()\n\n\n\n    # If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n    # file to the list of files to be inspected\n    default_file=\"/etc/audit/audit.rules\"\n    files_to_inspect+=('/etc/audit/audit.rules' )\n\n    # After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\n    skip=1\n\n    for audit_file in \"${files_to_inspect[@]}\"\n    do\n        # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n        # i.e, collect rules that match:\n        # * the action, list and arch, (2-nd argument)\n        # * the other filters, (3-rd argument)\n        # * the auid filters, (4-rd argument)\n        readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n        candidate_rules=()\n        # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n        for s_rule in \"${similar_rules[@]}\"\n        do\n            # Strip all the options and fields we know of,\n            # than check if there was any field left over\n            extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n            grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n        done\n\n        if [[ ${#syscall_a[@]} -ge 1 ]]\n        then\n            # Check if the syscall we want is present in any of the similar existing rules\n            for rule in \"${candidate_rules[@]}\"\n            do\n                rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n                all_syscalls_found=0\n                for syscall in \"${syscall_a[@]}\"\n                do\n                    grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                       # A syscall was not found in the candidate rule\n                       all_syscalls_found=1\n                       }\n                done\n                if [[ $all_syscalls_found -eq 0 ]]\n                then\n                    # We found a rule with all the syscall(s) we want; skip rest of macro\n                    skip=0\n                    break\n                fi\n\n                # Check if this rule can be grouped with our target syscall and keep track of it\n                for syscall_g in \"${syscall_grouping[@]}\"\n                do\n                    if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                    then\n                        file_to_edit=${audit_file}\n                        rule_to_edit=${rule}\n                        rule_syscalls_to_edit=${rule_syscalls}\n                    fi\n                done\n            done\n        else\n            # If there is any candidate rule, it is compliant; skip rest of macro\n            if [ \"${#candidate_rules[@]}\" -gt 0 ]\n            then\n                skip=0\n            fi\n        fi\n\n        if [ \"$skip\" -eq 0 ]; then\n            break\n        fi\n    done\n\n    if [ \"$skip\" -ne 0 ]; then\n        # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n        # At this point we know if we need to either append the $full_rule or group\n        # the syscall together with an exsiting rule\n\n        # Append the full_rule if it cannot be grouped to any other rule\n        if [ -z ${rule_to_edit+x} ]\n        then\n            # Build full_rule while avoid adding double spaces when other_filters is empty\n            if [ \"${#syscall_a[@]}\" -gt 0 ]\n            then\n                syscall_string=\"\"\n                for syscall in \"${syscall_a[@]}\"\n                do\n                    syscall_string+=\" -S $syscall\"\n                done\n            fi\n            other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n            auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n            full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n            echo \"$full_rule\" >> \"$default_file\"\n            chmod o-rwx ${default_file}\n        else\n            # Check if the syscalls are declared as a comma separated list or\n            # as multiple -S parameters\n            if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n            then\n                delimiter=\",\"\n            else\n                delimiter=\" -S \"\n            fi\n            new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n                   # A syscall was not found in the candidate rule\n                   new_grouped_syscalls+=\"${delimiter}${syscall}\"\n                   }\n            done\n\n            # Group the syscall in the rule\n            sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n        fi\n    fi\n  done\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nMisuse of privileged functions, either intentionally or unintentionally by authorized users,\nor by unauthorized external entities that have compromised system accounts, is a serious and\nongoing concern that can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify the\nrisk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks, which attempt to subvert\ntheir normal role of providing some necessary but limited capability. As such, motivation\nexists to monitor these programs for unusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_apparmor_parser","name":"RecordAnyAttemptsToRunApparmor_parser","fullDescription":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If\nthedaemon is configured to use theprogram to read audit rules during daemon startup (the default), add\nthe following lines to a file with suffixin the\ndirectory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following\nlines tofile:."},"help":{"text":"rationale:\nWithout generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one.\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Record Any Attempts to Run apparmor_parser."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_at","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-At","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - at."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chage","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Chage","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - chage."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chfn","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Chfn","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nWithout generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one.\n\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - chfn."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_chsh","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Chsh","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - chsh."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_crontab","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Crontab","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - crontab."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_fdisk","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Fdisk","fullDescription":{"text":"Configure the operating system to audit the execution of the partition\nmanagement program \"fdisk\"."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/fdisk\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/fdisk $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/fdisk$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/fdisk -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/modules.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/sbin/fdisk\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/modules.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/modules.rules\"\n    # If the modules.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/fdisk\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/fdisk $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/fdisk$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/fdisk -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nWithout generating audit records that are specific to the security\nand mission needs of the organization, it would be difficult to\nestablish, correlate, and investigate the events relating to an\nincident or identify those responsible for one.\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - fdisk."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_gpasswd","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Gpasswd","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - gpasswd."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_insmod","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Insmod","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/insmod\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/insmod $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/insmod$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/insmod -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/modules.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/sbin/insmod\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/modules.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/modules.rules\"\n    # If the modules.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/insmod\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/insmod $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/insmod$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/insmod -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - insmod."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1) ii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_kmod","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Kmod","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nWithout generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one.\n\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - kmod."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1) ii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (1) iv. AU-12.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_modprobe","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Modprobe","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/modprobe\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/modprobe $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/modprobe$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/modprobe -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/modules.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/sbin/modprobe\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/modules.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/modules.rules\"\n    # If the modules.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/modprobe\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/modprobe $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/modprobe$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/modprobe -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - modprobe."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1) ii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_mount","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Mount","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - mount."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newgidmap","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Newgidmap","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - newgidmap."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newgrp","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Newgrp","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - newgrp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_newuidmap","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Newuidmap","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - newuidmap."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_pam_timestamp_check","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Pam_timestamp_check","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - pam_timestamp_check."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_passwd","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Passwd","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - passwd."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_postdrop","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Postdrop","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - postdrop."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_postqueue","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Postqueue","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - postqueue."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_rmmod","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Rmmod","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/rmmod\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/rmmod $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/rmmod$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/rmmod -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/modules.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/sbin/rmmod\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/modules.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/modules.rules\"\n    # If the modules.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/sbin/rmmod\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/sbin/rmmod $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"x\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/sbin/rmmod$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /sbin/rmmod -p x -k modules\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - rmmod."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_ssh_agent","name":"RecordAnyAttemptsToRunSsh-agent","fullDescription":{"text":"At a minimum, the audit system should collect any execution attempt\nof thecommand for all users and root. If thedaemon is configured to use theprogram to read audit rules\nduring daemon startup (the default), add the following lines to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile:."},"help":{"text":"rationale:\nWithout generating audit records that are specific to the security and\nmission needs of the organization, it would be difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one.\n\nAudit records can be generated from various components within the\ninformation system (e.g., module or policy filter)."},"shortDescription":{"text":"Record Any Attempts to Run ssh-agent."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_ssh_keysign","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Ssh-keysign","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - ssh-keysign."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_su","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Su","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - su."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sudo","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Sudo","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - sudo."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_sudoedit","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Sudoedit","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - sudoedit."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_umount","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Umount","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - umount."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_unix_chkpwd","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Unix_chkpwd","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - unix_chkpwd."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (1) ii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_unix_update","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Unix_update","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - unix_update."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_privileged_commands_usermod","name":"EnsureAuditdCollectsInformationOnTheUseOfPrivilegedCommands-Usermod","fullDescription":{"text":"At a minimum, the audit system should collect the execution of\nprivileged commands for all users and root. If thedaemon is\nconfigured to use theprogram to read audit rules during\ndaemon startup (the default), add a line of the following form to a file with\nsuffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add a line of the following\nform to:."},"help":{"text":"rationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have compromised system accounts,\nis a serious and ongoing concern and can have significant adverse impacts on organizations.\nAuditing the use of privileged functions is one way to detect such misuse and identify\nthe risk from insider and advanced persistent threats.Privileged programs are subject to escalation-of-privilege attacks,\nwhich attempt to subvert their normal role of providing some necessary but\nlimited capability. As such, motivation exists to monitor these programs for\nunusual activity."},"shortDescription":{"text":"Ensure auditd Collects Information on the Use of Privileged Commands - usermod."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_time_adjtimex","name":"RecordAttemptsToAlterTimeThroughAdjtimex","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:The -k option allows for the specification of a key in string form that can be\nused for better reporting capability through ausearch and aureport. Multiple\nsystem calls can be defined on the same line to save space if desired, but is\nnot required. See an example of multiple combined syscalls:."},"help":{"text":"rationale:\nArbitrary changes to the system time can be used to obfuscate\nnefarious activities in log files, as well as to confuse network services that\nare highly dependent upon an accurate system time (such as sshd). All changes\nto the system time should be audited."},"shortDescription":{"text":"Record attempts to alter time through adjtimex."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_time_clock_settime","name":"RecordAttemptsToAlterTimeThroughClock_settime","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:The -k option allows for the specification of a key in string form that can\nbe used for better reporting capability through ausearch and aureport.\nMultiple system calls can be defined on the same line to save space if\ndesired, but is not required. See an example of multiple combined syscalls:."},"help":{"text":"rationale:\nArbitrary changes to the system time can be used to obfuscate\nnefarious activities in log files, as well as to confuse network services that\nare highly dependent upon an accurate system time (such as sshd). All changes\nto the system time should be audited."},"shortDescription":{"text":"Record Attempts to Alter Time Through clock_settime."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_time_settimeofday","name":"RecordAttemptsToAlterTimeThroughSettimeofday","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If the system is 64 bit then also add the following line:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:If the system is 64 bit then also add the following line:The -k option allows for the specification of a key in string form that can be\nused for better reporting capability through ausearch and aureport. Multiple\nsystem calls can be defined on the same line to save space if desired, but is\nnot required. See an example of multiple combined syscalls:."},"help":{"text":"rationale:\nArbitrary changes to the system time can be used to obfuscate\nnefarious activities in log files, as well as to confuse network services that\nare highly dependent upon an accurate system time (such as sshd). All changes\nto the system time should be audited."},"shortDescription":{"text":"Record attempts to alter time through settimeofday."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_time_stime","name":"RecordAttemptsToAlterTimeThroughStime","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectoryfor both 32 bit and 64 bit systems:Since the 64 bit version of the \"stime\" system call is not defined in the audit\nlookup table, the corresponding \"-F arch=b64\" form of this rule is not expected\nto be defined on 64 bit systems (the aforementioned \"-F arch=b32\" stime rule\nform itself is sufficient for both 32 bit and 64 bit systems). If thedaemon is configured to use theutility to\nread audit rules during daemon startup, add the following line tofile for both 32 bit and 64 bit systems:Since the 64 bit version of the \"stime\" system call is not defined in the audit\nlookup table, the corresponding \"-F arch=b64\" form of this rule is not expected\nto be defined on 64 bit systems (the aforementioned \"-F arch=b32\" stime rule\nform itself is sufficient for both 32 bit and 64 bit systems). The -k option\nallows for the specification of a key in string form that can be used for\nbetter reporting capability through ausearch and aureport. Multiple system\ncalls can be defined on the same line to save space if desired, but is not\nrequired. See an example of multiple combined system calls:."},"help":{"text":"rationale:\nArbitrary changes to the system time can be used to obfuscate\nnefarious activities in log files, as well as to confuse network services that\nare highly dependent upon an accurate system time (such as sshd). All changes\nto the system time should be audited."},"shortDescription":{"text":"Record Attempts to Alter Time Through stime."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_time_watch_localtime","name":"RecordAttemptsToAlterTheLocaltimeFile","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default),\nadd the following line to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:The -k option allows for the specification of a key in string form that can\nbe used for better reporting capability through ausearch and aureport and\nshould always be used."},"help":{"text":"rationale:\nArbitrary changes to the system time can be used to obfuscate\nnefarious activities in log files, as well as to confuse network services that\nare highly dependent upon an accurate system time (such as sshd). All changes\nto the system time should be audited."},"shortDescription":{"text":"Record Attempts to Alter the localtime File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_immutable","name":"MakeTheAuditdConfigurationImmutable","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectoryin order to make the auditd configuration\nimmutable:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile in order to make the auditd configuration\nimmutable:With this setting, a reboot will be required to change any audit rules."},"help":{"text":"rationale:\nMaking the audit configuration immutable prevents accidental as\nwell as malicious modification of the audit rules, although it may be\nproblematic if legitimate changes are needed during system\noperation."},"shortDescription":{"text":"Make the auditd Configuration Immutable."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_mac_modification","name":"RecordEventsThatModifyTheSystem'sMandatoryAccessControls","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/selinux/\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/selinux/ $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/selinux/$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/selinux/ -p wa -k MAC-policy\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/MAC-policy.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/etc/selinux/\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/MAC-policy.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/MAC-policy.rules\"\n    # If the MAC-policy.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/selinux/\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/selinux/ $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/selinux/$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/selinux/ -p wa -k MAC-policy\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe system's mandatory access policy (SELinux) should not be\narbitrarily changed by anything other than administrator action. All changes to\nMAC policy should be audited."},"shortDescription":{"text":"Record Events that Modify the System's Mandatory Access Controls."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_mac_modification_usr_share","name":"RecordEventsThatModifyTheSystem'sMandatoryAccessControlsInUsr/share","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following line to a file with suffixin the\ndirectory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/usr/share/selinux/\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/usr/share/selinux/ $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/usr/share/selinux/$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /usr/share/selinux/ -p wa -k MAC-policy\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/MAC-policy.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/usr/share/selinux/\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/MAC-policy.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/MAC-policy.rules\"\n    # If the MAC-policy.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/usr/share/selinux/\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/usr/share/selinux/ $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/usr/share/selinux/$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /usr/share/selinux/ -p wa -k MAC-policy\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe system's mandatory access policy (SELinux) should not be\narbitrarily changed by anything other than administrator action. All changes to\nMAC policy should be audited."},"shortDescription":{"text":"Record Events that Modify the System's Mandatory Access Controls in usr/share."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_media_export","name":"EnsureAuditdCollectsInformationOnExportingToMedia(successful)","fullDescription":{"text":"At a minimum, the audit system should collect media exportation\nevents for all users and root. If thedaemon is configured to\nuse theprogram to read audit rules during daemon startup\n(the default), add the following line to a file with suffixin\nthe directory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"rationale:\nThe unauthorized exportation of data to external media could result in an information leak\nwhere classified information, Privacy Act information, and intellectual property could be lost. An audit\ntrail should be created each time a filesystem is mounted to help identify and guard against information\nloss."},"shortDescription":{"text":"Ensure auditd Collects Information on Exporting to Media (successful)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_networkconfig_modification","name":"RecordEventsThatModifyTheSystem'sNetworkEnvironment","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, setting ARCH to either b32 or b64 as\nappropriate for your system:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, setting ARCH to either b32 or b64 as\nappropriate for your system:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# First perform the remediation of the syscall rule\n# Retrieve hardware architecture of the underlying system\n[ \"$(getconf LONG_BIT)\" = \"32\" ] && RULE_ARCHS=(\"b32\") || RULE_ARCHS=(\"b32\" \"b64\")\n\nfor ARCH in \"${RULE_ARCHS[@]}\"\ndo\n\tACTION_ARCH_FILTERS=\"-a always,exit -F arch=$ARCH\"\n\tOTHER_FILTERS=\"\"\n\tAUID_FILTERS=\"\"\n\tSYSCALL=\"sethostname setdomainname\"\n\tKEY=\"audit_rules_networkconfig_modification\"\n\tSYSCALL_GROUPING=\"sethostname setdomainname\"\n\t# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\ndone\n\n# Then perform the remediations for the watch rules\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/issue\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/issue $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/issue$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/issue -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/etc/issue\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/audit_rules_networkconfig_modification.rules\"\n    # If the audit_rules_networkconfig_modification.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/issue\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/issue $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/issue$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/issue -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/issue.net\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/issue.net $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/issue.net$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/etc/issue.net\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/audit_rules_networkconfig_modification.rules\"\n    # If the audit_rules_networkconfig_modification.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/issue.net\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/issue.net $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/issue.net$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/issue.net -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/hosts\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/hosts $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/hosts$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/hosts -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/etc/hosts\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/audit_rules_networkconfig_modification.rules\"\n    # If the audit_rules_networkconfig_modification.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/hosts\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/hosts $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/hosts$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/hosts -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/sysconfig/network\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/sysconfig/network $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/sysconfig/network$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/etc/sysconfig/network\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/audit_rules_networkconfig_modification.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/audit_rules_networkconfig_modification.rules\"\n    # If the audit_rules_networkconfig_modification.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/etc/sysconfig/network\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/etc/sysconfig/network $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/etc/sysconfig/network$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /etc/sysconfig/network -p wa -k audit_rules_networkconfig_modification\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe network environment should not be modified by anything other\nthan administrator action. Any change to network parameters should be\naudited."},"shortDescription":{"text":"Record Events that Modify the System's Network Environment."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_session_events","name":"RecordAttemptsToAlterProcessAndSessionInitiationInformation","fullDescription":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"help":{"text":"check:\noval:ssg-audit_rules_session_events:def:1\nfix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/run/utmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/run/utmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/run/utmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/run/utmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/session.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/var/run/utmp\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/session.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/session.rules\"\n    # If the session.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/run/utmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/run/utmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/run/utmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/run/utmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/btmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/btmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/btmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/btmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/session.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/var/log/btmp\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/session.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/session.rules\"\n    # If the session.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/btmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/btmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/btmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/btmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/wtmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/wtmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/wtmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/wtmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/session.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/var/log/wtmp\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/session.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/session.rules\"\n    # If the session.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/wtmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/wtmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/wtmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/wtmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Process and Session Initiation Information."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_session_events_btmp","name":"RecordAttemptsToAlterProcessAndSessionInitiationInformationBtmp","fullDescription":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/btmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/btmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/btmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/btmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/session.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/var/log/btmp\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/session.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/session.rules\"\n    # If the session.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/btmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/btmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/btmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/btmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Process and Session Initiation Information btmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_session_events_utmp","name":"RecordAttemptsToAlterProcessAndSessionInitiationInformationUtmp","fullDescription":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/run/utmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/run/utmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/run/utmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /run/utmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/session.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/run/utmp\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/session.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/session.rules\"\n    # If the session.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/run/utmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/run/utmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/run/utmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /run/utmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Process and Session Initiation Information utmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_session_events_wtmp","name":"RecordAttemptsToAlterProcessAndSessionInitiationInformationWtmp","fullDescription":{"text":"The audit system already collects process information for all\nusers and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectoryin order to watch for attempted manual\nedits of files involved in storing such process information:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile in order to watch for attempted manual\nedits of files involved in storing such process information:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n\n# If the audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# into the list of files to be inspected\nfiles_to_inspect+=('/etc/audit/audit.rules')\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/wtmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/wtmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/wtmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/wtmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n# Tool used to load audit rules\t| Rule already defined\t|  Audit rules file to inspect\t  |\n# -----------------------------------------------------------------------------------------\n#\tauditctl\t\t|     Doesn't matter\t|  /etc/audit/audit.rules\t  |\n# -----------------------------------------------------------------------------------------\n# \taugenrules\t\t|          Yes\t\t|  /etc/audit/rules.d/*.rules\t  |\n# \taugenrules\t\t|          No\t\t|  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\nfiles_to_inspect=()\n\n# If the audit is 'augenrules', then check if rule is already defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to list of files for inspection.\n# If rule isn't defined, add '/etc/audit/rules.d/session.rules' to list of files for inspection.\nreadarray -t matches < <(grep -HP \"[\\s]*-w[\\s]+/var/log/wtmp\" /etc/audit/rules.d/*.rules)\n\n# For each of the matched entries\nfor match in \"${matches[@]}\"\ndo\n    # Extract filepath from the match\n    rulesd_audit_file=$(echo $match | cut -f1 -d ':')\n    # Append that path into list of files for inspection\n    files_to_inspect+=(\"$rulesd_audit_file\")\ndone\n# Case when particular audit rule isn't defined yet\nif [ \"${#files_to_inspect[@]}\" -eq \"0\" ]\nthen\n    # Append '/etc/audit/rules.d/session.rules' into list of files for inspection\n    key_rule_file=\"/etc/audit/rules.d/session.rules\"\n    # If the session.rules file doesn't exist yet, create it with correct permissions\n    if [ ! -e \"$key_rule_file\" ]\n    then\n        touch \"$key_rule_file\"\n        chmod 0640 \"$key_rule_file\"\n    fi\n    files_to_inspect+=(\"$key_rule_file\")\nfi\n\n# Finally perform the inspection and possible subsequent audit rule\n# correction for each of the files previously identified for inspection\nfor audit_rules_file in \"${files_to_inspect[@]}\"\ndo\n    # Check if audit watch file system object rule for given path already present\n    if grep -q -P -- \"^[\\s]*-w[\\s]+/var/log/wtmp\" \"$audit_rules_file\"\n    then\n        # Rule is found => verify yet if existing rule definition contains\n        # all of the required access type bits\n\n        # Define BRE whitespace class shortcut\n        sp=\"[[:space:]]\"\n        # Extract current permission access types (e.g. -p [r|w|x|a] values) from audit rule\n        current_access_bits=$(sed -ne \"s#$sp*-w$sp\\+/var/log/wtmp $sp\\+-p$sp\\+\\([rxwa]\\{1,4\\}\\).*#\\1#p\" \"$audit_rules_file\")\n        # Split required access bits string into characters array\n        # (to check bit's presence for one bit at a time)\n        for access_bit in $(echo \"wa\" | grep -o .)\n        do\n            # For each from the required access bits (e.g. 'w', 'a') check\n            # if they are already present in current access bits for rule.\n            # If not, append that bit at the end\n            if ! grep -q \"$access_bit\" <<< \"$current_access_bits\"\n            then\n                # Concatenate the existing mask with the missing bit\n                current_access_bits=\"$current_access_bits$access_bit\"\n            fi\n        done\n        # Propagate the updated rule's access bits (original + the required\n        # ones) back into the /etc/audit/audit.rules file for that rule\n        sed -i \"s#\\($sp*-w$sp\\+/var/log/wtmp$sp\\+-p$sp\\+\\)\\([rxwa]\\{1,4\\}\\)\\(.*\\)#\\1$current_access_bits\\3#\" \"$audit_rules_file\"\n    else\n        # Rule isn't present yet. Append it at the end of $audit_rules_file file\n        # with proper key\n\n        echo \"-w /var/log/wtmp -p wa -k session\" >> \"$audit_rules_file\"\n    fi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nManual editing of these files may indicate nefarious activity, such\nas an attacker attempting to remove evidence of an intrusion."},"shortDescription":{"text":"Record Attempts to Alter Process and Session Initiation Information wtmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_suid_privilege_function","name":"RecordEventsWhenPrivilegedExecutablesAreRun","fullDescription":{"text":"Verify the system generates an audit record when privileged functions are executed.\n\nIf audit is using the \"auditctl\" tool to load the rules, run the following command:If audit is using the \"augenrules\" tool to load the rules, run the following command:If both the \"b32\" and \"b64\" audit rules for \"SUID\" files are not defined, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules for \"SGID\" files are not defined, this is a finding."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\n# First perform the remediation of the syscall rule\n# Retrieve hardware architecture of the underlying system\n[ \"$(getconf LONG_BIT)\" = \"32\" ] && RULE_ARCHS=(\"b32\") || RULE_ARCHS=(\"b32\" \"b64\")\n\nfor ARCH in \"${RULE_ARCHS[@]}\"\ndo\n\tACTION_ARCH_FILTERS=\"-a always,exit -F arch=$ARCH\"\n\t\n\tOTHER_FILTERS=\"-C uid!=euid -F euid=0\"\n\t\n\tAUID_FILTERS=\"\"\n\tSYSCALL=\"execve\"\n\tKEY=\"setuid\"\n\tSYSCALL_GROUPING=\"\"\n\t# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\ndone\n\nfor ARCH in \"${RULE_ARCHS[@]}\"\ndo\n\tACTION_ARCH_FILTERS=\"-a always,exit -F arch=$ARCH\"\n\t\n\tOTHER_FILTERS=\"-C gid!=egid -F egid=0\"\n\t\n\tAUID_FILTERS=\"\"\n\tSYSCALL=\"execve\"\n\tKEY=\"setgid\"\n\tSYSCALL_GROUPING=\"\"\n\t# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\tunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\ndone\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nMisuse of privileged functions, either intentionally or unintentionally by\nauthorized users, or by unauthorized external entities that have\ncompromised information system accounts, is a serious and ongoing concern\nand can have significant adverse impacts on organizations. Auditing the use\nof privileged functions is one way to detect such misuse and identify the\nrisk from insider threats and the advanced persistent threat.\nwarning:\nNote that these rules can be configured in a\nnumber of ways while still achieving the desired effect."},"shortDescription":{"text":"Record Events When Privileged Executables Are Run."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (8)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_sysadmin_actions","name":"EnsureAuditdCollectsSystemAdministratorActions","fullDescription":{"text":"At a minimum, the audit system should collect administrator actions\nfor all users and root. If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default),\nadd the following line to a file with suffixin the directory:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following line tofile:."},"help":{"text":"rationale:\nThe actions taken by system administrators should be audited to keep a record\nof what was executed on the system, as well as, for accountability purposes."},"shortDescription":{"text":"Ensure auditd Collects System Administrator Actions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (7) b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification","name":"RecordEventsThatModifyUser/GroupInformation","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"help":{"text":"rationale:\nIn addition to auditing new user and group accounts, these watches\nwill alert the system administrator(s) to any modifications. Any unexpected\nusers, groups, or modifications should be investigated for legitimacy.\nwarning:\nThis rule checks for multiple syscalls related to account changes;\nit was written with DISA STIG in mind. Other policies should use a\nseparate rule for each syscall that needs to be checked. For example:"},"shortDescription":{"text":"Record Events that Modify User/Group Information."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_group","name":"RecordEventsThatModifyUser/GroupInformation-/etc/group","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"help":{"text":"rationale:\nIn addition to auditing new user and group accounts, these watches\nwill alert the system administrator(s) to any modifications. Any unexpected\nusers, groups, or modifications should be investigated for legitimacy."},"shortDescription":{"text":"Record Events that Modify User/Group Information - /etc/group."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_gshadow","name":"RecordEventsThatModifyUser/GroupInformation-/etc/gshadow","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"help":{"text":"rationale:\nIn addition to auditing new user and group accounts, these watches\nwill alert the system administrator(s) to any modifications. Any unexpected\nusers, groups, or modifications should be investigated for legitimacy."},"shortDescription":{"text":"Record Events that Modify User/Group Information - /etc/gshadow."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_opasswd","name":"RecordEventsThatModifyUser/GroupInformation-/etc/security/opasswd","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"help":{"text":"rationale:\nIn addition to auditing new user and group accounts, these watches\nwill alert the system administrator(s) to any modifications. Any unexpected\nusers, groups, or modifications should be investigated for legitimacy."},"shortDescription":{"text":"Record Events that Modify User/Group Information - /etc/security/opasswd."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_passwd","name":"RecordEventsThatModifyUser/GroupInformation-/etc/passwd","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"help":{"text":"rationale:\nIn addition to auditing new user and group accounts, these watches\nwill alert the system administrator(s) to any modifications. Any unexpected\nusers, groups, or modifications should be investigated for legitimacy."},"shortDescription":{"text":"Record Events that Modify User/Group Information - /etc/passwd."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_rules_usergroup_modification_shadow","name":"RecordEventsThatModifyUser/GroupInformation-/etc/shadow","fullDescription":{"text":"If thedaemon is configured to use theprogram to read audit rules during daemon startup (the\ndefault), add the following lines to a file with suffixin the\ndirectory, in order to capture events that modify\naccount changes:If thedaemon is configured to use theutility to read audit rules during daemon startup, add the following lines tofile, in order to capture events that modify\naccount changes:."},"help":{"text":"rationale:\nIn addition to auditing new user and group accounts, these watches\nwill alert the system administrator(s) to any modifications. Any unexpected\nusers, groups, or modifications should be investigated for legitimacy."},"shortDescription":{"text":"Record Events that Modify User/Group Information - /etc/shadow."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_audit_sudo_log_events","name":"RecordAttemptsToPerformMaintenanceActivities","fullDescription":{"text":"The Ubuntu 22.04 operating system must generate audit records for\nprivileged activities, nonlocal maintenance, diagnostic sessions and\nother system-level access.\n\nVerify the operating system audits activities performed during nonlocal\nmaintenance and diagnostic sessions. Run the following command:."},"help":{"text":"rationale:\nIf events associated with nonlocal administrative access or diagnostic\nsessions are not logged, a major tool for assessing and investigating\nattacks would not be available.\nThis requirement addresses auditing-related issues associated with\nmaintenance tools used specifically for diagnostic and repair actions\non organizational information systems.\nNonlocal maintenance and diagnostic activities are those activities\nconducted by individuals communicating through a network, either an\nexternal network (e.g., the internet) or an internal network. Local\nmaintenance and diagnostic activities are those activities carried\nout by individuals physically present at the information system or\ninformation system component and not communicating across a network\nconnection.\nThis requirement applies to hardware/software diagnostic test\nequipment or tools. This requirement does not cover hardware/software\ncomponents that may support information system maintenance, yet are a\npart of the system, for example, the software implementing \"ping,\"\n\"ls,\" \"ipconfig,\" or the hardware and software implementing the\nmonitoring port of an Ethernet switch."},"shortDescription":{"text":"Record Attempts to perform maintenance activities."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_directory_access_var_log_audit","name":"RecordAccessEventsToAuditLogDirectory","fullDescription":{"text":"The audit system should collect access events to read audit log directory.\nThe following audit rule will assure that access to audit log directory are\ncollected.If thedaemon is configured to use theprogram to read audit rules during daemon startup (the default), add the\nrule to a file with suffixin the directory.\nIf thedaemon is configured to use theutility to read audit rules during daemon startup, add the rule tofile."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nACTION_ARCH_FILTERS=\"-a always,exit\"\nOTHER_FILTERS=\"-F dir=/var/log/audit/ -F perm=r\"\nAUID_FILTERS=\"-F auid>=1000 -F auid!=unset\"\nSYSCALL=\"\"\nKEY=\"access-audit-trail\"\nSYSCALL_GROUPING=\"\"\n# Perform the remediation for both possible tools: 'auditctl' and 'augenrules'\nunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n# If audit tool is 'augenrules', then check if the audit rule is defined\n# If rule is defined, add '/etc/audit/rules.d/*.rules' to the list for inspection\n# If rule isn't defined yet, add '/etc/audit/rules.d/$key.rules' to the list for inspection\ndefault_file=\"/etc/audit/rules.d/$KEY.rules\"\n# As other_filters may include paths, lets use a different delimiter for it\n# The \"F\" script expression tells sed to print the filenames where the expressions matched\nreadarray -t files_to_inspect < <(sed -s -n -e \"/^$ACTION_ARCH_FILTERS/!d\" -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" -e \"F\" /etc/audit/rules.d/*.rules)\n# Case when particular rule isn't defined in /etc/audit/rules.d/*.rules yet\nif [ ${#files_to_inspect[@]} -eq \"0\" ]\nthen\n    file_to_inspect=\"/etc/audit/rules.d/$KEY.rules\"\n    files_to_inspect=(\"$file_to_inspect\")\n    if [ ! -e \"$file_to_inspect\" ]\n    then\n        touch \"$file_to_inspect\"\n        chmod 0640 \"$file_to_inspect\"\n    fi\nfi\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\nunset syscall_a\nunset syscall_grouping\nunset syscall_string\nunset syscall\nunset file_to_edit\nunset rule_to_edit\nunset rule_syscalls_to_edit\nunset other_string\nunset auid_string\nunset full_rule\n\n# Load macro arguments into arrays\nread -a syscall_a <<< $SYSCALL\nread -a syscall_grouping <<< $SYSCALL_GROUPING\n\n# Create a list of audit *.rules files that should be inspected for presence and correctness\n# of a particular audit rule. The scheme is as follows:\n#\n# -----------------------------------------------------------------------------------------\n#  Tool used to load audit rules | Rule already defined  |  Audit rules file to inspect    |\n# -----------------------------------------------------------------------------------------\n#        auditctl                |     Doesn't matter    |  /etc/audit/audit.rules         |\n# -----------------------------------------------------------------------------------------\n#        augenrules              |          Yes          |  /etc/audit/rules.d/*.rules     |\n#        augenrules              |          No           |  /etc/audit/rules.d/$key.rules  |\n# -----------------------------------------------------------------------------------------\n#\nfiles_to_inspect=()\n\n\n\n# If audit tool is 'auditctl', then add '/etc/audit/audit.rules'\n# file to the list of files to be inspected\ndefault_file=\"/etc/audit/audit.rules\"\nfiles_to_inspect+=('/etc/audit/audit.rules' )\n\n# After converting to jinja, we cannot return; therefore we skip the rest of the macro if needed instead\nskip=1\n\nfor audit_file in \"${files_to_inspect[@]}\"\ndo\n    # Filter existing $audit_file rules' definitions to select those that satisfy the rule pattern,\n    # i.e, collect rules that match:\n    # * the action, list and arch, (2-nd argument)\n    # * the other filters, (3-rd argument)\n    # * the auid filters, (4-rd argument)\n    readarray -t similar_rules < <(sed -e \"/^$ACTION_ARCH_FILTERS/!d\"  -e \"\\#$OTHER_FILTERS#!d\" -e \"/$AUID_FILTERS/!d\" \"$audit_file\")\n\n    candidate_rules=()\n    # Filter out rules that have more fields then required. This will remove rules more specific than the required scope\n    for s_rule in \"${similar_rules[@]}\"\n    do\n        # Strip all the options and fields we know of,\n        # than check if there was any field left over\n        extra_fields=$(sed -E -e \"s/^$ACTION_ARCH_FILTERS//\"  -e \"s#$OTHER_FILTERS##\" -e \"s/$AUID_FILTERS//\" -e \"s/((:?-S [[:alnum:],]+)+)//g\" -e \"s/-F key=\\w+|-k \\w+//\"<<< \"$s_rule\")\n        grep -q -- \"-F\" <<< \"$extra_fields\" || candidate_rules+=(\"$s_rule\")\n    done\n\n    if [[ ${#syscall_a[@]} -ge 1 ]]\n    then\n        # Check if the syscall we want is present in any of the similar existing rules\n        for rule in \"${candidate_rules[@]}\"\n        do\n            rule_syscalls=$(echo \"$rule\" | grep -o -P '(-S [\\w,]+)+' | xargs)\n            all_syscalls_found=0\n            for syscall in \"${syscall_a[@]}\"\n            do\n                grep -q -- \"\\b${syscall}\\b\" <<< \"$rule_syscalls\" || {\n                   # A syscall was not found in the candidate rule\n                   all_syscalls_found=1\n                   }\n            done\n            if [[ $all_syscalls_found -eq 0 ]]\n            then\n                # We found a rule with all the syscall(s) we want; skip rest of macro\n                skip=0\n                break\n            fi\n\n            # Check if this rule can be grouped with our target syscall and keep track of it\n            for syscall_g in \"${syscall_grouping[@]}\"\n            do\n                if grep -q -- \"\\b${syscall_g}\\b\" <<< \"$rule_syscalls\"\n                then\n                    file_to_edit=${audit_file}\n                    rule_to_edit=${rule}\n                    rule_syscalls_to_edit=${rule_syscalls}\n                fi\n            done\n        done\n    else\n        # If there is any candidate rule, it is compliant; skip rest of macro\n        if [ \"${#candidate_rules[@]}\" -gt 0 ]\n        then\n            skip=0\n        fi\n    fi\n\n    if [ \"$skip\" -eq 0 ]; then\n        break\n    fi\ndone\n\nif [ \"$skip\" -ne 0 ]; then\n    # We checked all rules that matched the expected resemblance pattern (action, arch & auid)\n    # At this point we know if we need to either append the $full_rule or group\n    # the syscall together with an exsiting rule\n\n    # Append the full_rule if it cannot be grouped to any other rule\n    if [ -z ${rule_to_edit+x} ]\n    then\n        # Build full_rule while avoid adding double spaces when other_filters is empty\n        if [ \"${#syscall_a[@]}\" -gt 0 ]\n        then\n            syscall_string=\"\"\n            for syscall in \"${syscall_a[@]}\"\n            do\n                syscall_string+=\" -S $syscall\"\n            done\n        fi\n        other_string=$([[ $OTHER_FILTERS ]] && echo \" $OTHER_FILTERS\") || /bin/true\n        auid_string=$([[ $AUID_FILTERS ]] && echo \" $AUID_FILTERS\") || /bin/true\n        full_rule=\"$ACTION_ARCH_FILTERS${syscall_string}${other_string}${auid_string} -F key=$KEY\" || /bin/true\n        echo \"$full_rule\" >> \"$default_file\"\n        chmod o-rwx ${default_file}\n    else\n        # Check if the syscalls are declared as a comma separated list or\n        # as multiple -S parameters\n        if grep -q -- \",\" <<< \"${rule_syscalls_to_edit}\"\n        then\n            delimiter=\",\"\n        else\n            delimiter=\" -S \"\n        fi\n        new_grouped_syscalls=\"${rule_syscalls_to_edit}\"\n        for syscall in \"${syscall_a[@]}\"\n        do\n            grep -q -- \"\\b${syscall}\\b\" <<< \"${rule_syscalls_to_edit}\" || {\n               # A syscall was not found in the candidate rule\n               new_grouped_syscalls+=\"${delimiter}${syscall}\"\n               }\n        done\n\n        # Group the syscall in the rule\n        sed -i -e \"\\#${rule_to_edit}#s#${rule_syscalls_to_edit}#${new_grouped_syscalls}#\" \"$file_to_edit\"\n    fi\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAttempts to read the logs should be recorded, suspicious access to audit log files could be an indicator of malicious activity on a system.\nAuditing these events could serve as evidence of potential system compromise.'"},"shortDescription":{"text":"Record Access Events to Audit Log Directory."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_directory_permissions_var_log_audit","name":"SystemAuditLogsMustHaveMode0750OrLessPermissive","fullDescription":{"text":"Ifinis set to a group other than thegroup account, change the mode of the audit log files with the following command:Otherwise, change the mode of the audit log files with the following command:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nif LC_ALL=C grep -iw ^log_file /etc/audit/auditd.conf; then\n  DIR=$(awk -F \"=\" '/^log_file/ {print $2}' /etc/audit/auditd.conf | tr -d ' ' | rev | cut -d\"/\" -f2- | rev)\nelse\n  DIR=\"/var/log/audit\"\nfi\n\n\nif LC_ALL=C grep -m 1 -q ^log_group /etc/audit/auditd.conf; then\n  GROUP=$(awk -F \"=\" '/log_group/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\n  if ! [ \"${GROUP}\" == 'root' ] ; then\n    chmod 0750 $DIR\n  else\n    chmod 0700 $DIR\n  fi\nelse\n  chmod 0700 $DIR\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIf users can write to audit logs, audit trails can be modified or destroyed."},"shortDescription":{"text":"System Audit Logs Must Have Mode 0750 or Less Permissive."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_group_ownership_var_log_audit","name":"SystemAuditLogsMustBeGroupOwnedByRoot","fullDescription":{"text":"All audit logs must be group owned by root user. The path for audit log can\nbe configured viaparameter inor, by default, the path for audit log is.\n\nTo properly set the group owner of, run the command:Ifinis set to a group other\nthan thegroup account, change the group ownership of the audit logs\nto this specific group."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nif LC_ALL=C grep -iw log_file /etc/audit/auditd.conf; then\n  FILE=$(awk -F \"=\" '/^log_file/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\nelse\n  FILE=\"/var/log/audit/audit.log\"\nfi\n\n\nif LC_ALL=C grep -m 1 -q ^log_group /etc/audit/auditd.conf; then\n  GROUP=$(awk -F \"=\" '/log_group/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\n    if ! [ \"${GROUP}\" == 'root' ]; then\n      chgrp ${GROUP} $FILE*\n    else\n      chgrp root $FILE*\n    fi\nelse\n  chgrp root $FILE*\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nUnauthorized disclosure of audit records can reveal system and configuration data to\nattackers, thus compromising its confidentiality."},"shortDescription":{"text":"System Audit Logs Must Be Group Owned By Root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupownership_audit_configuration","name":"AuditConfigurationFilesMustBeOwnedByGroupRoot","fullDescription":{"text":"All audit configuration files must be owned by group root."},"help":{"text":"rationale:\nWithout the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able\nto prevent the auditing of critical events.\nMisconfigured audits may degrade the system's performance by\noverwhelming the audit log. Misconfigured audits may also make it more\ndifficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one."},"shortDescription":{"text":"Audit Configuration Files Must Be Owned By Group root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_audit_configuration","name":"AuditConfigurationFilesMustBeOwnedByRoot","fullDescription":{"text":"All audit configuration files must be owned by root user.\n\nTo properly set the owner of, run the command:To properly set the owner of, run the command:."},"help":{"text":"rationale:\nWithout the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able\nto prevent the auditing of critical events.\nMisconfigured audits may degrade the system's performance by\noverwhelming the audit log. Misconfigured audits may also make it more\ndifficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one."},"shortDescription":{"text":"Audit Configuration Files Must Be Owned By Root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit","name":"SystemAuditLogsMustBeOwnedByRoot","fullDescription":{"text":"All audit logs must be owned by root user and group. By default, the path for audit log is.\n\nTo properly set the owner of, run the command:To properly set the owner of, run the command:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nif LC_ALL=C grep -m 1 -q ^log_group /etc/audit/auditd.conf; then\n  GROUP=$(awk -F \"=\" '/log_group/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\n  if ! [ \"${GROUP}\" == 'root' ] ; then\n    chown root:${GROUP} /var/log/audit\n    chown root:${GROUP} /var/log/audit/audit.log*\n  else\n    chown root:root /var/log/audit\n    chown root:root /var/log/audit/audit.log*\n  fi\nelse\n  chown root:root /var/log/audit\n  chown root:root /var/log/audit/audit.log*\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nUnauthorized disclosure of audit records can reveal system and configuration data to\nattackers, thus compromising its confidentiality."},"shortDescription":{"text":"System Audit Logs Must Be Owned By Root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_var_log_audit_stig","name":"SystemAuditLogsMustBeOwnedByRoot","fullDescription":{"text":"All audit logs must be owned by root user. The path for audit log can be\nconfigured viaparameter inor by default, the path for audit log is.\n\nTo properly set the owner of, run the command:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nif LC_ALL=C grep -iw log_file /etc/audit/auditd.conf; then\n    FILE=$(awk -F \"=\" '/^log_file/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\n    chown root $FILE*\nelse\n    chown root /var/log/audit/audit.log*\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nUnauthorized disclosure of audit records can reveal system and configuration data to\nattackers, thus compromising its confidentiality."},"shortDescription":{"text":"System Audit Logs Must Be Owned By Root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_audit_configuration","name":"AuditConfigurationFilesPermissionsAre640OrMoreRestrictive","fullDescription":{"text":"All audit configuration files permissions must be 640 or more restrictive."},"help":{"text":"rationale:\nWithout the capability to restrict which roles and individuals can\nselect which events are audited, unauthorized personnel may be able\nto prevent the auditing of critical events.\nMisconfigured audits may degrade the system's performance by\noverwhelming the audit log. Misconfigured audits may also make it more\ndifficult to establish, correlate, and investigate the events relating\nto an incident or identify those responsible for one."},"shortDescription":{"text":"Audit Configuration Files Permissions are 640 or More Restrictive."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_var_log_audit","name":"SystemAuditLogsMustHaveMode0640OrLessPermissive","fullDescription":{"text":"Ifinis set to a group other than thegroup account, change the mode of the audit log files with the following command:Otherwise, change the mode of the audit log files with the following command:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nif LC_ALL=C grep -iw ^log_file /etc/audit/auditd.conf; then\n    FILE=$(awk -F \"=\" '/^log_file/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\nelse\n    FILE=\"/var/log/audit/audit.log\"\nfi\n\n\nif LC_ALL=C grep -m 1 -q ^log_group /etc/audit/auditd.conf; then\n  GROUP=$(awk -F \"=\" '/log_group/ {print $2}' /etc/audit/auditd.conf | tr -d ' ')\n  if ! [ \"${GROUP}\" == 'root' ] ; then\n    chmod 0640 $FILE\n    chmod 0440 $FILE.*\n  else\n    chmod 0600 $FILE\n    chmod 0400 $FILE.*\n  fi\nelse\n  chmod 0600 $FILE\n  chmod 0400 $FILE.*\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIf users can write to audit logs, audit trails can be modified or destroyed."},"shortDescription":{"text":"System Audit Logs Must Have Mode 0640 or Less Permissive."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_audispd_configure_remote_server","name":"ConfigureAudispdPluginToSendLogsToRemoteServer","fullDescription":{"text":"Configure the audispd plugin to off-load audit records onto a different\nsystem or media from the system being audited.\n\nFirst, set theoption inSet theoption inwith an IP address or hostname of the system that the audispd plugin should\nsend audit records to. For example."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_audispd_remote_server=''\n\n\nAUDITCONFIG=/etc/audit/audisp-remote.conf\n\n\nAUREMOTECONFIG=/etc/audisp/plugins.d/au-remote.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^active\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"yes\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^active\\\\>\" \"$AUREMOTECONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^active\\\\>.*/$escaped_formatted_output/gi\" \"$AUREMOTECONFIG\"\nelse\n    if [[ -s \"$AUREMOTECONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUREMOTECONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUREMOTECONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUREMOTECONFIG\"\nfi\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^remote_server\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_audispd_remote_server\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^remote_server\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^remote_server\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nInformation stored in one location is vulnerable to accidental or incidental\ndeletion or alteration.Off-loading is a common process in information systems\nwith limited audit storage capacity."},"shortDescription":{"text":"Configure audispd Plugin To Send Logs To Remote Server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_audispd_configure_sufficiently_large_partition","name":"ConfigureASufficientlyLargePartitionForAuditLogs","fullDescription":{"text":"The Ubuntu 22.04 operating system must allocate audit record storage\ncapacity to store at least one weeks worth of audit records when audit\nrecords are not immediately sent to a central audit record storage\nfacility.\n\nThe partition size needed to capture a week's worth of audit records is\nbased on the activity level of the system and the total storage capacity\navailable. In normal circumstances, 10.0 GB of storage space for audit\nrecords will be sufficient.\n\nDetermine which partition the audit records are being written to with the\nfollowing command:Check the size of the partition that audit records are written to with the\nfollowing command:."},"help":{"text":"check:\nocil:ssg-auditd_audispd_configure_sufficiently_large_partition_ocil:questionnaire:1\nrationale:\nInformation stored in one location is vulnerable to accidental or incidental\ndeletion or alteration. Off-loading is a common process in information\nsystems with limited audit storage capacity."},"shortDescription":{"text":"Configure a Sufficiently Large Partition for Audit Logs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_audispd_syslog_plugin_activated","name":"ConfigureAuditdToUseAudispd'sSyslogPlugin","fullDescription":{"text":"To configure theservice to use theplug-in of theaudit event multiplexor, set\ntheline into.\nRestart theservice:."},"help":{"text":"rationale:\nThe auditd service does not include the ability to send audit\nrecords to a centralized server for management directly. It does, however,\ninclude a plug-in for audit event multiplexor (audispd) to pass audit records\nto the local syslog server."},"shortDescription":{"text":"Configure auditd to use audispd's syslog plugin."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-3 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_disk_error_action","name":"ConfigureAuditdDiskErrorActionOnDiskError","fullDescription":{"text":"Theservice can be configured to take an action\nwhen there is a disk error.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"help":{"text":"rationale:\nTaking appropriate action in case of disk errors will minimize the possibility of\nlosing audit records."},"shortDescription":{"text":"Configure auditd Disk Error Action on Disk Error."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_disk_error_action_stig","name":"ConfigureAuditdDiskErrorActionOnDiskError","fullDescription":{"text":"Theservice can be configured to take an action\nwhen there is a disk error.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"help":{"text":"rationale:\nTaking appropriate action in case of disk errors will minimize the possibility of\nlosing audit records."},"shortDescription":{"text":"Configure auditd Disk Error Action on Disk Error."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_disk_full_action","name":"ConfigureAuditdDiskFullActionWhenDiskSpaceIsFull","fullDescription":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_disk_full_action=''\n\n\nvar_auditd_disk_full_action=\"$(echo $var_auditd_disk_full_action | cut -d \\| -f 1)\"\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^disk_full_action\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_disk_full_action\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^disk_full_action\\\\>\" \"/etc/audit/auditd.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^disk_full_action\\\\>.*/$escaped_formatted_output/gi\" \"/etc/audit/auditd.conf\"\nelse\n    if [[ -s \"/etc/audit/auditd.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/audit/auditd.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/audit/auditd.conf\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/audit/auditd.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nTaking appropriate action in case of a filled audit storage volume will minimize\nthe possibility of losing audit records."},"shortDescription":{"text":"Configure auditd Disk Full Action when Disk Space Is Full."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_disk_full_action_stig","name":"ConfigureAuditdDiskFullActionWhenDiskSpaceIsFull","fullDescription":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single-user\nmode for corrective action. Acceptable values also include,, and. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_disk_full_action=''\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^disk_full_action\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_disk_full_action\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^disk_full_action\\\\>\" \"/etc/audit/auditd.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^disk_full_action\\\\>.*/$escaped_formatted_output/gi\" \"/etc/audit/auditd.conf\"\nelse\n    if [[ -s \"/etc/audit/auditd.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/audit/auditd.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/audit/auditd.conf\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/audit/auditd.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nTaking appropriate action in case of a filled audit storage volume will minimize\nthe possibility of losing audit records."},"shortDescription":{"text":"Configure auditd Disk Full Action when Disk Space Is Full."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_action_mail_acct","name":"ConfigureAuditdMail_acctActionOnLowDiskSpace","fullDescription":{"text":"Theservice can be configured to send email to\na designated account in certain situations. Add or correct the following line\ninto ensure that administrators are notified\nvia email for those situations:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_action_mail_acct=''\n\n\nAUDITCONFIG=/etc/audit/auditd.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^action_mail_acct\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_action_mail_acct\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^action_mail_acct\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^action_mail_acct\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nEmail sent to the root account is typically aliased to the\nadministrators of the system, who can take appropriate action."},"shortDescription":{"text":"Configure auditd mail_acct Action on Low Disk Space."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_action","name":"ConfigureAuditdAdmin_space_leftActionOnLowDiskSpace","fullDescription":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to switch to single user\nmode for corrective action. Acceptable values also includeand. For certain systems, the need for availability\noutweighs the need to log all actions, and a different setting should be\ndetermined. Details regarding all possible values forare described in theman page."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_admin_space_left_action=''\n\n\nAUDITCONFIG=/etc/audit/auditd.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^admin_space_left_action\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_admin_space_left_action\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^admin_space_left_action\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^admin_space_left_action\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAdministrators should be made aware of an inability to record\naudit records. If a separate partition or logical volume of adequate size\nis used, running low on space for audit records should never occur."},"shortDescription":{"text":"Configure auditd admin_space_left Action on Low Disk Space."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_admin_space_left_percentage","name":"ConfigureAuditdAdmin_space_leftOnLowDiskSpace","fullDescription":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value toto cause the system to perform an action."},"help":{"text":"rationale:\nNotifying administrators of an impending disk space problem may allow them to\ntake corrective action prior to any disruption."},"shortDescription":{"text":"Configure auditd admin_space_left on Low Disk Space."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file","name":"ConfigureAuditdMaxLogFileSize","fullDescription":{"text":"Determine the amount of audit data (in megabytes)\nwhich should be retained in each log file. Edit the file. Add or modify the following line, substituting\nthe correct value offor:Set the value to(MB) or higher for general-purpose systems.\nLarger values, of course,\nsupport retention of even more audit data."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_max_log_file=''\n\n\nAUDITCONFIG=/etc/audit/auditd.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^max_log_file\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_max_log_file\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^max_log_file\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^max_log_file\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe total storage for audit log files must be large enough to retain\nlog information over the period required. This is a function of the maximum\nlog file size and the number of logs retained."},"shortDescription":{"text":"Configure auditd Max Log File Size."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action","name":"ConfigureAuditdMax_log_file_actionUponReachingMaximumLogSize","fullDescription":{"text":"The default action to take when the logs reach their maximum size\nis to rotate the log files, discarding the oldest one. To configure the action taken\nby, add or correct the line in:Possible values forare described in theman\npage. These include:Set thetoto ensure log rotation\noccurs. This is the default. The setting is case-insensitive."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_max_log_file_action=''\n\n\nAUDITCONFIG=/etc/audit/auditd.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^max_log_file_action\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_max_log_file_action\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^max_log_file_action\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^max_log_file_action\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAutomatically rotating logs (by setting this to)\nminimizes the chances of the system unexpectedly running out of disk space by\nbeing overwhelmed with log data. However, for systems that must never discard\nlog data, or which use external processes to transfer it and reclaim space,can be employed."},"shortDescription":{"text":"Configure auditd max_log_file_action Upon Reaching Maximum Log Size."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_max_log_file_action_stig","name":"ConfigureAuditdMax_log_file_actionUponReachingMaximumLogSize","fullDescription":{"text":"The default action to take when the logs reach their maximum size\nis to rotate the log files, discarding the oldest one. To configure the action taken\nby, add or correct the line in:Possible values forare described in theman\npage. These include:Set thetoto ensure log rotation\noccurs. This is the default. The setting is case-insensitive."},"help":{"text":"rationale:\nAutomatically rotating logs (by setting this to)\nminimizes the chances of the system unexpectedly running out of disk space by\nbeing overwhelmed with log data. However, for systems that must never discard\nlog data, or which use external processes to transfer it and reclaim space,can be employed."},"shortDescription":{"text":"Configure auditd max_log_file_action Upon Reaching Maximum Log Size."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_num_logs","name":"ConfigureAuditdNumberOfLogsRetained","fullDescription":{"text":"Determine how many log filesshould retain when it rotates logs.\nEdit the file. Add or modify the following\nline, substitutingwith the correct value of:Set the value to 5 for general-purpose systems.\nNote that values less than 2 result in no log rotation."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_num_logs=''\n\n\nAUDITCONFIG=/etc/audit/auditd.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^num_logs\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_num_logs\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^num_logs\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^num_logs\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThe total storage for audit log files must be large enough to retain\nlog information over the period required. This is a function of the maximum log\nfile size and the number of logs retained."},"shortDescription":{"text":"Configure auditd Number of Logs Retained."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_action","name":"ConfigureAuditdSpace_leftActionOnLowDiskSpace","fullDescription":{"text":"Theservice can be configured to take an action\nwhen disk spaceto run low.\nEdit the file. Modify the following line,\nsubstitutingappropriately:Possible values forare described in theman page.\nThese include:Set this to(instead of the default,\nwhich is) as it is more likely to get prompt attention. Acceptable values\nalso include,, and."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && dpkg-query --show --showformat='${db:Status-Status}\\n' 'auditd' 2>/dev/null | grep -q installed; then\n\nvar_auditd_space_left_action=''\n\n\n#\n# If space_left_action present in /etc/audit/auditd.conf, change value\n# to var_auditd_space_left_action, else\n# add \"space_left_action = $var_auditd_space_left_action\" to /etc/audit/auditd.conf\n#\n\nAUDITCONFIG=/etc/audit/auditd.conf\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^space_left_action\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s = %s\" \"$stripped_key\" \"$var_auditd_space_left_action\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^space_left_action\\\\>\" \"$AUDITCONFIG\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^space_left_action\\\\>.*/$escaped_formatted_output/gi\" \"$AUDITCONFIG\"\nelse\n    if [[ -s \"$AUDITCONFIG\" ]] && [[ -n \"$(tail -c 1 -- \"$AUDITCONFIG\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"$AUDITCONFIG\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"$AUDITCONFIG\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nNotifying administrators of an impending disk space problem may\nallow them to take corrective action prior to any disruption."},"shortDescription":{"text":"Configure auditd space_left Action on Low Disk Space."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_data_retention_space_left_percentage","name":"ConfigureAuditdSpace_leftOnLowDiskSpace","fullDescription":{"text":"Theservice can be configured to take an action\nwhen disk space is running low but prior to running out of space completely.\nEdit the file. Add or modify the following line,\nsubstitutingappropriately:Set this value to at least 25 to cause the system to\nnotify the user of an issue."},"help":{"text":"rationale:\nNotifying administrators of an impending disk space problem may allow them to\ntake corrective action prior to any disruption."},"shortDescription":{"text":"Configure auditd space_left on Low Disk Space."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_freq","name":"SetNumberOfRecordsToCauseAnExplicitFlushToAuditLogs","fullDescription":{"text":"To configure Audit daemon to issue an explicit flush to disk command\nafter writingrecords, settoin."},"help":{"text":"rationale:\nIf optionisn't set to, the flush to disk\nmay happen after higher number of records, increasing the danger\nof audit loss."},"shortDescription":{"text":"Set number of records to cause an explicit flush to audit logs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_local_events","name":"IncludeLocalEventsInAuditLogs","fullDescription":{"text":"To configure Audit daemon to include local events in Audit logs, settoin.\nThis is the default setting."},"help":{"text":"rationale:\nIf optionisn't set toonly events from\nnetwork will be aggregated."},"shortDescription":{"text":"Include Local Events in Audit Logs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_log_format","name":"ResolveInformationBeforeWritingToAuditLogs","fullDescription":{"text":"To configure Audit daemon to resolve all uid, gid, syscall,\narchitecture, and socket address information before writing the\nevents to disk, settoin."},"help":{"text":"rationale:\nIf optionisn't set to, the\naudit records will be stored in a format exactly as the kernel sends them."},"shortDescription":{"text":"Resolve information before writing to audit logs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_name_format","name":"SetHostnameAsComputerNodeNameInAuditLogs","fullDescription":{"text":"To configure Audit daemon to use value returned by gethostname\nsyscall as computer node name in the audit events,\nsettoin."},"help":{"text":"rationale:\nIf optionis left at its default value of, audit events from different computers may be hard\nto distinguish."},"shortDescription":{"text":"Set hostname as computer node name in audit logs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_offload_logs","name":"OffloadAuditLogsToExternalMedia","fullDescription":{"text":"The operating system must have a crontab script running weekly to\noffload audit events of standalone systems."},"help":{"text":"rationale:\nInformation stored in one location is vulnerable to accidental or\nincidental deletion or alteration.\nOffloading is a common process in information systems with limited\naudit storage capacity.\nwarning:\nDue to different needs and possibilities, automated remediation is not\navailable for this configuration check."},"shortDescription":{"text":"Offload audit Logs to External Media."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_overflow_action","name":"AppropriateActionMustBeSetupWhenTheInternalAuditEventQueueIsFull","fullDescription":{"text":"The audit system should have an action setup in the event the internal event queue becomes full.\nTo setup an overflow action edit. Setto one of the following values:,,."},"help":{"text":"rationale:\nThe audit system should have an action setup in the event the internal event queue becomes full\nso that no data is lost."},"shortDescription":{"text":"Appropriate Action Must be Setup When the Internal Audit Event Queue is Full."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_auditd_write_logs","name":"WriteAuditLogsToTheDisk","fullDescription":{"text":"To configure Audit daemon to write Audit logs to the disk, settoin.\nThis is the default setting."},"help":{"text":"rationale:\nIfisn't set to, the Audit logs will\nnot be written to the disk."},"shortDescription":{"text":"Write Audit Logs to the Disk."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_audit-audispd-plugins_installed","name":"EnsureTheDefaultPluginsForTheAuditDispatcherAreInstalled","fullDescription":{"text":"The audit-audispd-plugins package should be installed."},"help":{"text":"rationale:\nInformation stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity."},"shortDescription":{"text":"Ensure the default plugins for the audit dispatcher are Installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_audit_installed","name":"EnsureTheAuditSubsystemIsInstalled","fullDescription":{"text":"The audit package should be installed."},"help":{"text":"rationale:\nThe auditd service is an access monitoring and accounting daemon, watching system calls to audit any access, in comparison with potential local access control policy such as SELinux policy."},"shortDescription":{"text":"Ensure the audit Subsystem is Installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-14","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-14 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 d","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 e","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-6 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_auditd_enabled","name":"EnableAuditdService","fullDescription":{"text":"Theservice is an essential userspace component of\nthe Linux Auditing System, as it is responsible for writing audit records to\ndisk.\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nWithout establishing what type of events occurred, it would be difficult\nto establish, correlate, and investigate the events leading up to an outage or attack.\nEnsuring theservice is active ensures audit records\ngenerated by the kernel are appropriately recorded.Additionally, a properly configured audit subsystem ensures that actions of\nindividual system users can be uniquely traced to those users so they\ncan be held accountable for their actions."},"shortDescription":{"text":"Enable auditd Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-2 g.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (9)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-14 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-2 d.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 d","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 e","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-6 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-4 (23)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_audit_argument","name":"EnableAuditingForProcessesWhichStartPriorToTheAuditDaemon","fullDescription":{"text":"To ensure all processes can be audited, even those which start\nprior to the audit daemon, add the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nEach process on the system carries an \"auditable\" flag which indicates whether\nits activities can be audited. Althoughtakes care of enabling\nthis for all processes which launch after it does, adding the kernel argument\nensures it is set for every process during boot."},"shortDescription":{"text":"Enable Auditing for Processes Which Start Prior to the Audit Daemon."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-14 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IR-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_audit_backlog_limit_argument","name":"ExtendAuditBacklogLimitForTheAuditDaemon","fullDescription":{"text":"To improve the kernel capacity to queue all log events, even those which occurred\nprior to the audit daemon, add the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\naudit_backlog_limit sets the queue length for audit events awaiting transfer\nto the audit daemon. Until the audit daemon is up and running, all log messages\nare stored in this queue.  If the queue is overrun during boot process, the action\ndefined by audit failure flag is taken."},"shortDescription":{"text":"Extend Audit Backlog Limit for the Audit Daemon."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-3 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_apparmor_installed","name":"EnsureAppArmorIsInstalled","fullDescription":{"text":"AppArmor provide Mandatory Access Controls."},"help":{"text":"check:\noval:ssg-package_apparmor_installed:def:1\nrationale:\nWithout a Mandatory Access Control system installed only the default\nDiscretionary Access Control system will be available."},"shortDescription":{"text":"Ensure AppArmor is installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (10)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (5) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_all_apparmor_profiles_enforced","name":"EnforceAllAppArmorProfiles","fullDescription":{"text":"AppArmor profiles define what resources applications are able to access.\nTo set all profiles to enforce mode run the following command:To list unconfined processes run the following command:Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# make sure apparmor-utils is installed for aa-complain and aa-enforce\nDEBIAN_FRONTEND=noninteractive apt-get install -y \"apparmor-utils\"\n\n# Ensure all AppArmor Profiles are enforcing\napparmor_parser -q -r /etc/apparmor.d/\naa-enforce /etc/apparmor.d/*\n\n\nUNCONFINED=$(aa-status | grep \"processes are unconfined\" | awk '{print $1;}')\nif [ $UNCONFINED -ne 0 ];\n\nthen\n  echo -e \"***WARNING***: There are some unconfined processes:\"\n  echo -e \"----------------------------\"\n  echo \"The may need to have a profile created or activated for them and then be restarted.\"\n  for PROCESS in \"${UNCONFINED[@]}\"\n  do\n      echo \"$PROCESS\"\n  done\n  echo -e \"----------------------------\"\n  echo \"The may need to have a profile created or activated for them and then be restarted.\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nSecurity configuration requirements vary from site to site. Some sites may\nmandate a policy that is stricter than the default policy, which is perfectly\nacceptable. This recommendation is intended to ensure that any policies that\nexist on the system are activated."},"shortDescription":{"text":"Enforce all AppArmor Profiles."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_all_apparmor_profiles_in_enforce_complain_mode","name":"AllAppArmorProfilesAreInEnforceOrComplainMode","fullDescription":{"text":"AppArmor profiles define what resources applications are able to access.\nTo set all profiles to eitherormode\nrun the following command to set all profiles tomode:run the following command to set all profiles tomode:To list unconfined processes run the following command:Any unconfined processes may need to have a profile created or activated\nfor them and then be restarted."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nvar_apparmor_mode=''\n\n\n# make sure apparmor-utils is installed for aa-complain and aa-enforce\nDEBIAN_FRONTEND=noninteractive apt-get install -y \"apparmor-utils\"\n\n# Reload all AppArmor profiles\napparmor_parser -q -r /etc/apparmor.d/\n\n# Set the mode\nAPPARMOR_MODE=\"$var_apparmor_mode\"\n\nif [ \"$APPARMOR_MODE\" = \"enforce\" ]\nthen\n  # Set all profiles to enforce mode\n  aa-enforce /etc/apparmor.d/*\nfi\n\nif [ \"$APPARMOR_MODE\" = \"complain\" ]\nthen\n  # Set all profiles to complain mode\n  aa-complain /etc/apparmor.d/*\nfi\n\n\nUNCONFINED=$(aa-status | grep \"processes are unconfined\" | awk '{print $1;}')\nif [ $UNCONFINED -ne 0 ];\n\nthen\n  echo -e \"***WARNING***: There are some unconfined processes:\"\n  echo -e \"----------------------------\"\n  echo \"The may need to have a profile created or activated for them and then be restarted.\"\n  for PROCESS in \"${UNCONFINED[@]}\"\n  do\n      echo \"$PROCESS\"\n  done\n  echo -e \"----------------------------\"\n  echo \"The may need to have a profile created or activated for them and then be restarted.\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nSecurity configuration requirements vary from site to site. Some sites may\nmandate a policy that is stricter than the default policy, which is perfectly\nacceptable. This recommendation is intended to ensure that any policies that\nexist on the system are activated."},"shortDescription":{"text":"All AppArmor Profiles are in enforce or complain mode."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_apparmor_configured","name":"EnsureAppArmorIsActiveAndConfigured","fullDescription":{"text":"Verify that the Apparmor tool is configured to\ncontrol whitelisted applications and user home directory access\ncontrol.Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nUsing a whitelist provides a configuration management method for allowing\nthe execution of only authorized software. Using only authorized software\ndecreases risk by limiting the number of potential vulnerabilities.The organization must identify authorized software programs and permit\nexecution of authorized software by adding each authorized program to the\n\"pam_apparmor\" exception policy. The process used to identify software\nprograms that are authorized to execute on organizational information\nsystems is commonly referred to as whitelisting.Verification of whitelisted software occurs prior to execution or at system\nstartup.Users' home directories/folders may contain information of a sensitive\nnature. Nonprivileged users should coordinate any sharing of information\nwith a System Administrator (SA) through shared resources.Apparmor can confine users to their home directory, not allowing them to\nmake any changes outside of their own home directories. Confining users to\ntheir home directory will minimize the risk of sharing information."},"shortDescription":{"text":"Ensure AppArmor is Active and Configured."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (10)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (8)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (5) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (5) b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (21)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_enable_apparmor","name":"EnsureAppArmorIsEnabledInTheBootloaderConfiguration","fullDescription":{"text":"Configure AppArmor to be enabled at boot time and verify that it has not been\noverwritten by the bootloader boot parameters.\n\nNote: This recommendation is designed around the grub bootloader, if LILO or\nanother bootloader is in use in your environment, enact equivalent settings."},"help":{"text":"check:\noval:ssg-grub2_enable_apparmor:def:1\nfix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\n# Correct the form of default kernel command line in GRUB\nif grep -q '^GRUB_CMDLINE_LINUX=.*apparmor=.*\"'  '/etc/default/grub' ; then\n       # modify the GRUB command-line if an apparmor= arg already exists\n       sed -i \"s/\\(^GRUB_CMDLINE_LINUX=\\\".*\\)apparmor=[^[:space:]]\\+\\(.*\\\"\\)/\\1apparmor=1\\2/\"  '/etc/default/grub'\nelse\n       # no apparmor=arg is present, append it\n       sed -i \"s/\\(^GRUB_CMDLINE_LINUX=\\\".*\\)\\\"/\\1 apparmor=1\\\"/\"  '/etc/default/grub'\nfi\n# Correct the form of default kernel command line in GRUB\nif grep -q '^GRUB_CMDLINE_LINUX=.*security=.*\"'  '/etc/default/grub' ; then\n       # modify the GRUB command-line if an security= arg already exists\n       sed -i \"s/\\(^GRUB_CMDLINE_LINUX=\\\".*\\)security=[^[:space:]]\\+\\(.*\\\"\\)/\\1security=apparmor\\2/\"  '/etc/default/grub'\nelse\n       # no security=arg is present, append it\n       sed -i \"s/\\(^GRUB_CMDLINE_LINUX=\\\".*\\)\\\"/\\1 security=apparmor\\\"/\"  '/etc/default/grub'\nfi\n\n\nupdate-grub\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nAppArmor must be enabled at boot time in your bootloader configuration to\nensure that the controls it provides are not overridden."},"shortDescription":{"text":"Ensure AppArmor is enabled in the bootloader configuration."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_grub2_cfg","name":"Verify/boot/grub/grub.cfgUserOwnership","fullDescription":{"text":"The fileshould\nbe owned by theuser to prevent destruction\nor modification of the file.\n\nTo properly set the owner of, run the command:."},"help":{"text":"rationale:\nOnly root should be able to modify important boot parameters."},"shortDescription":{"text":"Verify /boot/grub/grub.cfg User Ownership."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_grub2_cfg","name":"Verify/boot/grub/grub.cfgPermissions","fullDescription":{"text":"File permissions forshould be set to 600.\n\nTo properly set the permissions of, run the command:."},"help":{"text":"rationale:\nProper permissions ensure that only the root user can modify important boot\nparameters."},"shortDescription":{"text":"Verify /boot/grub/grub.cfg Permissions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_password","name":"SetBootLoaderPasswordInGrub2","fullDescription":{"text":"The grub2 boot loader should have a superuser account and password\nprotection enabled to protect boot-time settings.Since plaintext passwords are a security risk, generate a hash for the password\nby running the following command:When prompted, enter the password that was selected.Using the hash from the output, modify thefile with the following content:NOTE: the bootloader superuser account and password MUST differ from the\nroot account and password.\nOnce the superuser password has been added,\nupdate thefile by running:."},"help":{"text":"rationale:\nPassword protection on the boot loader configuration ensures\nusers with physical access cannot trivially alter\nimportant bootloader settings. These include which kernel to use,\nand whether to enter single-user mode.\nwarning:\nTo prevent hard-coded passwords, automatic remediation of this control is not available. Remediation\nmust be automated as a component of machine provisioning, or followed manually as outlined above.\n\nAlso, do NOT manually add the superuser account and password to thefile as the grub2-mkconfig command overwrites this file."},"shortDescription":{"text":"Set Boot Loader Password in grub2."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_uefi_password","name":"SetTheUEFIBootLoaderPassword","fullDescription":{"text":"The grub2 boot loader should have a superuser account and password\nprotection enabled to protect boot-time settings.Since plaintext passwords are a security risk, generate a hash for the password\nby running the following command:When prompted, enter the password that was selected.Using the hash from the output, modify thefile with the following content:NOTE: the bootloader superuser account and password MUST differ from the\nroot account and password.\nOnce the superuser password has been added,\nupdate thefile by running:."},"help":{"text":"rationale:\nPassword protection on the boot loader configuration ensures\nusers with physical access cannot trivially alter\nimportant bootloader settings. These include which kernel to use,\nand whether to enter single-user mode.\nwarning:\nTo prevent hard-coded passwords, automatic remediation of this control is not available. Remediation\nmust be automated as a component of machine provisioning, or followed manually as outlined above.\n\nAlso, do NOT manually add the superuser account and password to thefile as the grub2-mkconfig command overwrites this file."},"shortDescription":{"text":"Set the UEFI Boot Loader Password."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_disable_recovery","name":"DisableRecoveryBooting","fullDescription":{"text":"Ubuntu 22.04 systems support an \"recovery boot\" option that can be used\nto prevent services from being started. Theconfiguration option inshould be set toto disable the generation of recovery mode menu entries. It is\nalso required to change the runtime configuration, run:."},"help":{"text":"rationale:\nUsing recovery boot, the console user could disable auditing, firewalls,\nor other services, weakening system security."},"shortDescription":{"text":"Disable Recovery Booting."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_enable_iommu_force","name":"IOMMUConfigurationDirective","fullDescription":{"text":"On x86 architecture supporting VT-d, the IOMMU manages the access control policy between the hardware devices and some\n    of the system critical units such as the memory.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nOn x86 architectures, activating the I/OMMU prevents the system from arbitrary accesses potentially made by\n    hardware devices.\nwarning:\nDepending on the hardware, devices and operating system used, enabling IOMMU can cause hardware instabilities. Proper function and stability should be assessed before applying remediation to production systems."},"shortDescription":{"text":"IOMMU configuration directive."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_l1tf_argument","name":"ConfigureL1TerminalFaultMitigations","fullDescription":{"text":"L1 Terminal Fault (L1TF) is a hardware vulnerability which allows unprivileged\nspeculative access to data which is available in the Level 1 Data Cache when\nthe page table entry isn't present.\n\nSelect the appropriate mitigation by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:Since Linux Kernel 4.19 you can check the L1TF vulnerability state with the\nfollowing command:."},"help":{"text":"rationale:\nThe L1TF vulnerability allows an attacker to bypass memory access security controls imposed\nby the system or hypervisor. The L1TF vulnerability allows read access to any physical memory\nlocation that is cached in the L1 Data Cache.\nwarning:\nEnabling L1TF mitigations may impact performance of the system."},"shortDescription":{"text":"Configure L1 Terminal Fault mitigations."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_mce_argument","name":"ForceKernelPanicOnUncorrectedMCEs","fullDescription":{"text":"A Machine Check Exception is an error generated by the CPU itdetects an error\nin itself, memory or I/O devices.\nThese errors may be corrected and generate a check log entry, if an error\ncannot be corrected the kernel may panic or SIGBUS.\n\nTo force the kernel to panic on any uncorrected error reported by Machine Check\nset the MCE tolerance to zero by addingto the default GRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nAllowing uncorrected errors to result on a SIGBUS may allow an attacker to continue\ntrying to exploit a vulnerability such as Rowhammer."},"shortDescription":{"text":"Force kernel panic on uncorrected MCEs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_nosmap_argument_absent","name":"EnsureSMAPIsNotDisabledDuringBoot","fullDescription":{"text":"The SMAP is used to prevent the supervisor mode from unintentionally reading/writing into\nmemory pages in the user space, it is enabled by default since Linux kernel 3.7.\nBut it could be disabled through kernel boot parameters.\n\nEnsure that Supervisor Mode Access Prevention (SMAP) is not disabled by\ntheboot paramenter option.\n\nCheck that the linewithindoesn't contain the argument.\nRun the following command to update command line for already installed kernels:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'grub2-common' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Correct the form of default kernel command line in GRUB\nif grep -q '^GRUB_CMDLINE_LINUX=.*nosmap=.*\"'  '/etc/default/grub' ; then\n       sed -i 's/\\(^GRUB_CMDLINE_LINUX=\".*\\)nosmap=?[^[:space:]]*\\(.*\"\\)/\\1 \\2/' '/etc/default/grub'\nfi\nupdate-grub\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nDisabling SMAP can facilitate exploitation of vulnerabilities caused by unintended access and\nmanipulation of data in the user space."},"shortDescription":{"text":"Ensure SMAP is not disabled during boot."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_nosmep_argument_absent","name":"EnsureSMEPIsNotDisabledDuringBoot","fullDescription":{"text":"The SMEP is used to prevent the supervisor mode from executing user space code,\nit is enabled by default since Linux kernel 3.0. But it could be disabled through\nkernel boot parameters.\n\nEnsure that Supervisor Mode Execution Prevention (SMEP) is not disabled by\ntheboot paramenter option.\n\nCheck that the linewithindoesn't contain the argument.\nRun the following command to update command line for already installed kernels:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'grub2-common' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Correct the form of default kernel command line in GRUB\nif grep -q '^GRUB_CMDLINE_LINUX=.*nosmep=.*\"'  '/etc/default/grub' ; then\n       sed -i 's/\\(^GRUB_CMDLINE_LINUX=\".*\\)nosmep=?[^[:space:]]*\\(.*\"\\)/\\1 \\2/' '/etc/default/grub'\nfi\nupdate-grub\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nDisabling SMEP can facilitate exploitation of certain vulnerabilities because it allows\nthe kernel to unintentionally execute code in less privileged memory space."},"shortDescription":{"text":"Ensure SMEP is not disabled during boot."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_rng_core_default_quality_argument","name":"ConfigureTheConfidenceInTPMForEntropy","fullDescription":{"text":"The TPM security chip that is available in most modern systems has a hardware RNG.\nIt is also used to feed the entropy pool, but generally not credited entropy.\n\nUsein the kernel command line to set the trust\nlevel on the hardware generators. The trust level defines the amount of entropy to credit.\nA value oftells the system not to trust the hardware random number generators\navailable, and doesn't credit any entropy to the pool.\nA value ofassigns full confidence in the generators, and credits all the\nentropy it provides to the pool.\n\nNote that the value ofis global, affecting the trust\non all hardware random number generators.\n\nSelect the appropriate confidence by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nA system may struggle to initialize its entropy pool and end up starving. Crediting entropy\nfrom the hardware number generators available in the system helps fill up the entropy pool."},"shortDescription":{"text":"Configure the confidence in TPM for entropy."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_slab_nomerge_argument","name":"DisableMergingOfSlabsWithSimilarSize","fullDescription":{"text":"The kernel may merge similar slabs together to reduce overhead and increase\ncache hotness of objects.\nDisabling merging of slabs keeps the slabs separate and reduces the risk of\nkernel heap overflows overwriting objects in merged caches.\n\nTo disable merging of slabs in the Kernel add the argumentto the default GRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nDisabling the merge of slabs of similar sizes prevents the kernel from\nmerging a seemingly useless but vulnerable slab with a useful and valuable slab.\nThis increase the risk that a heap overflow could overwrite objects from merged caches,\nwith unmerged caches the heap overflow would only affect the objects in the same cache.\nOverall, this reduces the kernel attack surface area by isolating slabs from each other.\nwarning:\nDisabling merge of slabs will slightly increase kernel memory utilization."},"shortDescription":{"text":"Disable merging of slabs with similar size."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_spec_store_bypass_disable_argument","name":"ConfigureSpeculativeStoreBypassMitigation","fullDescription":{"text":"Certain CPUs are vulnerable to an exploit against a common wide industry wide performance\noptimization known as Speculative Store Bypass (SSB).\n\nIn such cases, recent stores to the same memory location cannot always be observed by later\nloads during speculative execution. However, such stores are unlikely and thus they can be\ndetected prior to instruction retirement at the end of a particular speculation execution\nwindow.\n\nSince Linux Kernel 4.17 you can check the SSB mitigation state with the following command:Select the appropriate SSB state by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nIn vulnerable processsors, the speculatively forwarded store can be used in a cache side channel\nattack. An example of this is reading memory to which the attacker does not directly have access,\nfor example inside the sandboxed code.\nwarning:\nDisabling Speculative Store Bypass may impact performance of the system."},"shortDescription":{"text":"Configure Speculative Store Bypass Mitigation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_spectre_v2_argument","name":"EnforceSpectreV2Mitigation","fullDescription":{"text":"Spectre V2 is an indirect branch poisoning attack that can lead to data leakage.\nAn exploit for Spectre V2 tricks the indirect branch predictor into executing\ncode from a future indirect branch chosen by the attacker, even if the privilege\nlevel is different.\n\nSince Linux Kernel 4.15 you can check the Spectre V2 mitigation state with the following command:Enforce the Spectre V2 mitigation by adding the argumentto the default\nGRUB 2 command line for the Linux operating system.\nTo ensure thatis added as a kernel command line\nargument to newly installed kernels, addto the\ndefault Grub2 command line for Linux operating systems. Modify the line withinas shown below:Run the following command to update command line for already installed kernels:."},"help":{"text":"rationale:\nThe Spectre V2 vulnerability allows an attacker to read memory that he should not have\naccess to."},"shortDescription":{"text":"Enforce Spectre v2 mitigation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_grub2_systemd_debug-shell_argument_absent","name":"EnsureDebug-shellServiceIsNotEnabledDuringBoot","fullDescription":{"text":"systemd'sservice is intended to\ndiagnose systemd related boot issues with variouscommands. Once enabled and following a system reboot, the root shell\nwill be available onwhich is access by pressing. Theservice should only be used\nfor systemd related issues and should otherwise be disabled.By default, thesystemd service is already disabled.\n\nEnsure the debug-shell is not enabled by theboot paramenter option.\n\nCheck that the linewithindoesn't contain the argument.\nRun the following command to update command line for already installed kernels:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif dpkg-query --show --showformat='${db:Status-Status}\\n' 'grub2-common' 2>/dev/null | grep -q installed && { [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; }; then\n\n# Correct the form of default kernel command line in GRUB\nif grep -q '^GRUB_CMDLINE_LINUX=.*systemd.debug-shell=.*\"'  '/etc/default/grub' ; then\n       sed -i 's/\\(^GRUB_CMDLINE_LINUX=\".*\\)systemd.debug-shell=?[^[:space:]]*\\(.*\"\\)/\\1 \\2/' '/etc/default/grub'\nfi\nupdate-grub\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThis prevents attackers with physical access from trivially bypassing security\non the machine through valid troubleshooting configurations and gaining root\naccess when the system is rebooted."},"shortDescription":{"text":"Ensure debug-shell service is not enabled during boot."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_zipl_audit_argument","name":"EnableAuditingToStartPriorToTheAuditDaemonInZIPL","fullDescription":{"text":"To ensure all processes can be audited, even those which start prior to the audit daemon,\ncheck that all boot entries inhaveincluded in its options.To ensure that new kernels and boot entries continue to enable audit,\naddto."},"help":{"text":"rationale:\nEach process on the system carries an \"auditable\" flag which indicates whether\nits activities can be audited. Althoughtakes care of enabling\nthis for all processes which launch after it does, adding the kernel argument\nensures it is set for every process during boot."},"shortDescription":{"text":"Enable Auditing to Start Prior to the Audit Daemon in zIPL."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_zipl_audit_backlog_limit_argument","name":"ExtendAuditBacklogLimitForTheAuditDaemonInZIPL","fullDescription":{"text":"To improve the kernel capacity to queue all log events, even those which start prior to the audit daemon,\ncheck that all boot entries inhaveincluded in its options.To ensure that new kernels and boot entries continue to extend the audit log events queue,\naddto."},"help":{"text":"rationale:\naudit_backlog_limit sets the queue length for audit events awaiting transfer\nto the audit daemon. Until the audit daemon is up and running, all log messages\nare stored in this queue.  If the queue is overrun during boot process, the action\ndefined by audit failure flag is taken."},"shortDescription":{"text":"Extend Audit Backlog Limit for the Audit Daemon in zIPL."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_disable_entropy_contribution_for_solid_state_drives","name":"EnsureSolidStateDrivesDoNotContributeToRandom-NumberEntropyPool","fullDescription":{"text":"For each solid-state drive on the system, run:."},"help":{"text":"rationale:\nIn contrast to traditional electromechanical magnetic disks, containing\nspinning disks and / or movable read / write heads, the solid-state storage\ndevices (SSDs) do not contain moving / mechanical components. Therefore the\nI/O operation completion times are much more predictable for them."},"shortDescription":{"text":"Ensure Solid State Drives Do Not Contribute To Random-Number Entropy Pool."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_acpi_custom_method","name":"DoNotAllowACPIMethodsToBeInserted/replacedAtRunTime","fullDescription":{"text":"This debug facility allows ACPI AML methods to be inserted and/or replaced without rebooting\nthe system.\nThis configuration is available from kernel 3.0.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nEnabling this feature allows arbitrary kernel memory to be written to by root (uid=0) users,\nallowing them to bypass certain security measures\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Do not allow ACPI methods to be inserted/replaced at run time."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_binfmt_misc","name":"DisableKernelSupportForMISCBinaries","fullDescription":{"text":"Enablingmakes it possible to plug wrapper-driven binary formats\ninto the kernel. This is specially useful for programs that need an interpreter to run like\nJava, Python and DOS emulators. Once you have registered such a binary class with the kernel,\nyou can start one of those programs simply by typing in its name at a shell prompt.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nThis disables arbitrary binary format support and helps reduce attack surface.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable kernel support for MISC binaries."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_bug","name":"EnableSupportForBUG()","fullDescription":{"text":"Disabling this option eliminates support for BUG and WARN, reducing the size of your kernel\nimage and potentially quietly ignoring numerous fatal conditions. You should only consider\ndisabling this option for embedded systems with no facilities for reporting errors.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nNot setting this variable may hide a number of critical errors.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable support for BUG()."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_compat_brk","name":"DisableCompatibilityWithBrk()","fullDescription":{"text":"Enabling compatiliby withallows legacy binaries to run (i.e. those linked\nagainst libc5). But this compatibility comes at the cost of not being able to randomize\nthe heap placement (ASLR).\n\nUnless legacy binaries need to run on the system, setto.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nEnabling compatibility with brk() disables support for ASLR.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable compatibility with brk()."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_compat_vdso","name":"DisableThe32-bitVDSO","fullDescription":{"text":"Certain buggy versions of glibc (2.3.3) will crash if they are presented with a 32-bit vDSO\nthat is not mapped at the address indicated in its segment table.\nSettingtoturns off the 32-bit VDSO and works\naroud the glibc bug.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nEnabling VDSO compatibility hurts performance and disables ASLR.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable the 32-bit vDSO."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_debug_credentials","name":"EnableChecksOnCredentialManagement","fullDescription":{"text":"Enable this to turn on some debug checking for credential management. The additional code keeps\ntrack of the number of pointers from task_structs to any given cred struct, and checks to see\nthat this number never exceeds the usage count of the cred struct.\n\nFurthermore, if SELinux is enabled, this also checks that the security pointer in the cred\nstruct is never seen to be invalid.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis adds sanity checks and validations to credential data structures.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable checks on credential management."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_debug_fs","name":"DisableKernelDebugfs","fullDescription":{"text":"is a virtual file system that kernel developers use to put debugging files\ninto. Enable this option to be able to read and write to these files.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nTo reduce the attack surface, this file system should be disabled if not in use.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable kernel debugfs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_debug_list","name":"EnableChecksOnLinkedListManipulation","fullDescription":{"text":"Enable this to turn on extended checks in the linked-list walking routines.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis add sanity checks to manipulation of linked lists structures in the kernel and may\nprevent exploits such as CVE-2017-1661, where a race condition and simultaneos operations\ncaused a list to corrupt.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable checks on linked list manipulation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_debug_notifiers","name":"EnableChecksOnNotifierCallChains","fullDescription":{"text":"Enable this to turn on sanity checking for notifier call chains. This is most useful for kernel\ndevelopers to make sure that modules properly unregister themselves from notifier chains.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis provides validation of notifier chains, it checks whether the notifiers are from the\nkernel or a module that is still loaded prior to being invoked.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable checks on notifier call chains."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_debug_sg","name":"EnableChecksOnScatter-gather(SG)TableOperations","fullDescription":{"text":"Scatter-gather tables are mechanism used for high performance I/O on DMA devices.\nEnable this to turn on checks on scatter-gather tables.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis can help find problems with drivers that do not properly initialize their SG tables.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable checks on scatter-gather (SG) table operations."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_default_mmap_min_addr","name":"ConfigureLowAddressSpaceToProtectFromUserAllocation","fullDescription":{"text":"This is the portion of low virtual memory which should be protected from userspace allocation.\nThis configuration is available from kernel 3.14, but may be available if backported\nby distros.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"65536\" should be returned."},"help":{"text":"rationale:\nKeeping a user from writing to low pages can help reduce the impact of kernel NULL pointer bugs.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Configure low address space to protect from user allocation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_devkmem","name":"Disable/dev/kmemVirtualDeviceSupport","fullDescription":{"text":"Disable support for the /dev/kmem device.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nThe /dev/kmem device is rarely used, but can be used for certain kind of kernel debugging\noperations.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable /dev/kmem virtual device support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_hibernation","name":"DisableHibernation","fullDescription":{"text":"Enable the suspend to disk (STD) functionality, which is usually called \"hibernation\" in user\ninterfaces. STD checkpoints the system and powers it off; and restores that checkpoint on\nreboot.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nSuspending to disk allows one to replace the running kernel.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable hibernation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_ia32_emulation","name":"DisableIA32Emulation","fullDescription":{"text":"Disables support for legacy 32-bit programs under a 64-bit kernel.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nDisabling 32-bit backwards compatibility helps reduce the attack surface."},"shortDescription":{"text":"Disable IA32 emulation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_ipv6","name":"DisableTheIPv6Protocol","fullDescription":{"text":"Disable support for IP version 6 (IPv6).\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nAny unnecessary network stacks, including IPv6, should be disabled to reduce\nthe vulnerability to exploitation.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable the IPv6 protocol."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_kexec","name":"DisableKexecSystemCall","fullDescription":{"text":"is a system call that implements the ability to shutdown your current kernel,\nand to start another kernel. It is like a reboot but it is independent of the system firmware.\nAnd like a reboot you can start any kernel with it, not just Linux.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nProhibits the execution of a new kernel image after reboot.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable kexec system call."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_legacy_ptys","name":"DisableLegacy(BSD)PTYSupport","fullDescription":{"text":"Disable the Linux traditional BSD-like terminal names /dev/ptyxx for masters and /dev/ttyxx for\nslaves of pseudo terminals, and use only the modern ptys (devpts) interface.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nThe legacy scheme has a number of security problems.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable legacy (BSD) PTY support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig","name":"EnableModuleSignatureVerification","fullDescription":{"text":"Check modules for valid signatures upon load.\nNote that this option adds the OpenSSL development packages as a kernel build dependency so\nthat the signing tool can use its crypto library.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nLoaded modules must be signed.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable module signature verification."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_all","name":"EnableAutomaticSigningOfAllModules","fullDescription":{"text":"Sign all modules during make modules_install. Without this option, modules must be signed\nmanually, using the scripts/sign-file tool.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis ensures the modules are signed during install process.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable automatic signing of all modules."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_force","name":"RequireModulesToBeValidlySigned","fullDescription":{"text":"Reject unsigned modules or signed modules with an unknown key.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nPrevent loading modules that are unsigned or signed with an unknown key.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Require modules to be validly signed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_hash","name":"SpecifyTheHashToUseWhenSigningModules","fullDescription":{"text":"This configures the kernel to build and sign modules usingas the hash function.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"\" should be returned."},"help":{"text":"rationale:\nUse of strong hash function is important to secure the module against counterfeit signatures.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Specify the hash to use when signing modules."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_key","name":"SpecifyModuleSigningKeyToUse","fullDescription":{"text":"Setting this option to something other than its default ofwill\ndisable the autogeneration of signing keys and allow the kernel modules to be signed with a key\nof your choosing.\n\nThe string provided should identify a file containing both a private key and\nits corresponding X.509 certificate in PEM form, or — on systems where the OpenSSL ENGINE_pkcs11\nis functional — a PKCS#11 URI as defined by RFC7512. In the latter case, the PKCS#11 URI should\nreference both a certificate and a private key.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"\" should be returned."},"help":{"text":"rationale:\nA key and certificate is required to sign the built modules.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Specify module signing key to use."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_module_sig_sha512","name":"SignKernelModulesWithSHA-512","fullDescription":{"text":"This configures the kernel to build and sign modules using SHA512 as the hash function.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nUse of strong hash function is important to secure the module against counterfeit signatures.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Sign kernel modules with SHA-512."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_page_poisoning_no_sanity","name":"EnablePoisonWithoutSanityCheck","fullDescription":{"text":"Skip the sanity checking on alloc, only fill the pages with poison on free. This reduces some\nof the overhead of the poisoning feature.\nThis configuration is available from kernel 4.6.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis configuration helps alleviates the performance impact of poisonining.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable poison without sanity check."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_page_poisoning_zero","name":"UseZeroForPoisoningInsteadOfDebuggingValue","fullDescription":{"text":"Instead of using the existing poison value, fill the pages with zeros. This makes it harder to\ndetect when errors are occurring due to sanitization but the zeroing at free means that it is\nno longer necessary to write zeros when GFP_ZERO is used on allocation.\nThis configuration is available from kernel 4.19.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis configuration helps alleviates the performance impact of poisonining.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Use zero for poisoning instead of debugging value."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_page_table_isolation","name":"RemoveTheKernelMappingInUserMode","fullDescription":{"text":"This feature reduces the number of hardware side channels by ensuring that the majority of\nkernel addresses are not mapped into userspace.\nThis configuration is available from kernel 4.15, but may be available if backported\nby distros.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis is a countermeasure to the Meltdown attack.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Remove the kernel mapping in user mode."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_panic_on_oops","name":"KernelPanicOops","fullDescription":{"text":"Enable the kernel to panic when it oopses.\nThis has the same effect as setting oops=panic on the kernel command line.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis feature ensures that the kernel does not do anything erroneous after an oops which\ncould result in data corruption or other issues.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Kernel panic oops."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_panic_timeout","name":"KernelPanicTimeout","fullDescription":{"text":"Set the timeout value (in seconds) until a reboot occurs when the kernel panics.\nA timeout of 0 configures the system to wait forever. With a timeout value greater than 0,\nthe system will wait the specified amount of seconds before rebooting. While a timeout value\nless than 0 makes the system reboot immediately.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"\" should be returned."},"help":{"text":"rationale:\nThis is required to enable protection against Spectre v2.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Kernel panic timeout."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_proc_kcore","name":"DisableSupportFor/proc/kkcore","fullDescription":{"text":"Provides a virtual ELF core file of the live kernel.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nThis feature exposes the memory to the userspace and can assist an attacker in discovering\nattack vectors.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable support for /proc/kkcore."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_randomize_base","name":"RandomizeTheAddressOfTheKernelImage(KASLR)","fullDescription":{"text":"In support of Kernel Address Space Layout Randomization (KASLR), this randomizes the physical\naddress at which the kernel image is decompressed and the virtual address where the kernel\nimage is mapped.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nAn unpredictable kernel address makes it more difficult to succeed with exploits that rely on\nknowledge of the location of kernel code internals.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Randomize the address of the kernel image (KASLR)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_randomize_memory","name":"RandomizeTheKernelMemorySections","fullDescription":{"text":"Randomizes the base virtual address of kernel memory sections (physical memory mapping,\nvmalloc & vmemmap).\nThis configuration is available from kernel 4.8, but may be available if backported\nby distros.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis security feature makes exploits relying on predictable memory locations less reliable.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Randomize the kernel memory sections."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_retpoline","name":"AvoidSpeculativeIndirectBranchesInKernel","fullDescription":{"text":"Compile kernel with the retpoline compiler options to guard against kernel-to-user data leaks\nby avoiding speculative indirect branches.\nRequires a compiler with -mindirect-branch=thunk-extern support for full protection.\nThe kernel may run slower.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis is required to enable protection against Spectre v2.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Avoid speculative indirect branches in kernel."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_seccomp","name":"EnableSeccompToSafelyComputeUntrustedBytecode","fullDescription":{"text":"This kernel feature is useful for number crunching applications that may need to compute\nuntrusted bytecode during their execution. By using pipes or other transports made available\nto the process as file descriptors supporting the read/write syscalls, it's possible to isolate\nthose applications in their own address space using seccomp.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nenables the ability to filter system calls made by an application, effectively\nisolating the system's resources from it.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable seccomp to safely compute untrusted bytecode."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_seccomp_filter","name":"EnableUseOfBerkeleyPacketFilterWithSeccomp","fullDescription":{"text":"Enable tasks to build secure computing environments defined in terms of Berkeley Packet Filter\nprograms which implement task-defined system call filtering polices.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nUse of BPF filters allows for expressive filtering of system calls using a filter program\nlanguage with a long history of being exposed to userland.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable use of Berkeley Packet Filter with seccomp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_security","name":"EnableDifferentSecurityModels","fullDescription":{"text":"This allows you to choose different security modules to be configured into your kernel.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis is enables kernel security primitives required by the LSM framework.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable different security models."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_security_dmesg_restrict","name":"RestrictUnprivilegedAccessToTheKernelSyslog","fullDescription":{"text":"Enforce restrictions on unprivileged users reading the kernel syslog via dmesg(8).\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nPrevents unprivileged users from retrieving kernel addresses with dmesg.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Restrict unprivileged access to the kernel syslog."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_security_writable_hooks","name":"DisableMutableHooks","fullDescription":{"text":"Ensure kernel structures associated with LSMs are always mapped as read-only after system boot.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nIf CONFIG_SECURITY_WRITABLE_HOOKS is enabled, then hooks can be loaded at runtime and\nbeing able to manipulate hooks is a way to bypass all LSMs.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable mutable hooks."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_security_yama","name":"EnableYamaSupport","fullDescription":{"text":"This enables support for LSM module Yama, which extends DAC support with additional system-wide\nsecurity settings beyond regular Linux discretionary access controls. The module will limit the\nuse of the system call.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nUnrestricted usage of ptrace allows compromised binaries to run ptrace\non another processes of the user.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable Yama support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_slub_debug","name":"EnableSLUBDebuggingSupport","fullDescription":{"text":"SLUB has extensive debug support features and this allows the allocator validation checking to\nbe enabled.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis activates the checking of the memory allocator structures and resets to zero the zones\nallocated when they are released.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable SLUB debugging support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_syn_cookies","name":"EnableTCP/IPSyncookieSupport","fullDescription":{"text":"Normal TCP/IP networking is open to an attack known as SYN flooding.\nIt is denial-of-service attack that prevents legitimate remote users from being able to connect\nto your computer during an ongoing attack.\n\nWhen enabled the TCP/IP stack will use a cryptographic challenge protocol known as SYN cookies\nto enable legitimate users to continue to connect, even when your machine is under attack.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nSYN cookies provide protection against SYN flooding attacks.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Enable TCP/IP syncookie support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_unmap_kernel_at_el0","name":"UnmapKernelWhenRunningInUserspace(akaKAISER)","fullDescription":{"text":"Speculation attacks against some high-performance processors can be used to bypass MMU\npermission checks and leak kernel data to userspace. This can be defended against by unmapping\nthe kernel when running in userspace, mapping it back in on exception entry via a trampoline\npage in the vector table.\nThis configuration is available from kernel 4.16, but may be available if backported\nby distros.\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:For each kernel installed, a line with value \"y\" should be returned."},"help":{"text":"rationale:\nThis is a countermeasure to the Meltdown attack.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Unmap kernel when running in userspace (aka KAISER)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_config_x86_vsyscall_emulation","name":"DisableX86VsyscallEmulation","fullDescription":{"text":"Disabling it is roughly equivalent to booting with vsyscall=none, except that it will also\ndisable the helpful warning if a program tries to use a vsyscall. With this option set to N,\noffending programs will just segfault, citing addresses of the form 0xffffffffff600?00.\nThis configuration is available from kernel 3.19.\n\nThe configuration that was used to build kernel is available at.\n    To check the configuration value for, run the following command:Configs with value 'n' are not explicitly set in the file, so either commented lines or no\n    lines should be returned."},"help":{"text":"rationale:\nThe vsyscall table is no longer required and is a potential source of ROP gadgets.\nwarning:\nThere is no remediation for this besides re-compiling the kernel with the appropriate value for the config."},"shortDescription":{"text":"Disable x86 vsyscall emulation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_actionsendstreamdriverauthmode","name":"EnsureRsyslogAuthenticatesOff-LoadedAuditRecords","fullDescription":{"text":"Rsyslogd is a system utility providing support for message logging. Support\nfor both internet and UNIX domain sockets enables this utility to support both local\nand remote logging.  Couple this utility with(which is a secure communications\nlibrary implementing the SSL, TLS and DTLS protocols), and you have a method to securely\nencrypt and off-load auditing.\n\nWhen usingto off-load logs the remote system must be authenticated."},"help":{"text":"rationale:\nThe audit records generated by Rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Audit records should be\nprotected from unauthorized access."},"shortDescription":{"text":"Ensure Rsyslog Authenticates Off-Loaded Audit Records."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_actionsendstreamdrivermode","name":"EnsureRsyslogEncryptsOff-LoadedAuditRecords","fullDescription":{"text":"Rsyslogd is a system utility providing support for message logging. Support\nfor both internet and UNIX domain sockets enables this utility to support both local\nand remote logging.  Couple this utility with(which is a secure communications\nlibrary implementing the SSL, TLS and DTLS protocols), and you have a method to securely\nencrypt and off-load auditing.\n\nWhen usingto off-load logs off a encrpytion system must be used."},"help":{"text":"rationale:\nThe audit records generated by Rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Audit records should be\nprotected from unauthorized access."},"shortDescription":{"text":"Ensure Rsyslog Encrypts Off-Loaded Audit Records."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_encrypt_offload_defaultnetstreamdriver","name":"EnsureRsyslogEncryptsOff-LoadedAuditRecords","fullDescription":{"text":"Rsyslogd is a system utility providing support for message logging. Support\nfor both internet and UNIX domain sockets enables this utility to support both local\nand remote logging.  Couple this utility with(which is a secure communications\nlibrary implementing the SSL, TLS and DTLS protocols), and you have a method to securely\nencrypt and off-load auditing.\n\nWhen usingto off-load logs off an encryption system must be used."},"help":{"text":"rationale:\nThe audit records generated by Rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Audit records should be\nprotected from unauthorized access."},"shortDescription":{"text":"Ensure Rsyslog Encrypts Off-Loaded Audit Records."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_files_groupownership","name":"EnsureLogFilesAreOwnedByAppropriateGroup","fullDescription":{"text":"The group-owner of all log files written byshould be.\n\nThese log files are determined by the second part of each Rule line inand typically all appear in.\nFor each log filereferenced in,\nrun the following command to inspect the file's group owner:If the owner is not,\n\nrun the following command to\ncorrect this:."},"help":{"text":"rationale:\nThe log files generated by rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Log files should be\nprotected from unauthorized access."},"shortDescription":{"text":"Ensure Log Files Are Owned By Appropriate Group."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_files_ownership","name":"EnsureLogFilesAreOwnedByAppropriateUser","fullDescription":{"text":"The owner of all log files written byshould be.\n\nThese log files are determined by the second part of each Rule line inand typically all appear in.\nFor each log filereferenced in,\nrun the following command to inspect the file's owner:If the owner is not,\n\nrun the following command to\ncorrect this:."},"help":{"text":"rationale:\nThe log files generated by rsyslog contain valuable information regarding system\nconfiguration, user authentication, and other such information. Log files should be\nprotected from unauthorized access."},"shortDescription":{"text":"Ensure Log Files Are Owned By Appropriate User."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_files_permissions","name":"EnsureSystemLogFilesHaveCorrectPermissions","fullDescription":{"text":"The file permissions for all log files written byshould\nbe set to 640, or more restrictive. These log files are determined by the\nsecond part of each Rule line inand typically\nall appear in. For each log filereferenced in, run the following command to\ninspect the file's permissions:If the permissions are not 640 or more restrictive, run the following\ncommand to correct this:\"."},"help":{"text":"rationale:\nLog files can contain valuable information regarding system\nconfiguration. If the system log files are not protected unauthorized\nusers could change the logged data, eliminating their forensic value."},"shortDescription":{"text":"Ensure System Log Files Have Correct Permissions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_remote_access_monitoring","name":"EnsureRemoteAccessMethodsAreMonitoredInRsyslog","fullDescription":{"text":"Logging of remote access methods must be implemented to help identify cyber\nattacks and ensure ongoing compliance with remote access policies are being\naudited and upheld. An examples of a remote access method is the use of the\nRemote Desktop Protocol (RDP) from an external, non-organization controlled\nnetwork. Theorfile should contain a match for the following\nselectors:,, and. If\nnot, use the following as an example configuration:."},"help":{"text":"rationale:\nLogging remote access methods can be used to trace the decrease the risks\nassociated with remote user access management. It can also be used to spot\ncyber attacks and ensure ongoing compliance with organizational policies\nsurrounding the use of remote access methods."},"shortDescription":{"text":"Ensure remote access methods are monitored in Rsyslog."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_systemd-journal-remote_installed","name":"InstallSystemd-journal-remotePackage","fullDescription":{"text":"Journald (via systemd-journal-remote ) supports the ability to send\nlog events it gathers to a remote log host or to receive messages\nfrom remote hosts, thus enabling centralised log management."},"help":{"text":"rationale:\nStoring log data on a remote host protects log integrity from local\nattacks. If an attacker gains root access on the local system, they\ncould tamper with or remove log data that is stored on the local system."},"shortDescription":{"text":"Install systemd-journal-remote Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_systemd-journald_enabled","name":"EnableSystemd-journaldService","fullDescription":{"text":"Theservice is an essential component of\nsystemd.\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nIn the event of a system failure, Ubuntu 22.04 must preserve any information necessary to determine cause of failure and any information necessary to return to operations with least disruption to system processes."},"shortDescription":{"text":"Enable systemd-journald Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SC-24","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_journald_compress","name":"EnsureJournaldIsConfiguredToCompressLargeLogFiles","fullDescription":{"text":"The journald system can compress large log files to avoid fill the system disk."},"help":{"text":"rationale:\nLog files that are not properly compressed run the risk of growing so large that they fill up the log partition. Valuable logging information could be lost if the log partition becomes full."},"shortDescription":{"text":"Ensure journald is configured to compress large log files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_journald_storage","name":"EnsureJournaldIsConfiguredToWriteLogFilesToPersistentDisk","fullDescription":{"text":"The journald system may store log files in volatile memory or locally on disk.\nIf the logs are only stored in volatile memory they will we lost upon reboot."},"help":{"text":"rationale:\nLog files contain valuable data and need to be persistent to aid in possible investigations."},"shortDescription":{"text":"Ensure journald is configured to write log files to persistent disk."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_socket_systemd-journal-remote_disabled","name":"DisableSystemd-journal-remoteSocket","fullDescription":{"text":"Journald supports the ability to receive messages from remote hosts,\nthus acting as a log server. Clients should not receive data from\nother hosts.\nNOTE:\n    The same package, systemd-journal-remote , is used for both sending\n    logs to remote hosts and receiving incoming logs.\n    With regards to receiving logs, there are two Systemd unit files;\n    systemd-journal-remote.socket and systemd-journal-remote.service."},"help":{"text":"rationale:\nIf a client is configured to also receive data, thus turning it into\na server, the client system is acting outside it's operational boundary."},"shortDescription":{"text":"Disable systemd-journal-remote Socket."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_logrotate_installed","name":"EnsureLogrotateIsInstalled","fullDescription":{"text":"logrotate is installed by default. Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nThe logrotate package provides the logrotate services."},"shortDescription":{"text":"Ensure logrotate is Installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ensure_logrotate_activated","name":"EnsureLogrotateRunsPeriodically","fullDescription":{"text":"Theutility allows for the automatic rotation of\nlog files.  The frequency of rotation is specified in,\nwhich triggers a cron task or a timer.  To configure logrotate to run daily, add or correct\nthe following line in:."},"help":{"text":"rationale:\nLog files that are not properly rotated run the risk of growing so large\nthat they fill up the /var/log partition. Valuable logging information could be lost\nif the /var/log partition becomes full."},"shortDescription":{"text":"Ensure Logrotate Runs Periodically."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_timer_logrotate_enabled","name":"EnableLogrotateTimer","fullDescription":{"text":"Thetimer can be enabled with the following command:."},"help":{"text":"rationale:\nLog files that are not properly rotated run the risk of growing so large\nthat they fill up the /var/log partition. Valuable logging information could be lost\nif the /var/log partition becomes full."},"shortDescription":{"text":"Enable logrotate Timer."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_syslogng_installed","name":"EnsureSyslog-ngIsInstalled","fullDescription":{"text":"syslog-ng can be installed in replacement of rsyslog.\nThepackage can be installed with the following command:."},"help":{"text":"rationale:\nThe syslog-ng-core package provides the syslog-ng daemon, which provides\nsystem logging services."},"shortDescription":{"text":"Ensure syslog-ng is Installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_syslogng_enabled","name":"EnableSyslog-ngService","fullDescription":{"text":"Theservice (in replacement of rsyslog) provides syslog-style logging by default on Debian.\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nTheservice must be running in order to provide\nlogging services, which are essential to system administration."},"shortDescription":{"text":"Enable syslog-ng Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4 (17) c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_tcp","name":"EnableRsyslogToAcceptMessagesViaTCP,IfActingAsLogServer","fullDescription":{"text":"Thedaemon should not accept remote messages\nunless the system acts as a log server.\nIf the system needs to act as a central log server, add the following lines toto enable reception of messages over TCP:."},"help":{"text":"rationale:\nIf the system needs to act as a log server, this ensures that it can receive\nmessages over a reliable TCP connection."},"shortDescription":{"text":"Enable rsyslog to Accept Messages via TCP, if Acting As Log Server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-6 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-6 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_accept_remote_messages_udp","name":"EnableRsyslogToAcceptMessagesViaUDP,IfActingAsLogServer","fullDescription":{"text":"Thedaemon should not accept remote messages\nunless the system acts as a log server.\nIf the system needs to act as a central log server, add the following lines toto enable reception of messages over UDP:."},"help":{"text":"rationale:\nMany devices, such as switches, routers, and other Unix-like systems, may only support\nthe traditional syslog transmission over UDP. If the system must act as a log server,\nthis enables it to receive their messages as well."},"shortDescription":{"text":"Enable rsyslog to Accept Messages via UDP, if Acting As Log Server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-6 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-6 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_nolisten","name":"EnsureRsyslogDoesNotAcceptRemoteMessagesUnlessActingAsLogServer","fullDescription":{"text":"Thedaemon should not accept remote messages unless the system acts as a log\nserver. To ensure that it is not listening on the network, ensure any of the following lines\narefound inconfiguration files.\n\nIf using legacy syntax:If using RainerScript syntax:."},"help":{"text":"rationale:\nAny process which receives messages from the network incurs some risk of receiving malicious\nmessages. This risk can be eliminated for rsyslog by configuring it not to listen on the\nnetwork."},"shortDescription":{"text":"Ensure rsyslog Does Not Accept Remote Messages Unless Acting As Log Server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-11 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_remote_loghost","name":"EnsureLogsSentToRemoteHost","fullDescription":{"text":"To configure rsyslog to send logs to a remote log server,\nopenand read and understand the last section of the file,\nwhich describes the multiple directives necessary to activate remote\nlogging.\nAlong with these other directives, the system can be configured\nto forward its logs to a particular log server by\nadding or correcting one of the following lines,\nsubstitutingappropriately.\nThe choice of protocol depends on the environment of the system;\nalthough TCP and RELP provide more reliable message delivery,\nthey may not be supported in all environments.To use UDP for log message delivery:To use TCP for log message delivery:To use RELP for log message delivery:There must be a resolvable DNS CNAME or Alias record set to \"\" for logs to be sent correctly to the centralized logging utility."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nrsyslog_remote_loghost_address=''\n\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^\\*\\.\\*\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"@@$rsyslog_remote_loghost_address\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^\\*\\.\\*\\\\>\" \"/etc/rsyslog.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^\\*\\.\\*\\\\>.*/$escaped_formatted_output/gi\" \"/etc/rsyslog.conf\"\nelse\n    if [[ -s \"/etc/rsyslog.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/rsyslog.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/rsyslog.conf\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/rsyslog.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nA log server (loghost) receives syslog messages from one or more\nsystems. This data can be used as an additional log source in the event a\nsystem is compromised and its local logs are suspect. Forwarding log messages\nto a remote loghost also provides system administrators with a centralized\nplace to view the status of multiple hosts within the enterprise.\nwarning:\nIt is important to configure queues in case the client is sending log\nmessages to a remote server. If queues are not configured,\nthe system will stop functioning when the connection\nto the remote server is not available. Please consult Rsyslog\ndocumentation for more information about configuration of queues. The\nexample configuration which should go intocan look like the following lines:"},"shortDescription":{"text":"Ensure Logs Sent To Remote Host."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-3 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_rsyslog_installed","name":"EnsureRsyslogIsInstalled","fullDescription":{"text":"Rsyslog is installed by default. Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nThe rsyslog package provides the rsyslog daemon, which provides\nsystem logging services."},"shortDescription":{"text":"Ensure rsyslog is Installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_rsyslog_enabled","name":"EnableRsyslogService","fullDescription":{"text":"Theservice provides syslog-style logging by default on Ubuntu 22.04.\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nTheservice must be running in order to provide\nlogging services, which are essential to system administration."},"shortDescription":{"text":"Enable rsyslog Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4 (17) c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-4 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ensure_rtc_utc_configuration","name":"EnsureReal-timeClockIsSetToUTC","fullDescription":{"text":"Ensure that the system real-time clock (RTC) is set to Coordinated Universal Time (UTC)."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif timedatectl status | grep -i \"time zone\" | grep -iv 'UTC\\|GMT'; then\n    timedatectl set-timezone UTC\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIf time stamps are not consistently applied and there is no common\ntime reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the operating system include date and time.\nTime is commonly expressed in UTC, a modern continuation of GMT, or\nlocal time with an offset from UTC."},"shortDescription":{"text":"Ensure real-time clock is set to UTC."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_rsyslog_filecreatemode","name":"EnsureRsyslogDefaultFilePermissionsConfigured","fullDescription":{"text":"rsyslog will create logfiles that do not already exist on the system.\nThis settings controls what permissions will be applied to these newly\ncreated files."},"help":{"text":"rationale:\nIt is important to ensure that log files have the correct permissions\nto ensure that sensitive data is archived and protected."},"shortDescription":{"text":"Ensure rsyslog Default File Permissions Configured."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_ip6tables_enabled","name":"VerifyIp6tablesEnabledIfUsingIPv6","fullDescription":{"text":"Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nTheservice provides the system's host-based firewalling\ncapability for IPv6 and ICMPv6."},"shortDescription":{"text":"Verify ip6tables Enabled if Using IPv6."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CA-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (21)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_iptables_enabled","name":"VerifyIptablesEnabled","fullDescription":{"text":"Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nTheservice provides the system's host-based firewalling\ncapability for IPv4 and ICMP."},"shortDescription":{"text":"Verify iptables Enabled."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CA-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (21)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_ip6tables_default_rule","name":"SetDefaultIp6tablesPolicyForIncomingPackets","fullDescription":{"text":"To set the default policy to DROP (instead of ACCEPT) for\nthe built-in INPUT chain which processes incoming packets,\nadd or correct the following line in:If changes were required, reload the ip6tables rules:."},"help":{"text":"check:\nocil:ssg-set_ip6tables_default_rule_ocil:questionnaire:1\nfix:\n# Remediation is applicable only in certain platforms\nif ( ! ( dpkg-query --show --showformat='${db:Status-Status}\\n' 'nftables' 2>/dev/null | grep -q installed ) && ! ( dpkg-query --show --showformat='${db:Status-Status}\\n' 'ufw' 2>/dev/null | grep -q installed ) && dpkg-query --show --showformat='${db:Status-Status}\\n' 'iptables' 2>/dev/null | grep -q installed ); then\n\nsed -i 's/^:INPUT ACCEPT.*/:INPUT DROP [0:0]/g' /etc/sysconfig/ip6tables\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIn, the default policy is applied only after all\nthe applicable rules in the table are examined for a match. Setting the\ndefault policy toimplements proper design for a firewall, i.e.\nany packets which are not explicitly permitted should not be\naccepted."},"shortDescription":{"text":"Set Default ip6tables Policy for Incoming Packets."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CA-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (21)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_ipv6_loopback_traffic","name":"SetConfigurationForIPv6LoopbackTraffic","fullDescription":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"help":{"text":"check:\nocil:ssg-set_ipv6_loopback_traffic_ocil:questionnaire:1\nrationale:\nLoopback traffic is generated between processes on machine and is\ntypically critical to operation of the system. The loopback interface\nis the only place that loopback network traffic should be seen,\nall other interfaces should ignore traffic on this network as an\nanti-spoofing measure.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Set configuration for IPv6 loopback traffic."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_loopback_traffic","name":"SetConfigurationForLoopbackTraffic","fullDescription":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"help":{"text":"check:\nocil:ssg-set_loopback_traffic_ocil:questionnaire:1\nrationale:\nLoopback traffic is generated between processes on machine and is\ntypically critical to operation of the system. The loopback interface\nis the only place that loopback network traffic should be seen, all\nother interfaces should ignore traffic on this network as an\nanti-spoofing measure.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Set configuration for loopback traffic."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ip6tables_rules_for_open_ports","name":"EnsureIp6tablesFirewallRulesExistForAllOpenPorts","fullDescription":{"text":"Any ports that have been opened on non-loopback addresses\nneed firewall rules to govern traffic."},"help":{"text":"check:\nocil:ssg-ip6tables_rules_for_open_ports_ocil:questionnaire:1\nrationale:\nWithout a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Ensure ip6tables Firewall Rules Exist for All Open Ports."},"defaultConfiguration":{"enabled":false},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_iptables_rules_for_open_ports","name":"EnsureIptablesFirewallRulesExistForAllOpenPorts","fullDescription":{"text":"Any ports that have been opened on non-loopback addresses\nneed firewall rules to govern traffic."},"help":{"text":"check:\nocil:ssg-iptables_rules_for_open_ports_ocil:questionnaire:1\nrationale:\nWithout a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Ensure iptables Firewall Rules Exist for All Open Ports."},"defaultConfiguration":{"enabled":false},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_iptables_default_rule","name":"SetDefaultIptablesPolicyForIncomingPackets","fullDescription":{"text":"To set the default policy to DROP (instead of ACCEPT) for\nthe built-in INPUT chain which processes incoming packets,\nadd or correct the following line in:."},"help":{"text":"check:\nocil:ssg-set_iptables_default_rule_ocil:questionnaire:1\nfix:\n# Remediation is applicable only in certain platforms\nif ( ! ( dpkg-query --show --showformat='${db:Status-Status}\\n' 'nftables' 2>/dev/null | grep -q installed ) && ! ( dpkg-query --show --showformat='${db:Status-Status}\\n' 'ufw' 2>/dev/null | grep -q installed ) ); then\n\nsed -i 's/^:INPUT ACCEPT.*/:INPUT DROP [0:0]/g' /etc/sysconfig/iptables\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nInthe default policy is applied only after all\nthe applicable rules in the table are examined for a match. Setting the\ndefault policy toimplements proper design for a firewall, i.e.\nany packets which are not explicitly permitted should not be\naccepted."},"shortDescription":{"text":"Set Default iptables Policy for Incoming Packets."},"defaultConfiguration":{"enabled":false},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CA-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (23)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_iptables_default_rule_forward","name":"SetDefaultIptablesPolicyForForwardedPackets","fullDescription":{"text":"To set the default policy to DROP (instead of ACCEPT) for\nthe built-in FORWARD chain which processes packets that will be forwarded from\none interface to another,\nadd or correct the following line in:."},"help":{"text":"check:\nocil:ssg-set_iptables_default_rule_forward_ocil:questionnaire:1\nfix:\nsed -i 's/^:FORWARD ACCEPT.*/:FORWARD DROP [0:0]/g' /etc/sysconfig/iptables\nrationale:\nIn, the default policy is applied only after all\nthe applicable rules in the table are examined for a match. Setting the\ndefault policy toimplements proper design for a firewall, i.e.\nany packets which are not explicitly permitted should not be\naccepted."},"shortDescription":{"text":"Set Default iptables Policy for Forwarded Packets."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CA-3 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (23)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_iptables-persistent_installed","name":"InstallIptables-persistentPackage","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\nA method of configuring and maintaining firewall rules is\nnecessary to configure a Host Based Firewall."},"shortDescription":{"text":"Install iptables-persistent Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_iptables_installed","name":"InstallIptablesPackage","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\ncontrols the Linux kernel network packet filtering\ncode.allows system operators to set up firewalls and IP\nmasquerading, etc."},"shortDescription":{"text":"Install iptables Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_iptables-persistent_removed","name":"RemoveIptables-persistentPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nRunning bothand the services included in thepackage may lead to conflict."},"shortDescription":{"text":"Remove iptables-persistent Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_ipv6_option_disabled","name":"DisableIPv6NetworkingSupportAutomaticLoading","fullDescription":{"text":"To prevent the IPv6 kernel module () from binding to the\nIPv6 networking stack, add the following line to(or another file in):This permits the IPv6 module to be loaded (and thus satisfy other modules that\ndepend on it), while disabling support for the IPv6 protocol."},"help":{"text":"rationale:\nAny unnecessary network stacks - including IPv6 - should be disabled, to reduce\nthe vulnerability to exploitation."},"shortDescription":{"text":"Disable IPv6 Networking Support Automatic Loading."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_disable_ipv6","name":"DisableIPv6AddressingOnAllIPv6Interfaces","fullDescription":{"text":"To disable support for () addressing on all interface add the following line to(or another file in):This disables IPv6 on all network interfaces as other services and system\nfunctionality require the IPv6 stack loaded to work."},"help":{"text":"rationale:\nAny unnecessary network stacks - including IPv6 - should be disabled, to reduce\nthe vulnerability to exploitation."},"shortDescription":{"text":"Disable IPv6 Addressing on All IPv6 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_disable_ipv6","name":"DisableIPv6AddressingOnIPv6InterfacesByDefault","fullDescription":{"text":"To disable support for () addressing on interfaces by default add the following line to(or another file in):This disables IPv6 on network interfaces by default as other services and system\nfunctionality require the IPv6 stack loaded to work."},"help":{"text":"rationale:\nAny unnecessary network stacks - including IPv6 - should be disabled, to reduce\nthe vulnerability to exploitation."},"shortDescription":{"text":"Disable IPv6 Addressing on IPv6 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_ra","name":"ConfigureAcceptingRouterAdvertisementsOnAllIPv6Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAn illicit router advertisement message could result in a man-in-the-middle attack."},"shortDescription":{"text":"Configure Accepting Router Advertisements on All IPv6 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_redirects","name":"DisableAcceptingICMPRedirectsForAllIPv6Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAn illicit ICMP redirect message could result in a man-in-the-middle attack."},"shortDescription":{"text":"Disable Accepting ICMP Redirects for All IPv6 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_accept_source_route","name":"DisableKernelParameterForAcceptingSource-RoutedPacketsOnAllIPv6Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nSource-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router, which can\nbe used to bypass network security measures. This requirement applies only to the\nforwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and\nthe system is functioning as a router.Accepting source-routed packets in the IPv6 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv6 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_all_forwarding","name":"DisableKernelParameterForIPv6Forwarding","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nIP forwarding permits the kernel to forward packets from one network\ninterface to another. The ability to forward packets between two networks is\nonly appropriate for systems acting as routers."},"shortDescription":{"text":"Disable Kernel Parameter for IPv6 Forwarding."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_ra","name":"DisableAcceptingRouterAdvertisementsOnAllIPv6InterfacesByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAn illicit router advertisement message could result in a man-in-the-middle attack."},"shortDescription":{"text":"Disable Accepting Router Advertisements on all IPv6 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_redirects","name":"DisableKernelParameterForAcceptingICMPRedirectsByDefaultOnIPv6Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAn illicit ICMP redirect message could result in a man-in-the-middle attack."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv6 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv6_conf_default_accept_source_route","name":"DisableKernelParameterForAcceptingSource-RoutedPacketsOnIPv6InterfacesByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nSource-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router, which can\nbe used to bypass network security measures. This requirement applies only to the\nforwarding of source-routerd traffic, such as when IPv6 forwarding is enabled and\nthe system is functioning as a router.\n\nAccepting source-routed packets in the IPv6 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting Source-Routed Packets on IPv6 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 (1) iv.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_local","name":"DisableAcceptingPacketsRoutedBetweenLocalInterfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nConfigureto consider as invalid the packets\nreceived from outside whose source is the 127.0.0.0/8 address block.\nIn combination with suitable routing, this can be used to direct packets between two\nlocal interfaces over the wire and have them accepted properly."},"shortDescription":{"text":"Disable Accepting Packets Routed Between Local Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_redirects","name":"DisableAcceptingICMPRedirectsForAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect\nmessage could result in a man-in-the-middle attack.This feature of the IPv4 protocol has few legitimate uses. It should be\ndisabled unless absolutely required.\""},"shortDescription":{"text":"Disable Accepting ICMP Redirects for All IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 d","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_accept_source_route","name":"DisableKernelParameterForAcceptingSource-RoutedPacketsOnAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nSource-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router,\nwhich can be used to bypass network security measures. This requirement\napplies only to the forwarding of source-routerd traffic, such as when IPv4\nforwarding is enabled and the system is functioning as a router.Accepting source-routed packets in the IPv4 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting Source-Routed Packets on all IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_arp_filter","name":"ConfigureARPFilteringForAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nPrevents the Linux Kernel from handling the ARP table globally.\nBy default, the kernel may respond to an ARP request from a certain interface with information\nfrom another interface.\nwarning:\nThis behaviour may cause problems to system on a high availability or load balancing configuration."},"shortDescription":{"text":"Configure ARP filtering for All IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_arp_ignore","name":"ConfigureResponseModeOfARPRequestsForAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAvoids ARP Flux on system that have more than one interface on the same subnet.\nwarning:\nThe ARP response mode may impact behaviour of workloads and firewalls on the system."},"shortDescription":{"text":"Configure Response Mode of ARP Requests for All IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_log_martians","name":"EnableKernelParameterToLogMartianPacketsOnAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nThe presence of \"martian\" packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected."},"shortDescription":{"text":"Enable Kernel Parameter to Log Martian Packets on all IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (3) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_route_localnet","name":"PreventRoutingExternalTrafficToLocalLoopbackOnAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nRefuse the routing of packets whose source or destination address is the local loopback.\nThis prohibits the use of network 127/8 for local routing purposes.\nEnablingcan expose applications listening on localhost to external traffic."},"shortDescription":{"text":"Prevent Routing External Traffic to Local Loopback on All IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_rp_filter","name":"EnableKernelParameterToUseReversePathFilteringOnAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nEnabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for\ncomplicated networks, but is helpful for end hosts and routers serving small\nnetworks."},"shortDescription":{"text":"Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_secure_redirects","name":"DisableKernelParameterForAcceptingSecureICMPRedirectsOnAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAccepting \"secure\" ICMP redirects (from those gateways listed as\ndefault gateways) has few legitimate uses. It should be disabled unless it is\nabsolutely required."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting Secure ICMP Redirects on all IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 d","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_shared_media","name":"ConfigureSendingAndAcceptingSharedMediaRedirectsForAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nThis setting should be aligned withbecause it overrides it.\nIfis enabled for an interfacewill be enabled too."},"shortDescription":{"text":"Configure Sending and Accepting Shared Media Redirects for All IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_redirects","name":"DisableKernelParameterForAcceptingICMPRedirectsByDefaultOnIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages modify the\nhost's route table and are unauthenticated. An illicit ICMP redirect\nmessage could result in a man-in-the-middle attack.This feature of the IPv4 protocol has few legitimate uses. It should\nbe disabled unless absolutely required."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting ICMP Redirects by Default on IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_accept_source_route","name":"DisableKernelParameterForAcceptingSource-RoutedPacketsOnIPv4InterfacesByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nSource-routed packets allow the source of the packet to suggest routers\nforward the packet along a different path than configured on the router,\nwhich can be used to bypass network security measures.Accepting source-routed packets in the IPv4 protocol has few legitimate\nuses. It should be disabled unless it is absolutely required, such as when\nIPv4 forwarding is enabled and the system is legitimately functioning as a\nrouter."},"shortDescription":{"text":"Disable Kernel Parameter for Accepting Source-Routed Packets on IPv4 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_log_martians","name":"EnableKernelParemeterToLogMartianPacketsOnAllIPv4InterfacesByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nThe presence of \"martian\" packets (which have impossible addresses)\nas well as spoofed packets, source-routed packets, and redirects could be a\nsign of nefarious network activity. Logging these packets enables this activity\nto be detected."},"shortDescription":{"text":"Enable Kernel Paremeter to Log Martian Packets on all IPv4 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-2 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (3) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_rp_filter","name":"EnableKernelParameterToUseReversePathFilteringOnAllIPv4InterfacesByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nEnabling reverse path filtering drops packets with source addresses\nthat should not have been able to be received on the interface they were\nreceived on. It should not be used on systems which are routers for\ncomplicated networks, but is helpful for end hosts and routers serving small\nnetworks."},"shortDescription":{"text":"Enable Kernel Parameter to Use Reverse Path Filtering on all IPv4 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_secure_redirects","name":"ConfigureKernelParameterForAcceptingSecureRedirectsByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAccepting \"secure\" ICMP redirects (from those gateways listed as\ndefault gateways) has few legitimate uses. It should be disabled unless it is\nabsolutely required."},"shortDescription":{"text":"Configure Kernel Parameter for Accepting Secure Redirects By Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_shared_media","name":"ConfigureSendingAndAcceptingSharedMediaRedirectsByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nThis setting should be aligned withbecause it overrides it.\nIfis enabled for an interfacewill be enabled too."},"shortDescription":{"text":"Configure Sending and Accepting Shared Media Redirects by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_echo_ignore_broadcasts","name":"EnableKernelParameterToIgnoreICMPBroadcastEchoRequestsOnIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nResponding to broadcast (ICMP) echoes facilitates network mapping\nand provides a vector for amplification attacks.Ignoring ICMP echo requests (pings) sent to broadcast or multicast\naddresses makes the system slightly more difficult to enumerate on the network."},"shortDescription":{"text":"Enable Kernel Parameter to Ignore ICMP Broadcast Echo Requests on IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_icmp_ignore_bogus_error_responses","name":"EnableKernelParameterToIgnoreBogusICMPErrorResponsesOnIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nIgnoring bogus ICMP error responses reduces\nlog size, although some activity would not be logged."},"shortDescription":{"text":"Enable Kernel Parameter to Ignore Bogus ICMP Error Responses on IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_tcp_syncookies","name":"EnableKernelParameterToUseTCPSyncookiesOnNetworkInterfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nA TCP SYN flood attack can cause a denial of service by filling a\nsystem's TCP connection table with connections in the SYN_RCVD state.\nSyncookies can be used to track a connection when a subsequent ACK is received,\nverifying the initiator is attempting a valid connection and is not a flood\nsource. This feature is activated when a flood condition is detected, and\nenables the system to continue servicing valid connection requests."},"shortDescription":{"text":"Enable Kernel Parameter to Use TCP Syncookies on Network Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5 (3) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_all_send_redirects","name":"DisableKernelParameterForSendingICMPRedirectsOnAllIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain information\nfrom the system's route table possibly revealing portions of the network topology.The ability to send ICMP redirects is only appropriate for systems acting as routers."},"shortDescription":{"text":"Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_conf_default_send_redirects","name":"DisableKernelParameterForSendingICMPRedirectsOnAllIPv4InterfacesByDefault","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nICMP redirect messages are used by routers to inform hosts that a more\ndirect route exists for a particular destination. These messages contain information\nfrom the system's route table possibly revealing portions of the network topology.The ability to send ICMP redirects is only appropriate for systems acting as routers."},"shortDescription":{"text":"Disable Kernel Parameter for Sending ICMP Redirects on all IPv4 Interfaces by Default."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_net_ipv4_ip_forward","name":"DisableKernelParameterForIPForwardingOnIPv4Interfaces","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nRouting protocol daemons are typically used on routers to exchange\nnetwork topology information with other routers. If this capability is used when\nnot required, system network information may be unnecessarily transmitted across\nthe network.\nwarning:\nCertain technologies such as virtual machines, containers, etc. rely on IPv4 forwarding to enable and use networking.\nDisabling IPv4 forwarding would cause those technologies to stop working. Therefore, this rule should not be used in\nprofiles or benchmarks that target usage of IPv4 forwarding."},"shortDescription":{"text":"Disable Kernel Parameter for IP Forwarding on IPv4 Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_nftables_installed","name":"InstallNftablesPackage","fullDescription":{"text":"nftables provides a new in-kernel packet classification framework that is based on a\nnetwork-specific Virtual Machine (VM) and a new nft userspace command line tool.\nnftables reuses the existing Netfilter subsystems such as the existing hook infrastructure,\nthe connection tracking system, NAT, userspace queuing and logging subsystem.\nThepackage can be installed with the following command:."},"help":{"text":"rationale:\nis a subsystem of the Linux kernel that can protect against threats\noriginating from within a corporate network to include malicious mobile code and poorly\nconfigured software on a host."},"shortDescription":{"text":"Install nftables Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_nftables_removed","name":"UninstallNftablesPackage","fullDescription":{"text":"nftables is a subsystem of the Linux kernel providing filtering and classification of network\npackets/datagrams/frames and is the successor to iptables.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nRunning bothandmay lead to conflict."},"shortDescription":{"text":"Uninstall nftables package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_nftables_enabled","name":"VerifyNftablesServiceIsEnabled","fullDescription":{"text":"The nftables service allows for the loading of nftables rulesets during boot,\nor starting on the nftables service\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nThe nftables service restores the nftables rules from the rules files referenced\nin thefile during boot or the starting of\nthe nftables service"},"shortDescription":{"text":"Verify nftables Service is Enabled."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_nftables_disabled","name":"VerifyNftablesServiceIsDisabled","fullDescription":{"text":"nftables is a subsystem of the Linux kernel providing filtering and classification of network\npackets/datagrams/frames and is the successor to iptables.\nTheservice can be disabled with the following command:."},"help":{"text":"rationale:\nRunning bothandmay lead to conflict.is actually one of the backends formanagement tools."},"shortDescription":{"text":"Verify nftables Service is Disabled."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_nftables_ensure_default_deny_policy","name":"EnsureNftablesDefaultDenyFirewallPolicy","fullDescription":{"text":"Base chain policy is the default verdict that will be applied to packets reaching the end of\nthe chain. There are two policies: accept (Default) and drop. If the policy is set to accept,\nthe firewall will accept any packet that is not configured to be denied and the packet will\ncontinue traversing the network stack."},"help":{"text":"check:\nocil:ssg-nftables_ensure_default_deny_policy_ocil:questionnaire:1\nrationale:\nIt is easier to allow acceptable usage than to block unacceptable usage.\nwarning:\nChanging firewall settings while connected over network can result in being locked out\nof the system."},"shortDescription":{"text":"Ensure nftables Default Deny Firewall Policy."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_nftables_rules_permanent","name":"EnsureNftablesRulesArePermanent","fullDescription":{"text":"nftables is a subsystem of the Linux kernel providing filtering and classification of\nnetwork packets/datagrams/frames. The nftables service reads thefile for a nftables file or files to\ninclude in the nftables ruleset. A nftables ruleset containing the input, forward, and output\nbase chains allow network traffic to be filtered."},"help":{"text":"check:\nocil:ssg-nftables_rules_permanent_ocil:questionnaire:1\nrationale:\nChanges made to nftables ruleset only affect the live system, you will also need to configure\nthe nftables ruleset to apply on boot"},"shortDescription":{"text":"Ensure nftables Rules are Permanent."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_nftables_base_chain","name":"EnsureBaseChainsExistForNftables","fullDescription":{"text":"Tables in nftables hold chains. Each table only has one address family and only applies\nto packets of this family. Tables can have one of six families.\nChains are containers for rules. They exist in two kinds, base chains and regular chains.\nA base chain is an entry point for packets from the networking stack, a regular chain may\nbe used as jump target and is used for better rule organization."},"help":{"text":"check:\nocil:ssg-set_nftables_base_chain_ocil:questionnaire:1\nrationale:\nIf a base chain doesn't exist with a hook for input, forward, and delete, packets that would\nflow through those chains will not be touched by nftables.\nwarning:\nConfiguring rules over ssh, by creating a base chain with policy drop will cause loss of connectivity. Ensure that a rule allowing ssh has been added to the base chain prior to setting the base cahin's policy to drop"},"shortDescription":{"text":"Ensure Base Chains Exist for Nftables."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_nftables_loopback_traffic","name":"SetNftablesConfigurationForLoopbackTraffic","fullDescription":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"help":{"text":"check:\nocil:ssg-set_nftables_loopback_traffic_ocil:questionnaire:1\nrationale:\nLoopback traffic is generated between processes on machine and is\ntypically critical to operation of the system. The loopback interface\nis the only place that loopback network traffic should be seen,\nall other interfaces should ignore traffic on this network as an\nanti-spoofing measure.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system.\nKeep in mind the remediation makes changes only to the running\nsystem, in order to keep the changes need to take care to save\nthe nft settings to the relvant configutation files."},"shortDescription":{"text":"Set nftables Configuration for Loopback Traffic."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_nftables_table","name":"EnsureATableExistsForNftables","fullDescription":{"text":"Tables in nftables hold chains. Each table only has one address family and only applies\nto packets of this family. Tables can have one of six families."},"help":{"text":"check:\nocil:ssg-set_nftables_table_ocil:questionnaire:1\nrationale:\nNftables doesn't have any default tables. Without a table being built, nftables will not filter\nnetwork traffic.\nNote: adding rules to a running nftables can cause loss of connectivity to the system.\nwarning:\nAdding rules to a running nftables can cause loss of connectivity to the system."},"shortDescription":{"text":"Ensure a Table Exists for Nftables."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_ufw_installed","name":"InstallUfwPackage","fullDescription":{"text":"Thepackage can be installed with the following command:."},"help":{"text":"rationale:\ncontrols the Linux kernel network packet filtering\ncode.allows system operators to set up firewalls and IP\nmasquerading, etc."},"shortDescription":{"text":"Install ufw Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_ufw_removed","name":"RemoveUfwPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nRunningwithenabled may lead\nto conflict and unexpected results."},"shortDescription":{"text":"Remove ufw Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_ufw_enabled","name":"VerifyUfwEnabled","fullDescription":{"text":"Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nThe ufw service must be enabled and running in order for ufw to protect the system"},"shortDescription":{"text":"Verify ufw Enabled."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_ufw_default_rule","name":"EnsureUfwDefaultDenyFirewallPolicy","fullDescription":{"text":"A default deny policy on connections ensures that any unconfigured\nnetwork usage will be rejected.\n\nNote: Any port or protocol without a explicit allow before the default\ndeny will be blocked."},"help":{"text":"check:\nocil:ssg-set_ufw_default_rule_ocil:questionnaire:1\nrationale:\nWith a default accept policy the firewall will accept any packet that\nis not configured to be denied. It is easier to allow acceptable\nusage than to block unacceptable usage.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Ensure ufw Default Deny Firewall Policy."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_set_ufw_loopback_traffic","name":"SetUFWLoopbackTraffic","fullDescription":{"text":"Configure the loopback interface to accept traffic.\nConfigure all other interfaces to deny traffic to the loopback\nnetwork."},"help":{"text":"check:\nocil:ssg-set_ufw_loopback_traffic_ocil:questionnaire:1\nfix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { dpkg-query --show --showformat='${db:Status-Status}\\n' 'ufw' 2>/dev/null | grep -q installed; }; then\n\nufw allow in on lo\nufw allow out on lo\nufw deny in from 127.0.0.0/8\nufw deny in from ::1\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nLoopback traffic is generated between processes on machine and is\ntypically critical to operation of the system. The loopback interface\nis the only place that loopback network traffic should be seen, all\nother interfaces should ignore traffic on this network as an\nanti-spoofing measure.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Set UFW Loopback Traffic."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ufw_rules_for_open_ports","name":"EnsureUfwFirewallRulesExistForAllOpenPorts","fullDescription":{"text":"Any ports that have been opened on non-loopback addresses\nneed firewall rules to govern traffic."},"help":{"text":"check:\nocil:ssg-ufw_rules_for_open_ports_ocil:questionnaire:1\nrationale:\nWithout a firewall rule configured for open ports default\nfirewall policy will drop all packets to these ports.\nwarning:\nChanging firewall settings while connected over network can\nresult in being locked out of the system."},"shortDescription":{"text":"Ensure ufw Firewall Rules Exist for All Open Ports."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_dccp_disabled","name":"DisableDCCPSupport","fullDescription":{"text":"The Datagram Congestion Control Protocol (DCCP) is a\nrelatively new transport layer protocol, designed to support\nstreaming media and telephony.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"help":{"text":"rationale:\nDisabling DCCP protects\nthe system against exploitation of any flaws in its implementation."},"shortDescription":{"text":"Disable DCCP Support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_rds_disabled","name":"DisableRDSSupport","fullDescription":{"text":"The Reliable Datagram Sockets (RDS) protocol is a transport\nlayer protocol designed to provide reliable high-bandwidth,\nlow-latency communications between nodes in a cluster.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"help":{"text":"rationale:\nDisabling RDS protects\nthe system against exploitation of any flaws in its implementation."},"shortDescription":{"text":"Disable RDS Support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_sctp_disabled","name":"DisableSCTPSupport","fullDescription":{"text":"The Stream Control Transmission Protocol (SCTP) is a\ntransport layer protocol, designed to support the idea of\nmessage-oriented communication, with several streams of messages\nwithin one connection.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"help":{"text":"rationale:\nDisabling SCTP protects\nthe system against exploitation of any flaws in its implementation."},"shortDescription":{"text":"Disable SCTP Support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_tipc_disabled","name":"DisableTIPCSupport","fullDescription":{"text":"The Transparent Inter-Process Communication (TIPC) protocol\nis designed to provide communications between nodes in a\ncluster.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:."},"help":{"text":"rationale:\nDisabling TIPC protects\nthe system against exploitation of any flaws in its implementation.\nwarning:\nThis configuration baseline was created to deploy the base operating system for general purpose\nworkloads. When the operating system is configured for certain purposes, such as\na node in High Performance Computing cluster, it is expected that\nthekernel module will be loaded."},"shortDescription":{"text":"Disable TIPC Support."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_wireless_disable_interfaces","name":"DeactivateWirelessNetworkInterfaces","fullDescription":{"text":"Deactivating wireless network interfaces should prevent normal usage of the wireless\ncapability.Configure the system to disable all wireless network interfaces with the following command:."},"help":{"text":"rationale:\nThe use of wireless networking can introduce many different attack vectors into\nthe organization's network. Common attack vectors such as malicious association\nand ad hoc networks will allow an attacker to spoof a wireless access point\n(AP), allowing validated systems to connect to the malicious AP and enabling the\nattacker to monitor and record network traffic. These malicious APs can also\nserve to create a man-in-the-middle attack or be used to create a denial of\nservice to valid network resources."},"shortDescription":{"text":"Deactivate Wireless Network Interfaces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-18 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-18 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-18 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-19 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-8","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_only_allow_dod_certs","name":"OnlyAllowDoDPKI-establishedCAs","fullDescription":{"text":"The operating system must only allow the use of DoD PKI-established\ncertificate authorities for verification of the establishment of\nprotected sessions."},"help":{"text":"rationale:\nUntrusted Certificate Authorities (CA) can issue certificates, but they\nmay be issued by organizations or individuals that seek to compromise\nDoD systems or by organizations with insufficient security controls. If\nthe CA used for verifying the certificate is not a DoD-approved CA,\ntrust of this CA has not been established.\nThe DoD will only accept PKI-certificates obtained from a DoD-approved\ninternal or external certificate authority. Reliance on CAs for the\nestablishment of secure sessions includes, for example, the use of\nSSL/TLS certificates."},"shortDescription":{"text":"Only Allow DoD PKI-established CAs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SC-23 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_group","name":"VerifyGroupWhoOwnsBackupGroupFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains information regarding groups that are configured on the system.\nProtection of this file is important for system security."},"shortDescription":{"text":"Verify Group Who Owns Backup group File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_gshadow","name":"VerifyGroupWhoOwnsBackupGshadowFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup of, and as such,\nit contains group password hashes. Protection of this file is critical for system security."},"shortDescription":{"text":"Verify Group Who Owns Backup gshadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_passwd","name":"VerifyGroupWhoOwnsBackupPasswdFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains information about the users that are configured on the system.\nProtection of this file is critical for system security."},"shortDescription":{"text":"Verify Group Who Owns Backup passwd File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_backup_etc_shadow","name":"VerifyUserWhoOwnsBackupShadowFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains the list of local system accounts and password hashes.\nProtection of this file is critical for system security."},"shortDescription":{"text":"Verify User Who Owns Backup shadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_group","name":"VerifyGroupWhoOwnsGroupFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile contains information regarding groups that are configured\non the system. Protection of this file is important for system security."},"shortDescription":{"text":"Verify Group Who Owns group File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_gshadow","name":"VerifyGroupWhoOwnsGshadowFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile contains group password hashes. Protection of this file\nis critical for system security."},"shortDescription":{"text":"Verify Group Who Owns gshadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_passwd","name":"VerifyGroupWhoOwnsPasswdFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile contains information about the users that are configured on\nthe system. Protection of this file is critical for system security."},"shortDescription":{"text":"Verify Group Who Owns passwd File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_etc_shadow","name":"VerifyGroupWhoOwnsShadowFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile stores password hashes. Protection of this file is\ncritical for system security."},"shortDescription":{"text":"Verify Group Who Owns shadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_group","name":"VerifyUserWhoOwnsBackupGroupFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains information regarding groups that are configured on the system.\nProtection of this file is important for system security."},"shortDescription":{"text":"Verify User Who Owns Backup group File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_gshadow","name":"VerifyUserWhoOwnsBackupGshadowFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup of, and as such,\nit contains group password hashes. Protection of this file is critical for system security."},"shortDescription":{"text":"Verify User Who Owns Backup gshadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_passwd","name":"VerifyUserWhoOwnsBackupPasswdFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains information about the users that are configured on the system.\nProtection of this file is critical for system security."},"shortDescription":{"text":"Verify User Who Owns Backup passwd File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_backup_etc_shadow","name":"VerifyGroupWhoOwnsBackupShadowFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains the list of local system accounts and password hashes.\nProtection of this file is critical for system security."},"shortDescription":{"text":"Verify Group Who Owns Backup shadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_group","name":"VerifyUserWhoOwnsGroupFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile contains information regarding groups that are configured\non the system. Protection of this file is important for system security."},"shortDescription":{"text":"Verify User Who Owns group File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_gshadow","name":"VerifyUserWhoOwnsGshadowFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile contains group password hashes. Protection of this file\nis critical for system security."},"shortDescription":{"text":"Verify User Who Owns gshadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_passwd","name":"VerifyUserWhoOwnsPasswdFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile contains information about the users that are configured on\nthe system. Protection of this file is critical for system security."},"shortDescription":{"text":"Verify User Who Owns passwd File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_etc_shadow","name":"VerifyUserWhoOwnsShadowFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile contains the list of local\nsystem accounts and stores password hashes. Protection of this file is\ncritical for system security. Failure to give ownership of this file\nto root provides the designated owner with access to sensitive information\nwhich could weaken the system security posture."},"shortDescription":{"text":"Verify User Who Owns shadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_group","name":"VerifyPermissionsOnBackupGroupFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains information regarding groups that are configured on the system.\nProtection of this file is important for system security."},"shortDescription":{"text":"Verify Permissions on Backup group File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_gshadow","name":"VerifyPermissionsOnBackupGshadowFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile is a backup of, and as such,\nit contains group password hashes. Protection of this file is critical for system security."},"shortDescription":{"text":"Verify Permissions on Backup gshadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_passwd","name":"VerifyPermissionsOnBackupPasswdFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains information about the users that are configured on the system.\nProtection of this file is critical for system security."},"shortDescription":{"text":"Verify Permissions on Backup passwd File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_backup_etc_shadow","name":"VerifyPermissionsOnBackupShadowFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile is a backup file of, and as such,\nit contains the list of local system accounts and password hashes.\nProtection of this file is critical for system security."},"shortDescription":{"text":"Verify Permissions on Backup shadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_group","name":"VerifyPermissionsOnGroupFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile contains information regarding groups that are configured\non the system. Protection of this file is important for system security."},"shortDescription":{"text":"Verify Permissions on group File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_gshadow","name":"VerifyPermissionsOnGshadowFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile contains group password hashes. Protection of this file\nis critical for system security."},"shortDescription":{"text":"Verify Permissions on gshadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_passwd","name":"VerifyPermissionsOnPasswdFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nIf thefile is writable by a group-owner or the\nworld the risk of its compromise is increased. The file contains the list of\naccounts on the system and associated information, and protection of this file\nis critical for system security."},"shortDescription":{"text":"Verify Permissions on passwd File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_shadow","name":"VerifyPermissionsOnShadowFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile contains the list of local\nsystem accounts and stores password hashes. Protection of this file is\ncritical for system security. Failure to give ownership of this file\nto root provides the designated owner with access to sensitive information\nwhich could weaken the system security posture."},"shortDescription":{"text":"Verify Permissions on shadow File."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_var_log","name":"VerifyGroupWhoOwns/var/logDirectory","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThedirectory contains files with logs of error\nmessages in the system and should only be accessed by authorized\npersonnel."},"shortDescription":{"text":"Verify Group Who Owns /var/log Directory."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_var_log_messages","name":"VerifyGroupWhoOwns/var/log/messagesFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile contains logs of error messages in\nthe system and should only be accessed by authorized personnel."},"shortDescription":{"text":"Verify Group Who Owns /var/log/messages File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_var_log_syslog","name":"VerifyGroupWhoOwns/var/log/syslogFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nThefile contains logs of error messages in\nthe system and should only be accessed by authorized personnel."},"shortDescription":{"text":"Verify Group Who Owns /var/log/syslog File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_var_log","name":"VerifyUserWhoOwns/var/logDirectory","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThedirectory contains files with logs of error\nmessages in the system and should only be accessed by authorized\npersonnel."},"shortDescription":{"text":"Verify User Who Owns /var/log Directory."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_var_log_messages","name":"VerifyUserWhoOwns/var/log/messagesFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile contains logs of error messages in\nthe system and should only be accessed by authorized personnel."},"shortDescription":{"text":"Verify User Who Owns /var/log/messages File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_var_log_syslog","name":"VerifyUserWhoOwns/var/log/syslogFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nThefile contains logs of error messages in\nthe system and should only be accessed by authorized personnel."},"shortDescription":{"text":"Verify User Who Owns /var/log/syslog File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_var_log","name":"VerifyPermissionsOn/var/logDirectory","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThedirectory contains files with logs of error\nmessages in the system and should only be accessed by authorized\npersonnel."},"shortDescription":{"text":"Verify Permissions on /var/log Directory."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_var_log_messages","name":"VerifyPermissionsOn/var/log/messagesFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile contains logs of error messages in\nthe system and should only be accessed by authorized personnel."},"shortDescription":{"text":"Verify Permissions on /var/log/messages File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_var_log_syslog","name":"VerifyPermissionsOn/var/log/syslogFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile contains logs of error messages in\nthe system and should only be accessed by authorized personnel."},"shortDescription":{"text":"Verify Permissions on /var/log/syslog File."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_group_ownership_library_dirs","name":"VerifyThatSharedLibraryDirectoriesHaveRootGroupOwnership","fullDescription":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are also\nstored in. All files in these directories should be\ngroup-owned by theuser. If the  directories, is found to be owned\nby a user other than root correct its\nownership with the following command:."},"help":{"text":"rationale:\nFiles from shared library directories are loaded into the address\nspace of processes (including privileged ones) or of the kernel itself at\nruntime. Proper ownership of library directories is necessary to protect\nthe integrity of the system."},"shortDescription":{"text":"Verify that Shared Library Directories Have Root Group Ownership."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_groupownership_binary_dirs","name":"VerifyThatSystemCommandsDirectoriesAreGroupOwnedByRoot","fullDescription":{"text":"System commands files are stored in the following directories by default:All these directories should be owned by thegroup.\nIf the directory is found to be owned by a group other than root correct\nits ownership with the following command:."},"help":{"text":"rationale:\nIf the operating system allows any user to make changes to software\nlibraries, then those changes might be implemented without undergoing the\nappropriate testing and approvals that are part of a robust change management\nprocess.\nThis requirement applies to operating systems with software libraries\nthat are accessible and configurable, as in the case of interpreted languages.\nSoftware libraries also include privileged programs which execute with\nescalated privileges. Only qualified and authorized individuals must be\nallowed to obtain access to information system components for purposes\nof initiating changes, including upgrades and modifications."},"shortDescription":{"text":"Verify that system commands directories are group owned by root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_ownership_binary_dirs","name":"VerifyThatSystemExecutableHaveRootOwnership","fullDescription":{"text":"All these directories should be owned by theuser.\nIf any directoryin these directories is found\nto be owned by a user other than root, correct its ownership with the\nfollowing command:."},"help":{"text":"rationale:\nSystem binaries are executed by privileged users as well as system services,\nand restrictive permissions are necessary to ensure that their\nexecution of these programs cannot be co-opted."},"shortDescription":{"text":"Verify that System Executable Have Root Ownership."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_ownership_library_dirs","name":"VerifyThatSharedLibraryDirectoriesHaveRootOwnership","fullDescription":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are also\nstored in. All files in these directories should be\nowned by theuser. If the  directories, is found to be owned\nby a user other than root correct its\nownership with the following command:."},"help":{"text":"rationale:\nFiles from shared library directories are loaded into the address\nspace of processes (including privileged ones) or of the kernel itself at\nruntime. Proper ownership of library directories is necessary to protect\nthe integrity of the system."},"shortDescription":{"text":"Verify that Shared Library Directories Have Root Ownership."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_permissions_binary_dirs","name":"VerifyThatSystemExecutableDirectoriesHaveRestrictivePermissions","fullDescription":{"text":"System executables are stored in the following directories by default:These directories should not be group-writable or world-writable.\nIf any directoryin these directories is found to be\ngroup-writable or world-writable, correct its permission with the\nfollowing command:."},"help":{"text":"rationale:\nSystem binaries are executed by privileged users, as well as system services,\nand restrictive permissions are necessary to ensure execution of these programs\ncannot be co-opted."},"shortDescription":{"text":"Verify that System Executable Directories Have Restrictive Permissions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_permissions_library_dirs","name":"VerifyThatSharedLibraryDirectoriesHaveRestrictivePermissions","fullDescription":{"text":"System-wide shared library directories, which contain are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are\nstored in. All sub-directories in these directories\nshould not be group-writable or world-writable. If any file in these\ndirectories is found to be group-writable or world-writable, correct\nits permission with the following command:."},"help":{"text":"rationale:\nIf the operating system were to allow any user to make changes to software libraries,\nthen those changes might be implemented without undergoing the appropriate testing\nand approvals that are part of a robust change management process.\n\nThis requirement applies to operating systems with software libraries that are accessible\nand configurable, as in the case of interpreted languages. Software libraries also include\nprivileged programs which execute with escalated privileges. Only qualified and authorized\nindividuals must be allowed to obtain access to information system components for purposes\nof initiating changes, including upgrades and modifications."},"shortDescription":{"text":"Verify that Shared Library Directories Have Restrictive Permissions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupownership_audit_binaries","name":"VerifyThatAuditToolsAreOwnedByGroupRoot","fullDescription":{"text":"The Ubuntu 22.04 operating system audit tools must have the proper\nownership configured to protected against unauthorized access.\n\nVerify it by running the following command:Audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators."},"help":{"text":"rationale:\nProtecting audit information also includes identifying and protecting the\ntools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information\nwill leverage user permissions and roles identifying the user accessing the\ntools and the corresponding rights the user enjoys to make access decisions\nregarding the access to audit tools."},"shortDescription":{"text":"Verify that audit tools are owned by group root."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupownership_system_commands_dirs","name":"VerifyThatSystemCommandsFilesAreGroupOwnedByRootOrASystemAccount","fullDescription":{"text":"System commands files are stored in the following directories by default:All files in these directories should be owned by thegroup,\nor a system account.\nIf the directory, or any file in these directories, is found to be owned\nby a group other than root or a a system account correct its ownership\nwith the following command:."},"help":{"text":"fix:\nfor SYSCMDFILES in /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin\ndo\n   find -L $SYSCMDFILES \\! -group root -type f -exec chgrp root '{}' \\;\ndone\nrationale:\nIf the operating system allows any user to make changes to software\nlibraries, then those changes might be implemented without undergoing the\nappropriate testing and approvals that are part of a robust change management\nprocess.\nThis requirement applies to operating systems with software libraries\nthat are accessible and configurable, as in the case of interpreted languages.\nSoftware libraries also include privileged programs which execute with\nescalated privileges. Only qualified and authorized individuals must be\nallowed to obtain access to information system components for purposes\nof initiating changes, including upgrades and modifications."},"shortDescription":{"text":"Verify that system commands files are group owned by root or a system account."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_audit_binaries","name":"VerifyThatAuditToolsAreOwnedByRoot","fullDescription":{"text":"The Ubuntu 22.04 operating system audit tools must have the proper\nownership configured to protected against unauthorized access.\n\nVerify it by running the following command:Audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators."},"help":{"text":"rationale:\nProtecting audit information also includes identifying and protecting the\ntools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information\nwill leverage user permissions and roles identifying the user accessing the\ntools and the corresponding rights the user enjoys to make access decisions\nregarding the access to audit tools."},"shortDescription":{"text":"Verify that audit tools are owned by root."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_binary_dirs","name":"VerifyThatSystemExecutablesHaveRootOwnership","fullDescription":{"text":"System executables are stored in the following directories by default:All files in these directories should be owned by theuser.\nIf any filein these directories is found\nto be owned by a user other than root, correct its ownership with the\nfollowing command:."},"help":{"text":"rationale:\nSystem binaries are executed by privileged users as well as system services,\nand restrictive permissions are necessary to ensure that their\nexecution of these programs cannot be co-opted."},"shortDescription":{"text":"Verify that System Executables Have Root Ownership."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_library_dirs","name":"VerifyThatSharedLibraryFilesHaveRootOwnership","fullDescription":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are also\nstored in. All files in these directories should be\nowned by theuser. If the directory, or any file in these\ndirectories, is found to be owned by a user other than root correct its\nownership with the following command:."},"help":{"text":"rationale:\nFiles from shared library directories are loaded into the address\nspace of processes (including privileged ones) or of the kernel itself at\nruntime. Proper ownership is necessary to protect the integrity of the system."},"shortDescription":{"text":"Verify that Shared Library Files Have Root Ownership."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_audit_binaries","name":"VerifyThatAuditToolsHaveMode0755OrLess","fullDescription":{"text":"The Ubuntu 22.04 operating system audit tools must have the proper\npermissions configured to protected against unauthorized access.\n\nVerify it by running the following command:Audit tools needed to successfully view and manipulate audit information\nsystem activity and records. Audit tools include custom queries and report\ngenerators."},"help":{"text":"rationale:\nProtecting audit information also includes identifying and protecting the\ntools used to view and manipulate log data. Therefore, protecting audit\ntools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information\nwill leverage user permissions and roles identifying the user accessing the\ntools and the corresponding rights the user enjoys to make access decisions\nregarding the access to audit tools."},"shortDescription":{"text":"Verify that audit tools Have Mode 0755 or less."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_binary_dirs","name":"VerifyThatSystemExecutablesHaveRestrictivePermissions","fullDescription":{"text":"System executables are stored in the following directories by default:All files in these directories should not be group-writable or world-writable.\nIf any filein these directories is found\nto be group-writable or world-writable, correct its permission with the\nfollowing command:."},"help":{"text":"fix:\nDIRS=\"/bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin /usr/libexec\"\nfor dirPath in $DIRS; do\n\tfind \"$dirPath\" -perm /022 -exec chmod go-w '{}' \\;\ndone\nrationale:\nSystem binaries are executed by privileged users, as well as system services,\nand restrictive permissions are necessary to ensure execution of these programs\ncannot be co-opted."},"shortDescription":{"text":"Verify that System Executables Have Restrictive Permissions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_library_dirs","name":"VerifyThatSharedLibraryFilesHaveRestrictivePermissions","fullDescription":{"text":"System-wide shared library files, which are linked to executables\nduring process load time or run time, are stored in the following directories\nby default:Kernel modules, which can be added to the kernel during runtime, are\nstored in. All files in these directories\nshould not be group-writable or world-writable. If any file in these\ndirectories is found to be group-writable or world-writable, correct\nits permission with the following command:."},"help":{"text":"rationale:\nFiles from shared library directories are loaded into the address\nspace of processes (including privileged ones) or of the kernel itself at\nruntime. Restrictive permissions are necessary to protect the integrity of the system."},"shortDescription":{"text":"Verify that Shared Library Files Have Restrictive Permissions."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_root_permissions_syslibrary_files","name":"VerifyTheSystem-wideLibraryFilesInDirectories\n\"/lib\",\"/lib64\",\"/usr/lib/\"And\"/usr/lib64\"AreGroup-ownedByRoot.","fullDescription":{"text":"System-wide library files are stored in the following directories\nby default:All system-wide shared library files should be protected from unauthorised\naccess. If any of these files is not group-owned by root, correct its group-owner with\nthe following command:."},"help":{"text":"rationale:\nIf the operating system were to allow any user to make changes to software libraries,\nthen those changes might be implemented without undergoing the appropriate testing and\napprovals that are part of a robust change management process.\n\nThis requirement applies to operating systems with software libraries that are\naccessible and configurable, as in the case of interpreted languages. Software libraries\nalso include privileged programs which execute with escalated privileges. Only qualified\nand authorized individuals must be allowed to obtain access to information system components\nfor purposes of initiating changes, including upgrades and modifications."},"shortDescription":{"text":"Verify the system-wide library files in directories\n\"/lib\", \"/lib64\", \"/usr/lib/\" and \"/usr/lib64\" are group-owned by root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-5 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (6) (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dir_perms_world_writable_sticky_bits","name":"VerifyThatAllWorld-WritableDirectoriesHaveStickyBitsSet","fullDescription":{"text":"When the so-called 'sticky bit' is set on a directory,\nonly the owner of a given file may remove that file from the\ndirectory. Without the sticky bit, any user with write access to a\ndirectory may remove any file in the directory. Setting the sticky\nbit prevents users from removing each other's files. In cases where\nthere is no reason for a directory to be world-writable, a better\nsolution is to remove that permission rather than to set the sticky\nbit. However, if a directory is used by a particular application,\nconsult that application's documentation instead of blindly\nchanging modes.To set the sticky bit on a world-writable directory, run the\nfollowing command:."},"help":{"text":"fix:\ndf --local -P | awk '{if (NR!=1) print $6}' \\\n| xargs -I '$6' find '$6' -xdev -type d \\\n\\( -perm -0002 -a ! -perm -1000 \\) 2>/dev/null \\\n-exec chmod a+t {} +\nrationale:\nFailing to set the sticky bit on public directories allows unauthorized\nusers to delete files in the directory structure.The only authorized public directories are those temporary directories\nsupplied with the system, or those designed to be temporary file\nrepositories. The setting is normally reserved for directories used by the\nsystem, by users for temporary file storage (such as), and\nfor directories requiring global read/write access."},"shortDescription":{"text":"Verify that All World-Writable Directories Have Sticky Bits Set."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-4","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_audit_auditd","name":"VerifyPermissionsOn/etc/audit/auditd.conf","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nWithout the capability to restrict the roles and individuals that can select which events\nare audited, unauthorized personnel may be able to prevent the auditing of critical\nevents. Misconfigured audits may degrade the system's performance by overwhelming\nthe audit log. Misconfigured audits may also make it more difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one."},"shortDescription":{"text":"Verify Permissions on /etc/audit/auditd.conf."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_etc_audit_rulesd","name":"VerifyPermissionsOn/etc/audit/rules.d/*.rules","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nWithout the capability to restrict the roles and individuals that can select which events\nare audited, unauthorized personnel may be able to prevent the auditing of critical\nevents. Misconfigured audits may degrade the system's performance by overwhelming\nthe audit log. Misconfigured audits may also make it more difficult to establish,\ncorrelate, and investigate the events relating to an incident or identify\nthose responsible for one."},"shortDescription":{"text":"Verify Permissions on /etc/audit/rules.d/*.rules."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-12 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_systemmap","name":"VerifyThatLocalSystem.mapFile(ifExists)IsReadableOnlyByRoot","fullDescription":{"text":"Files containing sensitive informations should be protected by restrictive\n  permissions. Most of the time, there is no need that these files need to be read by any non-root user\n\nTo properly set the permissions of, run the command:."},"help":{"text":"rationale:\nThefile contains information about kernel symbols and\n  can give some hints to generate local exploitation."},"shortDescription":{"text":"Verify that local System.map file (if exists) is readable only by root."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_unauthorized_world_writable","name":"EnsureNoWorld-WritableFilesExist","fullDescription":{"text":"It is generally a good idea to remove global (other) write\naccess to a file when it is discovered. However, check with\ndocumentation for specific applications before making changes.\nAlso, monitor for recurring world-writable files, as these may be\nsymptoms of a misconfigured application or user account. Finally,\nthis applies to real files and not virtual files that are a part of\npseudo file systems such asor."},"help":{"text":"fix:\nfind / -xdev -type f -perm -002 -exec chmod o-w {} \\;\nrationale:\nData in world-writable files can be modified by any\nuser on the system. In almost all circumstances, files can be\nconfigured using a combination of user and group permissions to\nsupport whatever legitimate access is needed without the risk\ncaused by world-writable files."},"shortDescription":{"text":"Ensure No World-Writable Files Exist."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_ungroupowned","name":"EnsureAllFilesAreOwnedByAGroup","fullDescription":{"text":"If any files are not owned by a group, then the\ncause of their lack of group-ownership should be investigated.\nFollowing this, the files should be deleted or assigned to an\nappropriate group. The following command will discover and print\nany files on local partitions which do not belong to a valid group:To search all filesystems on a system including network mounted\nfilesystems the following command can be run manually for each partition:."},"help":{"text":"rationale:\nUnowned files do not directly imply a security problem, but they are generally\na sign that something is amiss. They may\nbe caused by an intruder, by incorrect software installation or\ndraft software removal, or by failure to remove all files belonging\nto a deleted account. The files should be repaired so they\nwill not cause problems when accounts are created in the future,\nand the cause should be discovered and addressed.\nwarning:\nThis rule only considers local groups.\nIf you have your groups defined outside, the rule won't consider those."},"shortDescription":{"text":"Ensure All Files Are Owned by a Group."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_files_unowned_by_user","name":"EnsureAllFilesAreOwnedByAUser","fullDescription":{"text":"If any files are not owned by a user, then the\ncause of their lack of ownership should be investigated.\nFollowing this, the files should be deleted or assigned to an\nappropriate user. The following command will discover and print\nany files on local partitions which do not belong to a valid user:To search all filesystems on a system including network mounted\nfilesystems the following command can be run manually for each partition:."},"help":{"text":"rationale:\nUnowned files do not directly imply a security problem, but they are generally\na sign that something is amiss. They may\nbe caused by an intruder, by incorrect software installation or\ndraft software removal, or by failure to remove all files belonging\nto a deleted account. The files should be repaired so they\nwill not cause problems when accounts are created in the future,\nand the cause should be discovered and addressed."},"shortDescription":{"text":"Ensure All Files Are Owned by a User."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_permissions_local_var_log","name":"VerifyPermissionsOfLogFiles","fullDescription":{"text":"Any operating system providing too much information in error messages\nrisks compromising the data and security of the structure, and content\nof error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages.\nThe extent to which information systems are able to identify and handle\nerror conditions is guided by organizational policy and operational\nrequirements. Information that could be exploited by adversaries includes,\nfor example, erroneous logon attempts with passwords entered by mistake\nas the username, mission/business information that can be derived from\n(if not stated explicitly by) information recorded, and personal\ninformation, such as account numbers, social security numbers, and credit\ncard numbers."},"help":{"text":"rationale:\nThe Ubuntu 22.04 must generate error messages that provide information\nnecessary for corrective actions without revealing information that could\nbe exploited by adversaries."},"shortDescription":{"text":"Verify permissions of log files."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"SI-11 (1) iii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_fs_protected_hardlinks","name":"EnableKernelParameterToEnforceDACOnHardlinks","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nBy enabling this kernel parameter, users can no longer create soft or hard links to\nfiles which they do not own. Disallowing such hardlinks mitigate vulnerabilities\nbased on insecure file system accessed by privileged programs, avoiding an\nexploitation vector exploiting unsafe use ofor."},"shortDescription":{"text":"Enable Kernel Parameter to Enforce DAC on Hardlinks."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_fs_protected_symlinks","name":"EnableKernelParameterToEnforceDACOnSymlinks","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nBy enabling this kernel parameter, symbolic links are permitted to be followed\nonly when outside a sticky world-writable directory, or when the UID of the\nlink and follower match, or when the directory owner matches the symlink's owner.\nDisallowing such symlinks helps mitigate vulnerabilities based on insecure file system\naccessed by privileged programs, avoiding an exploitation vector exploiting unsafe use ofor."},"shortDescription":{"text":"Enable Kernel Parameter to Enforce DAC on Symlinks."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_autofs_disabled","name":"DisableTheAutomounter","fullDescription":{"text":"Thedaemon mounts and unmounts filesystems, such as user\nhome directories shared via NFS, on demand. In addition, autofs can be used to handle\nremovable media, and the default configuration provides the cdrom device as.\nHowever, this method of providing access to removable media is not common, so autofs\ncan almost always be disabled if NFS is not in use. Even if NFS is required, it may be\npossible to configure filesystem mounts statically by editingrather than relying on the automounter.Theservice can be disabled with the following command:."},"help":{"text":"rationale:\nDisabling the automounter permits the administrator to\nstatically control filesystem mounting through.Additionally, automatically mounting filesystems permits easy introduction of\nunknown devices, thereby facilitating malicious activity."},"shortDescription":{"text":"Disable the Automounter."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_cramfs_disabled","name":"DisableMountingOfCramfs","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem.\n\nThefilesystem type is a compressed read-only\nLinux filesystem embedded in small footprint systems. Aimage can be used without having to first\ndecompress the image."},"help":{"text":"rationale:\nRemoving support for unneeded filesystem types reduces the local attack surface\nof the server."},"shortDescription":{"text":"Disable Mounting of cramfs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_freevxfs_disabled","name":"DisableMountingOfFreevxfs","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"help":{"text":"check:\noval:ssg-kernel_module_freevxfs_disabled:def:1\nrationale:\nLinux kernel modules which implement filesystems that are not needed by the\nlocal system should be disabled."},"shortDescription":{"text":"Disable Mounting of freevxfs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_hfs_disabled","name":"DisableMountingOfHfs","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"help":{"text":"check:\noval:ssg-kernel_module_hfs_disabled:def:1\nrationale:\nLinux kernel modules which implement filesystems that are not needed by the\nlocal system should be disabled."},"shortDescription":{"text":"Disable Mounting of hfs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_hfsplus_disabled","name":"DisableMountingOfHfsplus","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"help":{"text":"check:\noval:ssg-kernel_module_hfsplus_disabled:def:1\nrationale:\nLinux kernel modules which implement filesystems that are not needed by the\nlocal system should be disabled."},"shortDescription":{"text":"Disable Mounting of hfsplus."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_jffs2_disabled","name":"DisableMountingOfJffs2","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem."},"help":{"text":"check:\noval:ssg-kernel_module_jffs2_disabled:def:1\nrationale:\nLinux kernel modules which implement filesystems that are not needed by the\nlocal system should be disabled."},"shortDescription":{"text":"Disable Mounting of jffs2."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_squashfs_disabled","name":"DisableMountingOfSquashfs","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem.\n\nThefilesystem type is a compressed read-only Linux\nfilesystem embedded in small footprint systems (similar to). Aimage can be used without having\nto first decompress the image."},"help":{"text":"check:\noval:ssg-kernel_module_squashfs_disabled:def:1\nrationale:\nRemoving support for unneeded filesystem types reduces the local attack\nsurface of the system."},"shortDescription":{"text":"Disable Mounting of squashfs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_udf_disabled","name":"DisableMountingOfUdf","fullDescription":{"text":"To configure the system to prevent thekernel module from being loaded, add the following line to the file:This effectively prevents usage of this uncommon filesystem.\n\nThefilesystem type is the universal disk format\nused to implement the ISO/IEC 13346 and ECMA-167 specifications.\nThis is an open vendor filesystem type for data storage on a broad\nrange of media. This filesystem type is neccessary to support\nwriting DVDs and newer optical disc formats."},"help":{"text":"check:\noval:ssg-kernel_module_udf_disabled:def:1\nrationale:\nRemoving support for unneeded filesystem types reduces the local\nattack surface of the system."},"shortDescription":{"text":"Disable Mounting of udf."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_usb-storage_disabled","name":"DisableModprobeLoadingOfUSBStorageDriver","fullDescription":{"text":"To prevent USB storage devices from being used, configure the kernel module loading system\nto prevent automatic loading of the USB storage driver.\n\nTo configure the system to prevent thekernel module from being loaded, add the following line to the file:This will prevent theprogram from loading themodule, but will not prevent an administrator (or another program) from using theprogram to load the module manually."},"help":{"text":"rationale:\nUSB storage devices such as thumb drives can be used to introduce\nmalicious software."},"shortDescription":{"text":"Disable Modprobe Loading of USB Storage Driver."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nodev","name":"AddNodevOptionTo/dev/shm","fullDescription":{"text":"Themount option can be used to prevent creation of device\nfiles in. Legitimate character and block devices should\nnot exist within temporary directories like.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /dev/shm."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_dev_shm_noexec","name":"AddNoexecOptionTo/dev/shm","fullDescription":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nIt can be dangerous to allow the execution of binaries\nfrom world-writable temporary storage directories such as.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nAllowing users to execute binaries from world-writable directories\nsuch ascan expose the system to potential compromise."},"shortDescription":{"text":"Add noexec Option to /dev/shm."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_dev_shm_nosuid","name":"AddNosuidOptionTo/dev/shm","fullDescription":{"text":"Themount option can be used to prevent execution\nof setuid programs in.  The SUID and SGID permissions should not\nbe required in these world-writable directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from temporary storage partitions."},"shortDescription":{"text":"Add nosuid Option to /dev/shm."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_home_nodev","name":"AddNodevOptionTo/home","fullDescription":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /home."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_home_nosuid","name":"AddNosuidOptionTo/home","fullDescription":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in these user data directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from user home directory partitions."},"shortDescription":{"text":"Add nosuid Option to /home."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_tmp_nodev","name":"AddNodevOptionTo/tmp","fullDescription":{"text":"Themount option can be used to prevent device files from\nbeing created in. Legitimate character and block devices\nshould not exist within temporary directories like.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /tmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_tmp_noexec","name":"AddNoexecOptionTo/tmp","fullDescription":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nAllowing users to execute binaries from world-writable directories\nsuch asshould never be necessary in normal operation and\ncan expose the system to potential compromise."},"shortDescription":{"text":"Add noexec Option to /tmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_tmp_nosuid","name":"AddNosuidOptionTo/tmp","fullDescription":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in these world-writable directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from temporary storage partitions."},"shortDescription":{"text":"Add nosuid Option to /tmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nodev","name":"AddNodevOptionTo/var/log/audit","fullDescription":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /var/log/audit."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_noexec","name":"AddNoexecOptionTo/var/log/audit","fullDescription":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nAllowing users to execute binaries from directories containing audit log files\nsuch asshould never be necessary in normal operation and\ncan expose the system to potential compromise."},"shortDescription":{"text":"Add noexec Option to /var/log/audit."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_log_audit_nosuid","name":"AddNosuidOptionTo/var/log/audit","fullDescription":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in directories containing audit log files.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from partitions\ndesignated for audit log files."},"shortDescription":{"text":"Add nosuid Option to /var/log/audit."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_log_nodev","name":"AddNodevOptionTo/var/log","fullDescription":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /var/log."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_log_noexec","name":"AddNoexecOptionTo/var/log","fullDescription":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nAllowing users to execute binaries from directories containing log files\nsuch asshould never be necessary in normal operation and\ncan expose the system to potential compromise."},"shortDescription":{"text":"Add noexec Option to /var/log."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_log_nosuid","name":"AddNosuidOptionTo/var/log","fullDescription":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in directories containing log files.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from partitions\ndesignated for log files."},"shortDescription":{"text":"Add nosuid Option to /var/log."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_nodev","name":"AddNodevOptionTo/var","fullDescription":{"text":"Themount option can be used to prevent device files from\nbeing created in.\nLegitimate character and block devices should exist only in\nthedirectory on the root partition or within chroot\njails built for system services.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /var."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MP-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_nosuid","name":"AddNosuidOptionTo/var","fullDescription":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required for this directory.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled."},"shortDescription":{"text":"Add nosuid Option to /var."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nodev","name":"AddNodevOptionTo/var/tmp","fullDescription":{"text":"Themount option can be used to prevent device files from\nbeing created in. Legitimate character and block devices\nshould not exist within temporary directories like.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe only legitimate location for device files is thedirectory\nlocated on the root partition. The only exception to this is chroot jails."},"shortDescription":{"text":"Add nodev Option to /var/tmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_tmp_noexec","name":"AddNoexecOptionTo/var/tmp","fullDescription":{"text":"Themount option can be used to prevent binaries\nfrom being executed out of.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nAllowing users to execute binaries from world-writable directories\nsuch asshould never be necessary in normal operation and\ncan expose the system to potential compromise."},"shortDescription":{"text":"Add noexec Option to /var/tmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_mount_option_var_tmp_nosuid","name":"AddNosuidOptionTo/var/tmp","fullDescription":{"text":"Themount option can be used to prevent\nexecution of setuid programs in. The SUID and SGID permissions\nshould not be required in these world-writable directories.\nAdd theoption to the fourth column offor the line which controls mounting of."},"help":{"text":"rationale:\nThe presence of SUID and SGID executables should be tightly controlled. Users\nshould not be able to execute SUID or SGID binaries from temporary storage partitions."},"shortDescription":{"text":"Add nosuid Option to /var/tmp."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_coredump_disable_backtraces","name":"DisableCoreDumpBacktraces","fullDescription":{"text":"Theoption insection\nofspecifies the maximum size in bytes of a core which will be processed.\nCore dumps exceeding this size may be stored, but the backtrace will not\nbe generated."},"help":{"text":"rationale:\nA core dump includes a memory image taken at the time the operating system\nterminates an application. The memory image could contain sensitive data\nand is generally useful only for developers or system operators trying to\ndebug problems.\n\nEnabling core dumps on production systems is not recommended,\nhowever there may be overriding operational requirements to enable advanced\ndebuging. Permitting temporary enablement of core dumps during such situations\nshould be reviewed through local needs and policy.\nwarning:\nIf thefile\ndoes not already contain thesection,\nthe value will not be configured correctly."},"shortDescription":{"text":"Disable core dump backtraces."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_coredump_disable_storage","name":"DisableStoringCoreDump","fullDescription":{"text":"Theoption insectionofcan be set toto disable storing core dumps permanently."},"help":{"text":"rationale:\nA core dump includes a memory image taken at the time the operating system\nterminates an application. The memory image could contain sensitive data\nand is generally useful only for developers or system operators trying to\ndebug problems. Enabling core dumps on production systems is not recommended,\nhowever there may be overriding operational requirements to enable advanced\ndebuging. Permitting temporary enablement of core dumps during such situations\nshould be reviewed through local needs and policy.\nwarning:\nIf thefile\ndoes not already contain thesection,\nthe value will not be configured correctly."},"shortDescription":{"text":"Disable storing core dump."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_disable_users_coredumps","name":"DisableCoreDumpsForAllUsers","fullDescription":{"text":"To disable core dumps for all users, add the following line to, or to a file within thedirectory:."},"help":{"text":"rationale:\nA core dump includes a memory image taken at the time the operating system\nterminates an application. The memory image could contain sensitive data and is generally useful\nonly for developers trying to debug problems."},"shortDescription":{"text":"Disable Core Dumps for All Users."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (10)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_fs_suid_dumpable","name":"DisableCoreDumpsForSUIDPrograms","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nThe core dump of a setuid program is more likely to contain\nsensitive data, as the program itself runs with greater privileges than the\nuser who initiated execution of the program.  Disabling the ability for any\nsetuid program to write a core file decreases the risk of unauthorized access\nof such data."},"shortDescription":{"text":"Disable Core Dumps for SUID programs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-11 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_kernel_kptr_restrict","name":"RestrictExposedKernelPointerAddressesAccess","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nExposing kernel pointers (through procfs or) exposes kernel\nwriteable structures which may contain functions pointers. If a write vulnerability\noccurs in the kernel, allowing write access to any of this structure, the kernel can\nbe compromised. This option disallow any program without the CAP_SYSLOG capability\nto get the addresses of kernel pointers by replacing them with 0."},"shortDescription":{"text":"Restrict Exposed Kernel Pointer Addresses Access."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-30","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-30 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-30 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-16","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_kernel_randomize_va_space","name":"EnableRandomizedLayoutOfVirtualAddressSpace","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAddress space layout randomization (ASLR) makes it more difficult for an\nattacker to predict the location of attack code they have introduced into a\nprocess's address space during an attempt at exploitation. Additionally,\nASLR makes it more difficult for an attacker to know the location of\nexisting code in order to re-purpose it using return oriented programming\n(ROP) techniques."},"shortDescription":{"text":"Enable Randomized Layout of Virtual Address Space."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-30","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-30 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-16","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_bios_enable_execution_restrictions","name":"EnableNXOrXDSupportInTheBIOS","fullDescription":{"text":"Reboot the system and enter the BIOS or Setup configuration menu.\nNavigate the BIOS configuration menu and make sure that the option is enabled. The setting may be located\nunder a Security section. Look for Execute Disable (XD) on Intel-based systems and No Execute (NX)\non AMD-based systems."},"help":{"text":"rationale:\nComputers with the ability to prevent this type of code execution frequently put an option in the BIOS that will\nallow users to turn the feature on or off at will."},"shortDescription":{"text":"Enable NX or XD Support in the BIOS."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-39","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-16","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_kernel_module_uvcvideo_disabled","name":"DisableTheUvcvideoModule","fullDescription":{"text":"If the device contains a camera it should be covered or disabled when not in use."},"help":{"text":"rationale:\nFailing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information.\nProviding easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure participants actually carry out the disconnect activity without having to go through complex and tedious procedures."},"shortDescription":{"text":"Disable the uvcvideo module."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-7 (5) b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sysctl_kernel_panic_on_oops","name":"KernelPanicOnOops","fullDescription":{"text":"To set the runtime status of thekernel parameter, run the following command:To make sure that the setting is persistent, add the following line to a file in the directory:."},"help":{"text":"rationale:\nAn attacker trying to exploit the kernel may trigger kernel OOPSes,\npanicking the system will impede them from continuing.\nwarning:\nThe system may start to panic when it normally wouldn't. A non-catastrophic error that\nwould have allowed the system to continue operating will now result in a panic."},"shortDescription":{"text":"Kernel panic on oops."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_selinux_not_disabled","name":"EnsureSELinuxIsNotDisabled","fullDescription":{"text":"The SELinux state should be set toorat system boot\ntime. In the file, add or correct the following line to configure\nthe system to boot into enforcing or permissive mode:OR."},"help":{"text":"rationale:\nRunning SELinux in disabled mode is strongly discouraged. It prevents enforcing the SELinux\ncontrols without a system reboot. It also avoids labeling any persistent objects such as\nfiles, making it difficult to enable SELinux in the future.\nwarning:\nIn case the SELinux is \"disabled\", the automated remediation will adopt a more\nconservative approach and set it to \"permissive\" in order to avoid any system disruption\nand give the administrator the opportunity to assess the impact and necessary efforts\nbefore setting it to \"enforcing\", which is strongly recommended."},"shortDescription":{"text":"Ensure SELinux is Not Disabled."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_selinux_state","name":"EnsureSELinuxStateIsEnforcing","fullDescription":{"text":"The SELinux state should be set toat\nsystem boot time.  In the file, add or correct the\nfollowing line to configure the system to boot into enforcing mode:."},"help":{"text":"rationale:\nSetting the SELinux state to enforcing ensures SELinux is able to confine\npotentially compromised processes to the security policy, which is designed to\nprevent them from causing damage to the system or further elevating their\nprivileges."},"shortDescription":{"text":"Ensure SELinux State is Enforcing."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-3 (3) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-3 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-7 (21)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SI-6 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_apport_disabled","name":"DisableApportService","fullDescription":{"text":"The Apport modifies certain kernel configuration values at\nruntime which may decrease the overall security of the system and expose sensitive data.\n\nTheservice can be disabled with the following command:."},"help":{"text":"check:\noval:ssg-service_apport_disabled:def:1\nrationale:\nThe Apport service modifies the kernelconfiguration at runtime which\nprevents other hardening from being persistent. Disabling the\nservice prevents this behavior."},"shortDescription":{"text":"Disable Apport Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_apt_conf_disallow_unauthenticated","name":"DisableUnauthenticatedRepositoriesInAPTConfiguration","fullDescription":{"text":"Unauthenticated repositories should not be used for updates."},"help":{"text":"check:\noval:ssg-apt_conf_disallow_unauthenticated:def:1\nrationale:\nRepositories hosts all packages that will be intsalled on the system during update.\n    If a repository is not authenticated, the associated packages can't be trusted,\n    and then should not be installed localy."},"shortDescription":{"text":"Disable unauthenticated repositories in APT configuration."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_avahi_disable_publishing","name":"DisableAvahiPublishing","fullDescription":{"text":"To prevent Avahi from publishing its records, editand ensure the following line appears in thesection:."},"help":{"text":"rationale:\nThis helps ensure that no record will be published by Avahi."},"shortDescription":{"text":"Disable Avahi Publishing."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_avahi_removed","name":"UninstallAvahiServerPackage","fullDescription":{"text":"If the system does not need to have an Avahi server which implements\nthe DNS Service Discovery and Multicast DNS protocols,\nthe avahi-autoipd and avahi packages can be uninstalled."},"help":{"text":"rationale:\nAutomatic discovery of network services is not normally required for\nsystem functionality. It is recommended to remove this package to reduce\nthe potential attack surface."},"shortDescription":{"text":"Uninstall avahi Server Package."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_avahi-daemon_disabled","name":"DisableAvahiServerSoftware","fullDescription":{"text":"Theservice can be disabled with the following command:."},"help":{"text":"rationale:\nBecause the Avahi daemon service keeps an open network\nport, it is subject to network attacks. Its functionality\nis convenient but is only appropriate if the local network\ncan be trusted."},"shortDescription":{"text":"Disable Avahi Server Software."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_kdump_disabled","name":"DisableKDumpKernelCrashAnalyzer(kdump)","fullDescription":{"text":"Theservice provides a kernel crash dump analyzer. It uses thesystem call to boot a secondary kernel (\"capture\" kernel) following a system\ncrash, which can load information from the crashed kernel for analysis.\n\nTheservice can be disabled with the following command:."},"help":{"text":"rationale:\nKernel core dumps may contain the full contents of system memory at the\ntime of the crash. Kernel core dumps consume a considerable amount of disk\nspace and may result in denial of service by exhausting the available space\non the target file system partition. Unless the system is used for kernel\ndevelopment or testing, there is little need to run the kdump service."},"shortDescription":{"text":"Disable KDump Kernel Crash Analyzer (kdump)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-24","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_at_deny_not_exist","name":"EnsureThat/etc/at.denyDoesNotExist","fullDescription":{"text":"The fileshould not exist.\nUseinstead."},"help":{"text":"rationale:\nAccess toshould be restricted.\nIt is easier to manage an allow list than a deny list."},"shortDescription":{"text":"Ensure that /etc/at.deny does not exist."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_cron_deny_not_exist","name":"EnsureThat/etc/cron.denyDoesNotExist","fullDescription":{"text":"The fileshould not exist.\nUseinstead."},"help":{"text":"rationale:\nAccess toshould be restricted.\nIt is easier to manage an allow list than a deny list."},"shortDescription":{"text":"Ensure that /etc/cron.deny does not exist."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_at_allow","name":"VerifyGroupWhoOwns/etc/at.allowFile","fullDescription":{"text":"Ifexists, it must be group-owned by.\n\nTo properly set the group owner of, run the command:."},"help":{"text":"rationale:\nIf the owner of the at.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information."},"shortDescription":{"text":"Verify Group Who Owns /etc/at.allow file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_allow","name":"VerifyGroupWhoOwns/etc/cron.allowFile","fullDescription":{"text":"Ifexists, it must be group-owned by.\n\nTo properly set the group owner of, run the command:."},"help":{"text":"rationale:\nIf the owner of the cron.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information."},"shortDescription":{"text":"Verify Group Who Owns /etc/cron.allow file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_at_allow","name":"VerifyUserWhoOwns/etc/at.allowFile","fullDescription":{"text":"Ifexists, it must be owned by.\n\nTo properly set the owner of, run the command:."},"help":{"text":"rationale:\nIf the owner of the at.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information."},"shortDescription":{"text":"Verify User Who Owns /etc/at.allow file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_cron_allow","name":"VerifyUserWhoOwns/etc/cron.allowFile","fullDescription":{"text":"Ifexists, it must be owned by.\n\nTo properly set the owner of, run the command:."},"help":{"text":"rationale:\nIf the owner of the cron.allow file is not set to root, the possibility exists for an\nunauthorized user to view or edit sensitive information."},"shortDescription":{"text":"Verify User Who Owns /etc/cron.allow file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_at_allow","name":"VerifyPermissionsOn/etc/at.allowFile","fullDescription":{"text":"Ifexists, it must have permissionsor more restrictive.\n\n\nTo properly set the permissions of, run the command:."},"help":{"text":"rationale:\nIf the permissions of the at.allow file are not set to 0640 or more restrictive,\nthe possibility exists for an unauthorized user to view or edit sensitive information."},"shortDescription":{"text":"Verify Permissions on /etc/at.allow file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_cron_allow","name":"VerifyPermissionsOn/etc/cron.allowFile","fullDescription":{"text":"Ifexists, it must have permissionsor more restrictive.\n\n\nTo properly set the permissions of, run the command:."},"help":{"text":"rationale:\nIf the permissions of the cron.allow file are not set to 0640 or more restrictive,\nthe possibility exists for an unauthorized user to view or edit sensitive information."},"shortDescription":{"text":"Verify Permissions on /etc/cron.allow file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_cron_installed","name":"InstallTheCronService","fullDescription":{"text":"The Cron service should be installed."},"help":{"text":"rationale:\nThe cron service allow periodic job execution, needed for almost all administrative tasks and services (software update, log rotating, etc.). Access to cron service should be restricted to administrative accounts only."},"shortDescription":{"text":"Install the cron service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_cron_enabled","name":"EnableCronService","fullDescription":{"text":"Theservice is used to execute commands at\npreconfigured times. It is required by almost all systems to perform necessary\nmaintenance tasks, such as notifying root of system activity.\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nDue to its usage for maintenance and security-supporting tasks,\nenabling the cron daemon is essential."},"shortDescription":{"text":"Enable cron Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_d","name":"VerifyGroupWhoOwnsCron.d","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns cron.d."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_daily","name":"VerifyGroupWhoOwnsCron.daily","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns cron.daily."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_hourly","name":"VerifyGroupWhoOwnsCron.hourly","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns cron.hourly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_monthly","name":"VerifyGroupWhoOwnsCron.monthly","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns cron.monthly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_cron_weekly","name":"VerifyGroupWhoOwnsCron.weekly","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns cron.weekly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_crontab","name":"VerifyGroupWhoOwnsCrontab","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns Crontab."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_cron_d","name":"VerifyOwnerOnCron.d","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on cron.d."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_cron_daily","name":"VerifyOwnerOnCron.daily","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on cron.daily."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_cron_hourly","name":"VerifyOwnerOnCron.hourly","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on cron.hourly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_cron_monthly","name":"VerifyOwnerOnCron.monthly","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on cron.monthly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_cron_weekly","name":"VerifyOwnerOnCron.weekly","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on cron.weekly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_crontab","name":"VerifyOwnerOnCrontab","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should be owned by the\ncorrect user to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on crontab."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_cron_d","name":"VerifyPermissionsOnCron.d","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on cron.d."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_cron_daily","name":"VerifyPermissionsOnCron.daily","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on cron.daily."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_cron_hourly","name":"VerifyPermissionsOnCron.hourly","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on cron.hourly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_cron_monthly","name":"VerifyPermissionsOnCron.monthly","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on cron.monthly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_cron_weekly","name":"VerifyPermissionsOnCron.weekly","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on cron.weekly."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_crontab","name":"VerifyPermissionsOnCrontab","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective services that if configured incorrectly\ncan lead to insecure and vulnerable configurations. Therefore, service configuration files should have the\ncorrect access rights to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on crontab."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_inetutils-telnetd_removed","name":"UninstallTheInet-basedTelnetServer","fullDescription":{"text":"The inet-based telnet daemon should be uninstalled."},"help":{"text":"check:\noval:ssg-package_inetutils-telnetd_removed:def:1\nrationale:\nallows clear text communications, and does not protect any\ndata transmission between client and server. Any confidential data can be\nlistened and no integrity checking is made."},"shortDescription":{"text":"Uninstall the inet-based telnet server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_nis_removed","name":"UninstallTheNisPackage","fullDescription":{"text":"The support for Yellowpages should not be installed unless it is required."},"help":{"text":"check:\noval:ssg-package_nis_removed:def:1\nrationale:\nNIS is the historical SUN service for central account management, more and more replaced by LDAP.\nNIS does not support efficiently security constraints, ACL, etc. and should not be used."},"shortDescription":{"text":"Uninstall the nis package."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_ntpdate_removed","name":"UninstallTheNtpdatePackage","fullDescription":{"text":"ntpdate is a historical ntp synchronization client for unixes. It sould be uninstalled."},"help":{"text":"check:\noval:ssg-package_ntpdate_removed:def:1\nrationale:\nntpdate is an old not security-compliant ntp client. It should be replaced by modern ntp clients such as ntpd, able to use cryptographic mechanisms integrated in NTP."},"shortDescription":{"text":"Uninstall the ntpdate package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_telnetd-ssl_removed","name":"UninstallTheSslCompliantTelnetServer","fullDescription":{"text":"Thedaemon, even with ssl support, should be uninstalled."},"help":{"text":"check:\noval:ssg-package_telnetd-ssl_removed:def:1\nrationale:\n, even with ssl support, should not be installed.\nWhen remote shell is required, up-to-date ssh daemon can be used."},"shortDescription":{"text":"Uninstall the ssl compliant telnet server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_telnetd_removed","name":"UninstallTheTelnetServer","fullDescription":{"text":"The telnet daemon should be uninstalled."},"help":{"text":"check:\noval:ssg-package_telnetd_removed:def:1\nrationale:\nallows clear text communications, and does not protect\nany data transmission between client and server. Any confidential data\ncan be listened and no integrity checking is made.'"},"shortDescription":{"text":"Uninstall the telnet server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dhcp_client_restrict_options","name":"MinimizeTheDHCP-ConfiguredOptions","fullDescription":{"text":"Create the file, and add an\nappropriate setting for each of the ten configuration settings which can be\nobtained via DHCP. For each setting, do one of the following:If the setting shouldbe configured remotely by the DHCP server,\nselect an appropriate static value, and add the line:If the setting should be configured remotely by the DHCP server, add the lines:For example, suppose the DHCP server should provide only the IP address itself\nand the subnet mask. Then the entire file should look like:."},"help":{"text":"rationale:\nBy default, the DHCP client program, dhclient, requests and applies\nten configuration options (in addition to the IP address) from the DHCP server.\nsubnet-mask, broadcast-address, time-offset, routers, domain-name,\ndomain-name-servers, host-name, nis-domain, nis-servers, and ntp-servers.  Many\nof the options requested and applied by dhclient may be the same for every\nsystem on a network. It is recommended that almost all configuration options be\nassigned statically, and only options which must vary on a host-by-host basis\nbe assigned via DHCP. This limits the damage which can be done by a rogue DHCP\nserver.  If appropriate for your site, it is also possible to supersede the\nhost-name directive in, establishing a static\nhostname for the system. However, dhclient does not use the host name option\nprovided by the DHCP server (instead using the value provided by a reverse DNS\nlookup).\nwarning:\nIn this example, the options nis-servers and\nnis-domain are set to empty strings, on the assumption that the deprecated NIS\nprotocol is not in use. It is necessary to supersede settings for unused\nservices so that they cannot be set by a hostile DHCP server. If an option is\nset to an empty string, dhclient will typically not attempt to configure the\nservice."},"shortDescription":{"text":"Minimize the DHCP-Configured Options."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_dhcp_server_minimize_served_info","name":"MinimizeServedInformation","fullDescription":{"text":"Edit /etc/dhcp/dhcpd.conf. Examine each address range section within\nthe file, and ensure that the following options are not defined unless there is\nan operational need to provide this information via DHCP:."},"help":{"text":"rationale:\nBecause the configuration information provided by the DHCP server\ncould be maliciously provided to clients by a rogue DHCP server, the amount of\ninformation provided via DHCP should be minimized. Remove these definitions\nfrom the DHCP server configuration to ensure that legitimate clients do not\nunnecessarily rely on DHCP for this information.\nwarning:\nBy default, the Red Hat Enterprise Linux client installation uses DHCP\nto request much of the above information from the DHCP server. In particular,\ndomain-name, domain-name-servers, and routers are configured via DHCP.  These\nsettings are typically necessary for proper network functionality, but are also\nusually static across systems at a given site."},"shortDescription":{"text":"Minimize Served Information."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_dhcp_removed","name":"UninstallDHCPServerPackage","fullDescription":{"text":"If the system does not need to act as a DHCP server,\nthe dhcp package can be uninstalled.\n\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nRemoving the DHCP server ensures that it cannot be easily or\naccidentally reactivated and disrupt network operation."},"shortDescription":{"text":"Uninstall DHCP Server Package."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_bind_removed","name":"UninstallBindPackage","fullDescription":{"text":"Theservice is provided by thepackage.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make DNS server software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall bind Package."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_fapolicyd_prevent_home_folder_access","name":"FapolicydMustBeConfiguredToLimitAccessToUsersHomeFolders","fullDescription":{"text":"fapolicyd needs be configured so that users cannot give access to their home folders to other users."},"help":{"text":"rationale:\nUsers' home directories/folders may contain information of a sensitive nature.\nNon-privileged users should coordinate any sharing of information with a System Administrator (SA) through shared resources.\nfapolicyd can confine users to their home directory, not allowing them to make any changes outside of their own home directories.\nConfining users to their home directory will minimize the risk of sharing information.\nwarning:\nThis rule is deprecated and there is no replacement at this time.\nPrevious versions of this rule provided fixtext that would cause fapolicyd not to start."},"shortDescription":{"text":"fapolicyd Must be Configured to Limit Access to Users Home Folders."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_vsftpd_removed","name":"UninstallVsftpdPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nRemoving thepackage decreases the risk of its\naccidental activation."},"shortDescription":{"text":"Uninstall vsftpd Package."},"defaultConfiguration":{"level":"error"},"properties":{"security-severity":"7","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (1) ii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (1) v.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (c)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ftp_limit_users","name":"LimitUsersAllowedFTPAccessIfNecessary","fullDescription":{"text":"If there is a mission-critical reason for users to access their accounts via the insecure FTP protocol, limit the set of users who are allowed this access. Edit the vsftpd configuration file. Add or correct the following configuration options:Edit the file. For each user USERNAME who should be allowed to access the system via FTP, add a line containing that user's name:If anonymous access is also required, add the anonymous usernames toas well."},"help":{"text":"rationale:\nHistorically, the filecontained a list of users who were not allowed to access the system via FTP. It was used to prevent system users such as the root user from logging in via the insecure FTP protocol. However, when the configuration optionis set, vsftpd interprets ftpusers as the set of users who are allowed to login via FTP. Since it should be possible for most users to access their accounts via secure protocols, it is recommended that this setting be used, so that non-anonymous FTP access can be limited to legacy users who have been explicitly identified."},"shortDescription":{"text":"Limit Users Allowed FTP Access if Necessary."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ftp_configure_firewall","name":"ConfigureFirewallsToProtectTheFTPServer","fullDescription":{"text":"By default,blocks access to the ports used by the web server.\n\nTo configureto allow port 21 traffic, one must editand(if IPv6 is in use).\nAdd the following line, ensuring that it appears before the final LOG and DROP lines for the INPUT chain:Edit the file. Ensure that the space-separated list of modules contains\nthe FTP connection tracking module:."},"help":{"text":"rationale:\nThese settings configure the firewall to allow connections to an FTP server.\n\n\nThe first line allows initial connections to the FTP server port.\nFTP is an older protocol which is not very compatible with firewalls. During the initial FTP dialogue, the client\nand server negotiate an arbitrary port to be used for data transfer. Themodule is used by\niptables to listen to that dialogue and allow connections to the data ports which FTP negotiates. This allows an\nFTP server to operate on a system which is running a firewall."},"shortDescription":{"text":"Configure Firewalls to Protect the FTP Server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_httpd_removed","name":"UninstallHttpdPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make the web server software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall httpd Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_nginx_removed","name":"UninstallNginxPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make the web server software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall nginx Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_cyrus-imapd_removed","name":"UninstallCyrus-imapdPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make the cyrus-imapd software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall cyrus-imapd Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_dovecot_removed","name":"UninstallDovecotPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make the Dovecot software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall dovecot Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_openldap-clients_removed","name":"EnsureLDAPClientIsNotInstalled","fullDescription":{"text":"The Lightweight Directory Access Protocol (LDAP) is a service that provides\na method for looking up information from a central database.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf the system does not need to act as an LDAP client, it is recommended that the software is removed to reduce the potential attack surface."},"shortDescription":{"text":"Ensure LDAP client is not installed."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_openldap-servers_removed","name":"UninstallOpenldap-serversPackage","fullDescription":{"text":"The slapd package is not installed by default on a Ubuntu 22.04\nsystem. It is needed only by the OpenLDAP server, not by the\nclients which use LDAP for authentication. If the system is not\nintended for use as an LDAP Server it should be removed."},"help":{"text":"rationale:\nUnnecessary packages should not be installed to decrease the attack\nsurface of the system.  While this software is clearly essential on an LDAP\nserver, it is not necessary on typical desktop or workstation systems."},"shortDescription":{"text":"Uninstall openldap-servers Package."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_postfix_client_configure_mail_alias","name":"ConfigureSystemToForwardAllMailForTheRootAccount","fullDescription":{"text":"Make sure that mails delivered to root user are forwarded to a monitored\nemail address. Make sure that the addressis a valid email address\nreachable from the system in question. Use the following command to\nconfigure the alias:."},"help":{"text":"rationale:\nA number of system services utilize email messages sent to the root user to\nnotify system administrators of active or impending issues.  These messages must\nbe forwarded to at least one monitored email address."},"shortDescription":{"text":"Configure System to Forward All Mail For The Root Account."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_postfix_client_configure_mail_alias_postmaster","name":"ConfigureSystemToForwardAllMailFromPostmasterToTheRootAccount","fullDescription":{"text":"Verify the administrators are notified in the event of an audit processing failure.\nCheck that the \"/etc/aliases\" file has a defined value for \"root\"."},"help":{"text":"rationale:\nIt is critical for the appropriate personnel to be aware if a system is at risk of failing to\nprocess audit logs as required. Without this notification, the security personnel may be\nunaware of an impending failure of the audit capability, and system operation may be adversely\naffected.\n\nAudit processing failures include software/hardware errors, failures in the audit capturing\nmechanisms, and audit storage capacity being reached or exceeded."},"shortDescription":{"text":"Configure System to Forward All Mail From Postmaster to The Root Account."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-5 (1) ii.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-5 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_postfix_client_configure_relayhost","name":"ConfigureSystemToForwardAllMailThroughASpecificHost","fullDescription":{"text":"Set up a relay host that will act as a gateway for all outbound email.\nEdit the fileto ensure that only the followingline appears:."},"help":{"text":"check:\nocil:ssg-postfix_client_configure_relayhost_ocil:questionnaire:1\nrationale:\nA central outbound email location ensures messages sent from any network host\ncan be audited for potential unexpected content.  Tooling on the central server\nmay help prevent spam or viruses from being delivered."},"shortDescription":{"text":"Configure System to Forward All Mail through a specific host."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_postfix_network_listening_disabled","name":"DisablePostfixNetworkListening","fullDescription":{"text":"Edit the fileto ensure that only the followingline appears:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { dpkg-query --show --showformat='${db:Status-Status}\\n' 'postfix' 2>/dev/null | grep -q installed; }; then\n\nvar_postfix_inet_interfaces=''\n\n\nif [ -e \"/etc/postfix/main.cf\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*inet_interfaces\\s\\+=\\s\\+/Id\" \"/etc/postfix/main.cf\"\nelse\n    touch \"/etc/postfix/main.cf\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/postfix/main.cf\"\n\ncp \"/etc/postfix/main.cf\" \"/etc/postfix/main.cf.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"inet_interfaces=$var_postfix_inet_interfaces\" >> \"/etc/postfix/main.cf\"\n# Clean up after ourselves.\nrm \"/etc/postfix/main.cf.bak\"\n\nsystemctl restart postfix\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nThis ensuresaccepts mail messages\n(such as cron job reports) from the local system only,\nand not from the network, which protects it from network attack."},"shortDescription":{"text":"Disable Postfix Network Listening."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_postfix_installed","name":"ThePostfixPackageIsInstalled","fullDescription":{"text":"A mail server is required for sending emails.\nThepackage can be installed with the following command:."},"help":{"text":"rationale:\nEmails can be used to notify designated personnel about important\nsystem events such as failures or warnings."},"shortDescription":{"text":"The Postfix package is installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_postfix_enabled","name":"EnablePostfixService","fullDescription":{"text":"The Postfix mail transfer agent is used for local mail delivery\nwithin the system. The default configuration only listens for connections to\nthe default SMTP port (port 25) on the loopback interface (127.0.0.1).  It is\nrecommended to leave this service enabled for local mail delivery.\n\nTheservice can be enabled with the following command:."},"help":{"text":"rationale:\nLocal mail delivery is essential to some system maintenance and\nnotification tasks."},"shortDescription":{"text":"Enable Postfix Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_has_nonlocal_mta","name":"EnsureMailTransferAgentIsNotListeningOnAnyNon-loopbackAddress","fullDescription":{"text":"Mail Transfer Agents (MTA), such as sendmail and Postfix, are used to\nlisten for incoming mail and transfer the messages to the appropriate\nuser or mail server. If the system is not intended to be a mail server,\nit is recommended that the MTA be configured to only process local mail."},"help":{"text":"rationale:\nThe software for all Mail Transfer Agents is complex and most have a\nlong history of security issues. While it is important to ensure that\nthe system can process local mail messages, it is not necessary to have\nthe MTA's daemon listening on a port unless the server is intended to\nbe a mail server that receives and processes mail from other systems."},"shortDescription":{"text":"Ensure Mail Transfer Agent is not Listening on any non-loopback Address."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_netfs_disabled","name":"DisableNetworkFileSystems(netfs)","fullDescription":{"text":"The netfs script manages the boot-time mounting of several types\nof networked filesystems, of which NFS and Samba are the most common. If these\nfilesystem types are not in use, the script can be disabled, protecting the\nsystem somewhat against accidental or malicious changes toand against flaws in the netfs script itself.\n\nTheservice can be disabled with the following command:."},"help":{"text":"check:\noval:ssg-service_netfs_disabled:def:1"},"shortDescription":{"text":"Disable Network File Systems (netfs)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_rpcbind_removed","name":"UninstallRpcbindPackage","fullDescription":{"text":"The rpcbind utility maps RPC services to the ports on which they listen.\nRPC processes notify rpcbind when they start, registering the ports they\nare listening on and the RPC program numbers they expect to serve. The\nrpcbind service redirects the client to the proper port number so it can\ncommunicate with the requested service. If the system does not require RPC\n(such as for NFS servers) then this service should be disabled.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf the system does not require rpc based services, it is recommended that\nrpcbind be disabled to reduce the attack surface."},"shortDescription":{"text":"Uninstall rpcbind Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_all_squash_exports","name":"EnsureAll-SquashingDisabledOnAllExports","fullDescription":{"text":"Themaps all uids and gids to an anonymous user.\nThis should be disabled by removing any instances of theoption from the file."},"help":{"text":"check:\nocil:ssg-no_all_squash_exports_ocil:questionnaire:1\nrationale:\nThe all_squash option maps all client requests to a single anonymous\nuid/gid on the NFS server, negating the ability to track file access\nby user ID."},"shortDescription":{"text":"Ensure All-Squashing Disabled On All Exports."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_nfs-kernel-server_removed","name":"UninstallNfs-kernel-serverPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf the system does not export NFS shares or act as an NFS client, it is\nrecommended that these services be removed to reduce the remote attack\nsurface."},"shortDescription":{"text":"Uninstall nfs-kernel-server Package."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_chrony_installed","name":"TheChronyPackageIsInstalled","fullDescription":{"text":"System time should be synchronized between all systems in an environment. This is\ntypically done by establishing an authoritative time server or set of servers and having all\nsystems synchronize their clocks to them.\nThepackage can be installed with the following command:."},"help":{"text":"rationale:\nTime synchronization is important to support time sensitive security mechanisms like\nKerberos and also ensures log files have consistent time records across the enterprise,\nwhich aids in forensic investigations."},"shortDescription":{"text":"The Chrony package is installed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_ntp_installed","name":"InstallTheNtpService","fullDescription":{"text":"The ntpd service should be installed."},"help":{"text":"rationale:\nTime synchronization (using NTP) is required by almost all network and administrative tasks (syslog, cryptographic based services (authentication, etc.), etc.). Ntpd is regulary maintained and updated, supporting security features such as RFC 5906."},"shortDescription":{"text":"Install the ntp service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_timesyncd_installed","name":"InstallTheSystemd_timesyncdService","fullDescription":{"text":"The systemd_timesyncd service should be installed."},"help":{"text":"check:\noval:ssg-package_timesyncd_installed:def:1\nrationale:\nTime synchronization (using NTP) is required by almost all network and administrative tasks (syslog, cryptographic based services (authentication, etc.), etc.). systemd_timesyncd is a part of the systemd suite and acts as a NTP client."},"shortDescription":{"text":"Install the systemd_timesyncd Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_chronyd_enabled","name":"TheChronydServiceIsEnabled","fullDescription":{"text":"chrony is a daemon which implements the Network Time Protocol (NTP) is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on chrony can be found at.\nChrony can be configured to be a client and/or a server.\nTo enable Chronyd service, you can run:This recommendation only applies if chrony is in use on the system."},"help":{"text":"rationale:\nIf chrony is in use on the system proper configuration is vital to ensuring time\nsynchronization is working properly."},"shortDescription":{"text":"The Chronyd service is enabled."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_ntp_enabled","name":"EnableTheNTPDaemon","fullDescription":{"text":"Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nEnabling theservice ensures that theservice will be running and that the system will synchronize its time to\nany servers specified. This is important whether the system is configured to be\na client (and synchronize only its own clock) or it is also acting as an NTP\nserver to other systems.  Synchronizing time is essential for authentication\nservices such as Kerberos, but it is also important for maintaining accurate\nlogs and auditing possible security breaches.The NTP daemon offers all of the functionality of, which is now\ndeprecated."},"shortDescription":{"text":"Enable the NTP Daemon."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_ntpd_enabled","name":"EnableTheNTPDaemon","fullDescription":{"text":"Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nEnabling theservice ensures that theservice will be running and that the system will synchronize its time to\nany servers specified. This is important whether the system is configured to be\na client (and synchronize only its own clock) or it is also acting as an NTP\nserver to other systems.  Synchronizing time is essential for authentication\nservices such as Kerberos, but it is also important for maintaining accurate\nlogs and auditing possible security breaches.The NTP daemon offers all of the functionality of, which is now\ndeprecated."},"shortDescription":{"text":"Enable the NTP Daemon."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_timesyncd_enabled","name":"EnableSystemd_timesyncdService","fullDescription":{"text":"Theservice can be enabled with the following command:."},"help":{"text":"rationale:\nEnabling theservice ensures that this host\nuses the ntp protocol to fetch time data from a ntp server.\nSynchronizing time is essential for authentication\nservices such as Kerberos, but it is also important for maintaining accurate\nlogs and auditing possible security breaches.Additional information on Ubuntu network time protocol is\navailable at."},"shortDescription":{"text":"Enable systemd_timesyncd Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_chronyd_or_ntpd_set_maxpoll","name":"ConfigureTimeServiceMaxpollInterval","fullDescription":{"text":"Theshould be configured toinorto continuously poll time servers. To configureinoradd the following after each `server`, `pool` or `peer` entry:todirectives. If using chrony anydirectives\nshould be configured too.\nIf noordirectives are configured, the rule evaluates\nto pass."},"help":{"text":"rationale:\nInaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints)."},"shortDescription":{"text":"Configure Time Service Maxpoll Interval."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-12 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_chronyd_run_as_chrony_user","name":"EnsureThatChronydIsRunningUnderChronyUserAccount","fullDescription":{"text":"chrony is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on chrony can be found at.\nChrony can be configured to be a client and/or a server.\nTo ensure that chronyd is running under chrony user account,variable inis set toor is\nabsent:This recommendation only applies if chrony is in use on the system."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { dpkg-query --show --showformat='${db:Status-Status}\\n' 'chrony' 2>/dev/null | grep -q installed; }; then\n\n# Strip any search characters in the key arg so that the key can be replaced without\n# adding any search characters to the config file.\nstripped_key=$(sed 's/[\\^=\\$,;+]*//g' <<< \"^user\")\n\n# shellcheck disable=SC2059\nprintf -v formatted_output \"%s %s\" \"$stripped_key\" \"_chrony\"\n\n# If the key exists, change it. Otherwise, add it to the config_file.\n# We search for the key string followed by a word boundary (matched by \\>),\n# so if we search for 'setting', 'setting2' won't match.\nif LC_ALL=C grep -q -m 1 -i -e \"^user\\\\>\" \"/etc/chrony/chrony.conf\"; then\n    escaped_formatted_output=$(sed -e 's|/|\\\\/|g' <<< \"$formatted_output\")\n    LC_ALL=C sed -i --follow-symlinks \"s/^user\\\\>.*/$escaped_formatted_output/gi\" \"/etc/chrony/chrony.conf\"\nelse\n    if [[ -s \"/etc/chrony/chrony.conf\" ]] && [[ -n \"$(tail -c 1 -- \"/etc/chrony/chrony.conf\" || true)\" ]]; then\n        LC_ALL=C sed -i --follow-symlinks '$a'\\\\ \"/etc/chrony/chrony.conf\"\n    fi\n    printf '%s\\n' \"$formatted_output\" >> \"/etc/chrony/chrony.conf\"\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIf chrony is in use on the system proper configuration is vital to ensuring time synchronization\nis working properly."},"shortDescription":{"text":"Ensure that chronyd is running under chrony user account."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_chronyd_server_directive","name":"EnsureChronyIsOnlyConfiguredWithTheServerDirective","fullDescription":{"text":"Check that Chrony only has time sources configured with thedirective."},"help":{"text":"rationale:\nDepending on the infrastructure being used thedirective may not be supported.\nwarning:\nThis rule doesn't come with a remediation, the time source needs to be added by the administrator."},"shortDescription":{"text":"Ensure Chrony is only configured with the server directive."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_chronyd_specify_remote_server","name":"ARemoteTimeServerForChronyIsConfigured","fullDescription":{"text":"is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information oncan be found at.can be configured to be a client and/or a server.\nAdd or edit server or pool lines toas appropriate:Multiple servers may be configured."},"help":{"text":"rationale:\nIfis in use on the system proper configuration is vital to ensuring time\nsynchronization is working properly."},"shortDescription":{"text":"A remote time server for Chrony is configured."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_chronyd_sync_clock","name":"SynchronizeInternalInformationSystemClocks","fullDescription":{"text":"Synchronizing internal information system clocks provides uniformity\nof time stamps for information systems with multiple system clocks and\nsystems connected over a network."},"help":{"text":"rationale:\nInaccurate time stamps make it more difficult to correlate events and\ncan lead to an inaccurate analysis. Determining the correct time a\nparticular event occurred on a system is critical when conducting\nforensic analysis and investigating system events."},"shortDescription":{"text":"Synchronize internal information system clocks."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1) (b)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ntpd_configure_restrictions","name":"ConfigureServerRestrictionsForNtpd","fullDescription":{"text":"ntpd is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on NTP can be found at.\nntp can be configured to be a client and/or a server.\nTo ensure that ntpd implements correct server restrictions, make sure that the following lines exist in the file:This recommendation only applies if ntp is in use on the system."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { dpkg-query --show --showformat='${db:Status-Status}\\n' 'ntp' 2>/dev/null | grep -q installed; }; then\n\nif [ -e \"/etc/ntp.conf\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*restrict \\-4\\s\\+/Id\" \"/etc/ntp.conf\"\nelse\n    touch \"/etc/ntp.conf\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ntp.conf\"\n\ncp \"/etc/ntp.conf\" \"/etc/ntp.conf.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"restrict -4 default kod nomodify notrap nopeer noquery\" >> \"/etc/ntp.conf\"\n# Clean up after ourselves.\nrm \"/etc/ntp.conf.bak\"\nif [ -e \"/etc/ntp.conf\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*restrict \\-6\\s\\+/Id\" \"/etc/ntp.conf\"\nelse\n    touch \"/etc/ntp.conf\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ntp.conf\"\n\ncp \"/etc/ntp.conf\" \"/etc/ntp.conf.bak\"\n# Insert at the end of the file\nprintf '%s\\n' \"restrict -6 default kod nomodify notrap nopeer noquery\" >> \"/etc/ntp.conf\"\n# Clean up after ourselves.\nrm \"/etc/ntp.conf.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIf ntp is in use on the system proper configuration is vital to ensuring time synchronization\nis working properly."},"shortDescription":{"text":"Configure server restrictions for ntpd."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ntpd_run_as_ntp_user","name":"ConfigureNtpdToRunAsNtpUser","fullDescription":{"text":"ntp is a daemon which implements the Network Time Protocol (NTP). It is designed to\nsynchronize system clocks across a variety of systems and use a source that is highly\naccurate. More information on NTP can be found at.\nntp can be configured to be a client and/or a server.\nTo ensure that ntpd is running as ntp user, Add or edit thevariable into include ' -u ntp:ntp ':This recommendation only applies if ntp is in use on the system."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ] && { dpkg-query --show --showformat='${db:Status-Status}\\n' 'ntp' 2>/dev/null | grep -q installed; }; then\n\nif grep -q 'OPTIONS=.*' /etc/sysconfig/ntpd; then\n\t# trying to solve cases where the parameter after OPTIONS\n\t#may or may not be enclosed in quotes\n\tsed -i -E 's/^([\\s]*OPTIONS=[\"]?[^\"]*)(\"?)/\\1 -u ntp:ntp\\2/' /etc/sysconfig/ntpd\nelse\n\techo 'OPTIONS=\"-u ntp:ntp\"' >> /etc/sysconfig/ntpd\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nIf ntp is in use on the system proper configuration is vital to ensuring time synchronization\nis working properly. Running ntpd under dedicated user accounts limits the attack surface for\npotential attacker exploiting security flaws in the daemon or the protocol."},"shortDescription":{"text":"Configure ntpd To Run As ntp User."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ntpd_specify_multiple_servers","name":"SpecifyAdditionalRemoteNTPServers","fullDescription":{"text":"Additional NTP servers can be specified for time synchronization\nin the file.  To do so, add additional lines of the\nfollowing form, substituting the IP address or hostname of a remote NTP server for:."},"help":{"text":"check:\noval:ssg-ntpd_specify_multiple_servers:def:1\nrationale:\nSpecifying additional NTP servers increases the availability of\naccurate time data, in the event that one of the specified servers becomes\nunavailable. This is typical for a system acting as an NTP server for\nother systems."},"shortDescription":{"text":"Specify Additional Remote NTP Servers."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AU-8 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_ntpd_specify_remote_server","name":"SpecifyARemoteNTPServer","fullDescription":{"text":"To specify a remote NTP server for time synchronization, edit\nthe file. Add or correct the following lines,\nsubstituting the IP or hostname of a remote NTP server for:This instructs the NTP software to contact that remote server to obtain time\ndata."},"help":{"text":"rationale:\nSynchronizing with an NTP server makes it possible\nto collate system logs from multiple sources or correlate computer events with\nreal time events."},"shortDescription":{"text":"Specify a Remote NTP Server."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AU-8 (1) a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_xinetd_removed","name":"UninstallXinetdPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nRemoving thepackage decreases the risk of the\nxinetd service's accidental (or intentional) activation."},"shortDescription":{"text":"Uninstall xinetd Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_rsh-server_removed","name":"UninstallRsh-serverPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nTheservice provides unencrypted remote access service which does not\nprovide for the confidentiality and integrity of user passwords or the remote session and has very weak\nauthentication. If a privileged user were to login using this service, the privileged user password\ncould be compromised. Thepackage provides several obsolete and insecure\nnetwork services. Removing it decreases the risk of those services' accidental (or intentional)\nactivation."},"shortDescription":{"text":"Uninstall rsh-server Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_rsh_removed","name":"UninstallRshPackage","fullDescription":{"text":"Thepackage contains the client commands\n\nfor the rsh services."},"help":{"text":"rationale:\nThese legacy clients contain numerous security exposures and have\nbeen replaced with the more secure SSH package. Even if the server is removed,\nit is best to ensure the clients are also removed to prevent users from\ninadvertently attempting to use these commands and therefore exposing\n\ntheir credentials. Note that removing thepackage removes\n\nthe clients for,, and."},"shortDescription":{"text":"Uninstall rsh Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_no_rsh_trust_files","name":"RemoveRshTrustFiles","fullDescription":{"text":"The filesand(in\neach user's home directory) list remote hosts and users that are trusted by the\nlocal system when using the rshd daemon.\nTo remove these files, run the following command to delete them from any\nlocation:."},"help":{"text":"fix:\nfind /root -xdev -type f -name \".rhosts\" -exec rm -f {} \\;\nfind /home -maxdepth 2 -xdev -type f -name \".rhosts\" -exec rm -f {} \\;\nrm -f /etc/hosts.equiv\nrationale:\nThis action is only meaningful ifsupport is permitted\nthrough PAM. Trust files are convenient, but when used in conjunction with\nthe R-services, they can allow unauthenticated access to a system."},"shortDescription":{"text":"Remove Rsh Trust Files."},"defaultConfiguration":{"level":"error"},"properties":{"security-severity":"7","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (8)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_talk_removed","name":"UninstallTalkPackage","fullDescription":{"text":"Thepackage contains the client program for the\nInternet talk protocol, which allows the user to chat with other users on\ndifferent systems. Talk is a communication program which copies lines from one\nterminal to the terminal of another user.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nThe talk software presents a security risk as it uses unencrypted protocols\nfor communications. Removing thepackage decreases the\nrisk of the accidental (or intentional) activation of talk client program."},"shortDescription":{"text":"Uninstall talk Package."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_telnet_removed","name":"RemoveTelnetClients","fullDescription":{"text":"The telnet client allows users to start connections to other systems via\nthe telnet protocol."},"help":{"text":"rationale:\nTheprotocol is insecure and unencrypted. The use\nof an unencrypted transmission medium could allow an unauthorized user\nto steal credentials. Thepackage provides an\nencrypted session and stronger security and is included in Ubuntu 22.04."},"shortDescription":{"text":"Remove telnet Clients."},"properties":{"security-severity":"3","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_rsync_removed","name":"UninstallRsyncPackage","fullDescription":{"text":"The rsyncd service can be used to synchronize files between systems over network links.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nThe rsyncd service presents a security risk as it uses unencrypted protocols for\ncommunication."},"shortDescription":{"text":"Uninstall rsync Package."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_cups_removed","name":"UninstallCUPSPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf the system does not need to print jobs or accept print jobs from other systems, it is\nrecommended that CUPS be removed to reduce the potential attack surface."},"shortDescription":{"text":"Uninstall CUPS Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_cups_disabled","name":"DisableTheCUPSService","fullDescription":{"text":"Theservice can be disabled with the following command:."},"help":{"text":"rationale:\nTurn off unneeded services to reduce attack surface."},"shortDescription":{"text":"Disable the CUPS Service."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_squid_removed","name":"UninstallSquidPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make the proxy server software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall squid Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_samba_removed","name":"UninstallSambaPackage","fullDescription":{"text":"Thepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to make the Samba software available,\nremoving it provides a safeguard against its activation."},"shortDescription":{"text":"Uninstall Samba Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_net-snmp_removed","name":"UninstallNet-snmpPackage","fullDescription":{"text":"Thepackage provides the snmpd service.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nIf there is no need to run SNMP server software,\nremoving the package provides a safeguard against its\nactivation."},"shortDescription":{"text":"Uninstall net-snmp Package."},"defaultConfiguration":{"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_keepalive_0","name":"SetSSHClientAliveCountMaxToZero","fullDescription":{"text":"The SSH server sends at mostmessages\nduring a SSH session and waits for a response from the SSH client.\nThe optionconfigures timeout after\neachmessage. If the SSH server does not\nreceive a response from the client, then the connection is considered unresponsive\nand terminated.\n\nTo ensure the SSH timeout occurs precisely when theis set, set theto\nvalue ofin:."},"help":{"text":"rationale:\nThis ensures a user login will be terminated as soon as theis reached."},"shortDescription":{"text":"Set SSH Client Alive Count Max to zero."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-12","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 e","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_keepalive","name":"SetSSHClientAliveCountMax","fullDescription":{"text":"The SSH server sends at mostmessages\nduring a SSH session and waits for a response from the SSH client.\nThe optionconfigures timeout after\neachmessage. If the SSH server does not\nreceive a response from the client, then the connection is considered unresponsive\nand terminated.\nFor SSH earlier than v8.2, avalue ofcauses a timeout precisely when theis set.\nStarting with v8.2, a value ofdisables the timeout functionality\ncompletely. If the option is set to a number greater than, then\nthe session will be disconnected afterseconds without receiving\na keep alive message."},"help":{"text":"rationale:\nThis ensures a user login will be terminated as soon as theis reached."},"shortDescription":{"text":"Set SSH Client Alive Count Max."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-12","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 e","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_idle_timeout","name":"SetSSHClientAliveInterval","fullDescription":{"text":"SSH allows administrators to set a network responsiveness timeout interval.\nAfter this interval has passed, the unresponsive client will be automatically logged out.To set this timeout interval, edit the following line inas\nfollows:The timeoutis given in seconds. For example, have a timeout\nof 10 minutes, setto 600.If a shorter timeout has already been set for the login shell, that value will\npreempt any SSH setting made in. Keep in mind that\nsome processes may stop SSH from correctly detecting that the user is idle."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_idle_timeout_value=''\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*ClientAliveInterval\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert before the line matching the regex '^Match'.\nline_number=\"$(LC_ALL=C grep -n \"^Match\" \"/etc/ssh/sshd_config.bak\" | LC_ALL=C sed 's/:.*//g')\"\nif [ -z \"$line_number\" ]; then\n    # There was no match of '^Match', insert at\n    # the end of the file.\n    printf '%s\\n' \"ClientAliveInterval $sshd_idle_timeout_value\" >> \"/etc/ssh/sshd_config\"\nelse\n    head -n \"$(( line_number - 1 ))\" \"/etc/ssh/sshd_config.bak\" > \"/etc/ssh/sshd_config\"\n    printf '%s\\n' \"ClientAliveInterval $sshd_idle_timeout_value\" >> \"/etc/ssh/sshd_config\"\n    tail -n \"+$(( line_number ))\" \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\nfi\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nTerminating an idle ssh session within a short time period reduces the window of\nopportunity for unauthorized personnel to take control of a management session\nenabled on the console or console port that has been let unattended."},"shortDescription":{"text":"Set SSH Client Alive Interval."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-12","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 e","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-10","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_disable_host_auth","name":"DisableHost-BasedAuthentication","fullDescription":{"text":"SSH's cryptographic host-based authentication is\nmore secure thanauthentication. However, it is\nnot recommended that hosts unilaterally trust one another, even\nwithin an organization.The default SSH configuration disables host-based authentication. The appropriate\nconfiguration is used if no value is set for.To explicitly disable host-based authentication, add or correct the\nfollowing line in:."},"help":{"text":"rationale:\nSSH trust relationships mean a compromise on one host\ncan allow an attacker to move trivially to other hosts."},"shortDescription":{"text":"Disable Host-Based Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_allow_only_protocol2","name":"AllowOnlySSHProtocol2","fullDescription":{"text":"Only SSH protocol version 2 connections should be\npermitted. The default setting inis correct, and can be\nverified by ensuring that the following\nline appears:."},"help":{"text":"rationale:\nSSH protocol version 1 is an insecure implementation of the SSH protocol and\nhas many well-known vulnerability exploits. Exploits of the SSH daemon could provide\nimmediate root access to the system.\nwarning:\nAs ofversionand above, the only protocol\nsupported is version 2, and lineinis not necessary."},"shortDescription":{"text":"Allow Only SSH Protocol 2."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) (c)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (1) c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-13","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_compression","name":"DisableCompressionOrSetCompressionToDelayed","fullDescription":{"text":"Compression is useful for slow network connections over long\ndistances but can cause performance issues on local LANs. If use of compression\nis required, it should be enabled only after a user has authenticated; otherwise,\nit should be disabled. To disable compression or delay compression until after\na user has successfully authenticated, add or correct the following line in thefile:."},"help":{"text":"rationale:\nIf compression is allowed in an SSH connection prior to authentication,\nvulnerabilities in the compression software could result in compromise of the\nsystem from an unauthenticated connection, potentially with root privileges."},"shortDescription":{"text":"Disable Compression Or Set Compression to delayed."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_empty_passwords","name":"DisableSSHAccessViaEmptyPasswords","fullDescription":{"text":"Disallow SSH login with empty passwords.\nThe default SSH configuration disables logins with empty passwords. The appropriate\nconfiguration is used if no value is set for.To explicitly disallow SSH login from accounts with empty passwords,\nadd or correct the following line in:Any accounts with empty passwords should be disabled immediately, and PAM configuration\nshould prevent users from being able to assign themselves empty passwords."},"help":{"text":"rationale:\nConfiguring this setting for the SSH daemon provides additional assurance\nthat remote login via SSH will require a password, even in the event of\nmisconfiguration elsewhere."},"shortDescription":{"text":"Disable SSH Access via Empty Passwords."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_gssapi_auth","name":"DisableGSSAPIAuthentication","fullDescription":{"text":"Unless needed, SSH should not permit extraneous or unnecessary\nauthentication mechanisms like GSSAPI.The default SSH configuration disallows authentications based on GSSAPI. The appropriate\nconfiguration is used if no value is set for.To explicitly disable GSSAPI authentication, add or correct the following line in:."},"help":{"text":"rationale:\nGSSAPI authentication is used to provide additional authentication mechanisms to\napplications. Allowing GSSAPI authentication through SSH exposes the system's\nGSSAPI to remote hosts, increasing the attack surface of the system."},"shortDescription":{"text":"Disable GSSAPI Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-11 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_kerb_auth","name":"DisableKerberosAuthentication","fullDescription":{"text":"Unless needed, SSH should not permit extraneous or unnecessary\nauthentication mechanisms like Kerberos.The default SSH configuration disallows authentication validation through Kerberos.\nThe appropriate configuration is used if no value is set for.To explicitly disable Kerberos authentication, add or correct the following line in:."},"help":{"text":"rationale:\nKerberos authentication for SSH is often implemented using GSSAPI. If Kerberos\nis enabled through SSH, the SSH daemon provides a means of access to the\nsystem's Kerberos implementation.\nConfiguring these settings for the SSH daemon provides additional assurance that remote logon via SSH will not use unused methods of authentication, even in the event of misconfiguration elsewhere."},"shortDescription":{"text":"Disable Kerberos Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-11 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-3 f","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-5 (1) (a)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_pubkey_auth","name":"DisablePubkeyAuthenticationAuthentication","fullDescription":{"text":"Unless needed, SSH should not permit extraneous or unnecessary\nauthentication mechanisms. To disable PubkeyAuthentication authentication, add or\ncorrect the following line in:."},"help":{"text":"rationale:\nPubkeyAuthentication authentication is used to provide additional authentication mechanisms to\napplications. Allowing PubkeyAuthentication authentication through SSH allows users to\ngenerate their own authentication tokens, increasing the attack surface of the system."},"shortDescription":{"text":"Disable PubkeyAuthentication Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_rhosts","name":"DisableSSHSupportFor.rhostsFiles","fullDescription":{"text":"SSH can emulate the behavior of the obsolete rsh\ncommand in allowing users to enable insecure access to their\naccounts viafiles.The default SSH configuration disables support for. The appropriate\nconfiguration is used if no value is set for.To explicitly disable support for .rhosts files, add or correct the following line in:."},"help":{"text":"rationale:\nSSH trust relationships mean a compromise on one host\ncan allow an attacker to move trivially to other hosts."},"shortDescription":{"text":"Disable SSH Support for .rhosts Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_rhosts_rsa","name":"DisableSSHSupportForRhostsRSAAuthentication","fullDescription":{"text":"SSH can allow authentication through the obsolete rsh\ncommand through the use of the authenticating user's SSH keys. This should be disabled.To ensure this behavior is disabled, add or correct the\nfollowing line in:."},"help":{"text":"rationale:\nConfiguring this setting for the SSH daemon provides additional\nassurance that remote login via SSH will require a password, even\nin the event of misconfiguration elsewhere.\nwarning:\nAs ofversionand above,\ntheoption has been deprecated, and the lineinis not\nnecessary."},"shortDescription":{"text":"Disable SSH Support for Rhosts RSA Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_root_login","name":"DisableSSHRootLogin","fullDescription":{"text":"The root user should never be allowed to login to a\nsystem directly over a network.\nTo disable root login via SSH, add or correct the following line in:."},"help":{"text":"rationale:\nEven though the communications channel may be encrypted, an additional layer of\nsecurity is gained by extending the policy of not logging directly on as root.\nIn addition, logging in with a user-specific account provides individual\naccountability of actions performed on the system and also helps to minimize\ndirect attack attempts on root's password."},"shortDescription":{"text":"Disable SSH Root Login."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (5)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_root_password_login","name":"DisableSSHRootLoginWithAPassword(Insecure)","fullDescription":{"text":"To disable password-based root logins over SSH, add or correct the following line in:."},"help":{"text":"rationale:\nEven though the communications channel may be encrypted, an additional\nlayer of security is gained by preventing use of a password.\nThis also helps to minimize direct attack attempts on root's password.\nwarning:\nWhile this disables password-based root logins, direct root logins\nthrough other means such as through SSH keys or GSSAPI will still be\npermitted. Permitting any sort of root login remotely opens up the\nroot account to attack.\nTo fully disable direct root logins over SSH (which is considered a\nbest practice) and prevent remote attacks against the root account,\nsee CCE-27100-7, CCE-27445-6, CCE-80901-2, and similar."},"shortDescription":{"text":"Disable SSH root Login with a Password (Insecure)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_tcp_forwarding","name":"DisableSSHTCPForwarding","fullDescription":{"text":"Theparameter specifies whether TCP forwarding is permitted.\nTo disable TCP forwarding, add or correct the following line in:."},"help":{"text":"rationale:\nLeaving port forwarding enabled can expose the organization to security risks and back-doors."},"shortDescription":{"text":"Disable SSH TCP Forwarding."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_user_known_hosts","name":"DisableSSHSupportForUserKnownHosts","fullDescription":{"text":"SSH can allow system users to connect to systems if a cache of the remote\nsystems public keys is available.  This should be disabled.To ensure this behavior is disabled, add or correct the following line in:."},"help":{"text":"rationale:\nConfiguring this setting for the SSH daemon provides additional\nassurance that remote login via SSH will require a password, even\nin the event of misconfiguration elsewhere."},"shortDescription":{"text":"Disable SSH Support for User Known Hosts."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_disable_x11_forwarding","name":"DisableX11Forwarding","fullDescription":{"text":"The X11Forwarding parameter provides the ability to tunnel X11 traffic\nthrough the connection to enable remote graphic connections.\nSSH has the capability to encrypt remote X11 connections when SSH'soption is enabled.The default SSH configuration disables X11Forwarding. The appropriate\nconfiguration is used if no value is set for.To explicitly disable X11 Forwarding, add or correct the following line in:."},"help":{"text":"rationale:\nDisable X11 forwarding unless there is an operational requirement to use X11\napplications directly. There is a small risk that the remote X11 servers of\nusers who are logged in via SSH with X11 forwarding could be compromised by\nother users on the X11 server. Note that even if X11 forwarding is disabled,\nusers can always install their own forwarders."},"shortDescription":{"text":"Disable X11 Forwarding."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_do_not_permit_user_env","name":"DoNotAllowSSHEnvironmentOptions","fullDescription":{"text":"Ensure that users are not able to override environment variables of the SSH daemon.The default SSH configuration disables environment processing. The appropriate\nconfiguration is used if no value is set for.To explicitly disable Environment options, add or correct the following:."},"help":{"text":"rationale:\nSSH environment options potentially allow users to bypass\naccess restriction in some configurations."},"shortDescription":{"text":"Do Not Allow SSH Environment Options."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_gssapi_auth","name":"EnableGSSAPIAuthentication","fullDescription":{"text":"Sites setup to use Kerberos or other GSSAPI Authenticaion require setting\nsshd to accept this authentication.\nTo enable GSSAPI authentication, add or correct the following line in:."},"help":{"text":"rationale:\nKerberos authentication for SSH is often implemented using GSSAPI. If\nKerberos is enabled through SSH, the SSH daemon provides a means of access\nto the system's Kerberos implementation. Vulnerabilities in the system's\nKerberos implementations may be subject to exploitation.\n\nFor enterprises, Kerberos is often enabled and used with GSSAPI for \ncentralized user account management which may necessitate enabling of\nGSSAPI functionality in SSH."},"shortDescription":{"text":"Enable GSSAPI Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_pam","name":"EnablePAM","fullDescription":{"text":"UsePAM Enables the Pluggable Authentication Module interface. If set to “yes” this will\nenable PAM authentication using ChallengeResponseAuthentication and\nPasswordAuthentication in addition to PAM account and session module processing for all\nauthentication types.\n\nTo enable PAM authentication, add or correct the following line in:."},"help":{"text":"rationale:\nWhen UsePAM is set to yes, PAM runs through account and session types properly. This is\nimportant if you want to restrict access to services based off of IP, time or other factors of\nthe account. Additionally, you can make sure users inherit certain environment variables\non login or disallow access to the server."},"shortDescription":{"text":"Enable PAM."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"MA-4 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_pubkey_auth","name":"EnablePublicKeyAuthentication","fullDescription":{"text":"Enable SSH login with public keys.The default SSH configuration enables authentication based on public keys. The appropriate\nconfiguration is used if no value is set for.To explicitly enable Public Key Authentication, add or correct the following:."},"help":{"text":"rationale:\nWithout the use of multifactor authentication, the ease of access to\nprivileged functions is greatly increased. Multifactor authentication\nrequires using two or more factors to achieve authentication.\nA privileged account is defined as an information system account with\nauthorizations of a privileged user. \nThe DoD CAC with DoD-approved PKI is an example of multifactor\nauthentication."},"shortDescription":{"text":"Enable Public Key Authentication."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"IA-2 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (3)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_strictmodes","name":"EnableUseOfStrictModeChecking","fullDescription":{"text":"SSHsoption checks file and ownership permissions in\nthe user's home directoryfolder before accepting login. If world-\nwritable permissions are found, logon is rejected.The default SSH configuration hasenabled. The appropriate\nconfiguration is used if no value is set for.To explicitly enablein SSH, add or correct the following line in:."},"help":{"text":"rationale:\nIf other users have access to modify user-specific SSH configuration files, they\nmay be able to log into the system as another user."},"shortDescription":{"text":"Enable Use of Strict Mode Checking."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner","name":"EnableSSHWarningBanner","fullDescription":{"text":"To enable the warning banner and ensure it is consistent\nacross the system, add or correct the following line in:Another section contains information on how to create an\nappropriate system-wide warning banner."},"help":{"text":"rationale:\nThe warning message reinforces policy awareness during the logon process and\nfacilitates possible legal action against attackers. Alternatively, systems\nwhose ownership should not be obvious should ensure usage of a banner that does\nnot provide easy attribution."},"shortDescription":{"text":"Enable SSH Warning Banner."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 1","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_warning_banner_net","name":"EnableSSHWarningBanner","fullDescription":{"text":"To enable the warning banner and ensure it is consistent\nacross the system, add or correct the following line in:Another section contains information on how to create an\nappropriate system-wide warning banner."},"help":{"text":"rationale:\nThe warning message reinforces policy awareness during the logon process and\nfacilitates possible legal action against attackers. Alternatively, systems\nwhose ownership should not be obvious should ensure usage of a banner that does\nnot provide easy attribution."},"shortDescription":{"text":"Enable SSH Warning Banner."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 1","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 2","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c 3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-8 c.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_enable_x11_forwarding","name":"EnableEncryptedX11Forwarding","fullDescription":{"text":"By default, remote X11 connections are not encrypted when initiated\nby users. SSH has the capability to encrypt remote X11 connections when SSH'soption is enabled.To enable X11 Forwarding, add or correct the following line in:."},"help":{"text":"rationale:\nNon-encrypted X displays allow an attacker to capture keystrokes and to execute commands\nremotely."},"shortDescription":{"text":"Enable Encrypted X11 Forwarding."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_limit_user_access","name":"LimitUsers'SSHAccess","fullDescription":{"text":"By default, the SSH configuration allows any user with an account\nto access the system. There are several options available to limit\nwhich users and group can access the system via SSH. It is\nrecommended that at least one of the following options be leveraged:\n- AllowUsers variable gives the system administrator the option of\n  allowing specific users to ssh into the system. The list consists of\n  space separated user names. Numeric user IDs are not recognized with\n  this variable. If a system administrator wants to restrict user\n  access further by specifically allowing a user's access only from a\n  particular host, the entry can be specified in the form of user@host.\n- AllowGroups variable gives the system administrator the option of\n  allowing specific groups of users to ssh into the system. The list\n  consists of space separated group names. Numeric group IDs are not\n  recognized with this variable.\n- DenyUsers variable gives the system administrator the option of\n  denying specific users to ssh into the system. The list consists of\n  space separated user names. Numeric user IDs are not recognized with\n  this variable. If a system administrator wants to restrict user\n  access further by specifically denying a user's access from a\n  particular host, the entry can be specified in the form of user@host.\n- DenyGroups variable gives the system administrator the option of\n  denying specific groups of users to ssh into the system. The list\n  consists of space separated group names. Numeric group IDs are not\n  recognized with this variable."},"help":{"text":"rationale:\nSpecifying which accounts are allowed SSH access into the system reduces the\npossibility of unauthorized access to the system."},"shortDescription":{"text":"Limit Users' SSH Access."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-3","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_print_last_log","name":"EnableSSHPrintLastLog","fullDescription":{"text":"Ensure that SSH will display the date and time of the last successful account logon.The default SSH configuration enables print of the date and time of the last login.\nThe appropriate configuration is used if no value is set for.To explicitly enable LastLog in SSH, add or correct the following line in:."},"help":{"text":"rationale:\nProviding users feedback on when account accesses last occurred facilitates user\nrecognition and reporting of unauthorized account use."},"shortDescription":{"text":"Enable SSH Print Last Log."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-9","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-9 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_rekey_limit","name":"ForceFrequentSessionKeyRenegotiation","fullDescription":{"text":"Theparameter specifies how often\nthe session key of the is renegotiated, both in terms of\namount of data that may be transmitted and the time\nelapsed.To decrease the default limits, add or correct the following line in:."},"help":{"text":"rationale:\nBy decreasing the limit based on the amount of data and enabling\ntime-based limit, effects of potential attacks against\nencryption keys are limited."},"shortDescription":{"text":"Force frequent session key renegotiation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_login_grace_time","name":"EnsureSSHLoginGraceTimeIsConfigured","fullDescription":{"text":"Theparameter to the SSH server specifies the time allowed for successful authentication to\nthe SSH server. The longer the Grace period is the more open unauthenticated connections\ncan exist. Like other session controls in this session the Grace Period should be limited to\nappropriate limits to ensure the service is available for needed access."},"help":{"text":"rationale:\nSetting theparameter to a low number will minimize the risk of successful\nbrute force attacks to the SSH server. It will also limit the number of concurrent\nunauthenticated connections."},"shortDescription":{"text":"Ensure SSH LoginGraceTime is configured."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_loglevel_info","name":"SetLogLevelToINFO","fullDescription":{"text":"The INFO parameter specifices that record login and logout activity will be logged.The default SSH configuration sets the log level to INFO. The appropriate\nconfiguration is used if no value is set for.To explicitly specify the log level in SSH, add or correct the following line in:."},"help":{"text":"rationale:\nSSH provides several logging levels with varying amounts of verbosity.is specifically\nnot recommended other than strictly for debugging SSH communications since it provides\nso much data that it is difficult to identify important security information.level is the\nbasic level that only records login activity of SSH users. In many situations, such as Incident\nResponse, it is important to determine when a particular user was active on a system. The\nlogout record can eliminate those users who disconnected, which helps narrow the field."},"shortDescription":{"text":"Set LogLevel to INFO."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_loglevel_verbose","name":"SetSSHDaemonLogLevelToVERBOSE","fullDescription":{"text":"Theparameter configures the SSH daemon to record login and logout activity.\nTo specify the log level in\nSSH, add or correct the following line in:."},"help":{"text":"rationale:\nSSH provides several logging levels with varying amounts of verbosity.is specifically\nnot recommended other than strictly for debugging SSH communications since it provides\nso much data that it is difficult to identify important security information.orlevel is the basic level that only records login activity of SSH users. In many\nsituations, such as Incident Response, it is important to determine when a particular user was active\non a system. The logout record can eliminate those users who disconnected, which helps narrow the\nfield."},"shortDescription":{"text":"Set SSH Daemon LogLevel to VERBOSE."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_max_auth_tries","name":"SetSSHAuthenticationAttemptLimit","fullDescription":{"text":"Theparameter specifies the maximum number of authentication attempts\npermitted per connection. Once the number of failures reaches half this value, additional failures are logged.\nto set MaxAUthTries editas follows:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nsshd_max_auth_tries_value=''\n\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*MaxAuthTries\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert before the line matching the regex '^Match'.\nline_number=\"$(LC_ALL=C grep -n \"^Match\" \"/etc/ssh/sshd_config.bak\" | LC_ALL=C sed 's/:.*//g')\"\nif [ -z \"$line_number\" ]; then\n    # There was no match of '^Match', insert at\n    # the end of the file.\n    printf '%s\\n' \"MaxAuthTries $sshd_max_auth_tries_value\" >> \"/etc/ssh/sshd_config\"\nelse\n    head -n \"$(( line_number - 1 ))\" \"/etc/ssh/sshd_config.bak\" > \"/etc/ssh/sshd_config\"\n    printf '%s\\n' \"MaxAuthTries $sshd_max_auth_tries_value\" >> \"/etc/ssh/sshd_config\"\n    tail -n \"+$(( line_number ))\" \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\nfi\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nSetting the MaxAuthTries parameter to a low number will minimize the risk of successful\nbrute force attacks to the SSH server."},"shortDescription":{"text":"Set SSH authentication attempt limit."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_max_sessions","name":"SetSSHMaxSessionsLimit","fullDescription":{"text":"Theparameter specifies the maximum number of open sessions permitted\nfrom a given connection. To set MaxSessions editas follows:."},"help":{"text":"rationale:\nTo protect a system from denial of service due to a large number of concurrent\nsessions, use the rate limiting function of MaxSessions to protect availability\nof sshd logins and prevent overwhelming the daemon."},"shortDescription":{"text":"Set SSH MaxSessions limit."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_set_maxstartups","name":"EnsureSSHMaxStartupsIsConfigured","fullDescription":{"text":"The MaxStartups parameter specifies the maximum number of concurrent\nunauthenticated connections to the SSH daemon. Additional connections will be\ndropped until authentication succeeds or the LoginGraceTime expires for a\nconnection. To confgure MaxStartups, you should add or correct the following\nline in thefile:CIS recommends a MaxStartups value of '10:30:60', or more restrictive where\ndictated by site policy."},"help":{"text":"rationale:\nTo protect a system from denial of service due to a large number of pending\nauthentication connection attempts, use the rate limiting function of MaxStartups\nto protect availability of sshd logins and prevent overwhelming the daemon."},"shortDescription":{"text":"Ensure SSH MaxStartups is configured."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_use_approved_ciphers_ordered_stig","name":"UseOnlyFIPS140-2ValidatedCiphers","fullDescription":{"text":"Limit the ciphers to those algorithms which are FIPS-approved.\nThe following line indemonstrates use of FIPS-approved ciphers:This rule ensures that there are configured ciphers mentioned\nabove (or their subset), keeping the given order of algorithms."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif grep -q -P '^\\s*[Cc]iphers\\s+' /etc/ssh/sshd_config; then\n  sed -i 's/^\\s*[Cc]iphers.*/Ciphers aes256-ctr,aes192-ctr,aes128-ctr/' /etc/ssh/sshd_config\nelse\n  echo \"Ciphers aes256-ctr,aes192-ctr,aes128-ctr\" >> /etc/ssh/sshd_config\nfi\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nUnapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore\ncannot be relied upon to provide confidentiality or integrity, and system data may be compromised.Operating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to\ncryptographic modules.FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules\nutilize authentication that meets industry and government requirements. For government systems, this allows\nSecurity Levels 1, 2, 3, or 4 for use on Ubuntu 22.04."},"shortDescription":{"text":"Use Only FIPS 140-2 Validated Ciphers."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-7","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"MA-4 c","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_use_priv_separation","name":"EnableUseOfPrivilegeSeparation","fullDescription":{"text":"When enabled, SSH will create an unprivileged child process that\nhas the privilege of the authenticated user. To enable privilege separation in\nSSH, add or correct the following line in thefile:."},"help":{"text":"rationale:\nSSH daemon privilege separation causes the SSH process to drop root privileges\nwhen not needed which would decrease the impact of software vulnerabilities in\nthe unprivileged section."},"shortDescription":{"text":"Enable Use of Privilege Separation."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_use_strong_ciphers","name":"UseOnlyStrongCiphers","fullDescription":{"text":"Limit the ciphers to strong algorithms.\nCounter (CTR) mode is also preferred over cipher-block chaining (CBC) mode.\nThe following line indemonstrates use of those ciphers:The man pagecontains a list of supported ciphers."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*Ciphers\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert before the line matching the regex '^Match'.\nline_number=\"$(LC_ALL=C grep -n \"^Match\" \"/etc/ssh/sshd_config.bak\" | LC_ALL=C sed 's/:.*//g')\"\nif [ -z \"$line_number\" ]; then\n    # There was no match of '^Match', insert at\n    # the end of the file.\n    printf '%s\\n' \"Ciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com\" >> \"/etc/ssh/sshd_config\"\nelse\n    head -n \"$(( line_number - 1 ))\" \"/etc/ssh/sshd_config.bak\" > \"/etc/ssh/sshd_config\"\n    printf '%s\\n' \"Ciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com\" >> \"/etc/ssh/sshd_config\"\n    tail -n \"+$(( line_number ))\" \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\nfi\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nBased on research conducted at various institutions, it was determined that the symmetric\nportion of the SSH Transport Protocol (as described in RFC 4253) has security weaknesses\nthat allowed recovery of up to 32 bits of plaintext from a block of ciphertext that was\nencrypted with the Cipher Block Chaining (CBD) method. From that research, new Counter\nmode algorithms (as described in RFC4344) were designed that are not vulnerable to these\ntypes of attacks and these algorithms are now recommended for standard use."},"shortDescription":{"text":"Use Only Strong Ciphers."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_use_strong_kex","name":"UseOnlyStrongKeyExchangeAlgorithms","fullDescription":{"text":"Limit the Key Exchange to strong algorithms.\nThe following line indemonstrates use\nof those:."},"help":{"text":"rationale:\nKey exchange is any method in cryptography by which cryptographic keys are exchanged\nbetween two parties, allowing use of a cryptographic algorithm. If the sender and receiver\nwish to exchange encrypted messages, each must be equipped to encrypt messages to be\nsent and decrypt messages received"},"shortDescription":{"text":"Use Only Strong Key Exchange algorithms."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sshd_use_strong_macs","name":"UseOnlyStrongMACs","fullDescription":{"text":"Limit the MACs to strong hash algorithms.\nThe following line indemonstrates use\nof those MACs:."},"help":{"text":"fix:\n# Remediation is applicable only in certain platforms\nif [ ! -f /.dockerenv ] && [ ! -f /run/.containerenv ]; then\n\nif [ -e \"/etc/ssh/sshd_config\" ] ; then\n    \n    LC_ALL=C sed -i \"/^\\s*MACs\\s\\+/Id\" \"/etc/ssh/sshd_config\"\nelse\n    touch \"/etc/ssh/sshd_config\"\nfi\n# make sure file has newline at the end\nsed -i -e '$a\\' \"/etc/ssh/sshd_config\"\n\ncp \"/etc/ssh/sshd_config\" \"/etc/ssh/sshd_config.bak\"\n# Insert before the line matching the regex '^Match'.\nline_number=\"$(LC_ALL=C grep -n \"^Match\" \"/etc/ssh/sshd_config.bak\" | LC_ALL=C sed 's/:.*//g')\"\nif [ -z \"$line_number\" ]; then\n    # There was no match of '^Match', insert at\n    # the end of the file.\n    printf '%s\\n' \"MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,hmac-ripemd160\" >> \"/etc/ssh/sshd_config\"\nelse\n    head -n \"$(( line_number - 1 ))\" \"/etc/ssh/sshd_config.bak\" > \"/etc/ssh/sshd_config\"\n    printf '%s\\n' \"MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,hmac-ripemd160\" >> \"/etc/ssh/sshd_config\"\n    tail -n \"+$(( line_number ))\" \"/etc/ssh/sshd_config.bak\" >> \"/etc/ssh/sshd_config\"\nfi\n# Clean up after ourselves.\nrm \"/etc/ssh/sshd_config.bak\"\n\nelse\n    >&2 echo 'Remediation is not applicable, nothing was done'\nfi\nrationale:\nMD5 and 96-bit MAC algorithms are considered weak and have been shown to increase\nexploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of\nattention as a weak spot that can be exploited with expanded computing power. An\nattacker that breaks the algorithm could take advantage of a MiTM position to decrypt the\nSSH tunnel and capture credentials and information"},"shortDescription":{"text":"Use Only Strong MACs."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_openssh-server_installed","name":"InstallTheOpenSSHServerPackage","fullDescription":{"text":"Thepackage should be installed.\nThepackage can be installed with the following command:."},"help":{"text":"rationale:\nWithout protection of the transmitted information, confidentiality, and\nintegrity may be compromised because unprotected communications can be\nintercepted and either read or altered."},"shortDescription":{"text":"Install the OpenSSH Server Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-8","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-8 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SC-8 (2)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_openssh-server_removed","name":"RemoveTheOpenSSHServerPackage","fullDescription":{"text":"Thepackage should be removed.\nThepackage can be removed with the following command:."},"help":{"text":"rationale:\nWithout protection of the transmitted information, confidentiality, and\nintegrity may be compromised because unprotected communications can be\nintercepted and either read or altered."},"shortDescription":{"text":"Remove the OpenSSH Server Package."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_service_sshd_disabled","name":"DisableSSHServerIfPossible","fullDescription":{"text":"The SSH server service, sshd, is commonly needed.\nHowever, if it can be disabled, do so.\nThis is unusual, as SSH is a common method for encrypted and authenticated\nremote access."},"shortDescription":{"text":"Disable SSH Server If Possible."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-3 (6)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-2 (4)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupowner_sshd_config","name":"VerifyGroupWhoOwnsSSHServerConfigFile","fullDescription":{"text":"To properly set the group owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective\nservices that if configured incorrectly can lead to insecure and vulnerable\nconfigurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Group Who Owns SSH Server config file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupownership_sshd_private_key","name":"VerifyGroupOwnershipOnSSHServerPrivate*_keyKeyFiles","fullDescription":{"text":"SSH server private keys, files that match theglob, must be\ngroup-owned bygroup."},"help":{"text":"rationale:\nIf an unauthorized user obtains the private SSH host key file, the host could be impersonated."},"shortDescription":{"text":"Verify Group Ownership on SSH Server Private *_key Key Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_groupownership_sshd_pub_key","name":"VerifyGroupOwnershipOnSSHServerPublic*.pubKeyFiles","fullDescription":{"text":"SSH server public keys, files that match theglob, must be\ngroup-owned bygroup."},"help":{"text":"rationale:\nIf a public host key file is modified by an unauthorized user, the SSH service\nmay be compromised."},"shortDescription":{"text":"Verify Group Ownership on SSH Server Public *.pub Key Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_owner_sshd_config","name":"VerifyOwnerOnSSHServerConfigFile","fullDescription":{"text":"To properly set the owner of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective\nservices that if configured incorrectly can lead to insecure and vulnerable\nconfigurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Owner on SSH Server config file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_sshd_private_key","name":"VerifyOwnershipOnSSHServerPrivate*_keyKeyFiles","fullDescription":{"text":"SSH server private keys, files that match theglob, must be owned\nbyuser."},"help":{"text":"rationale:\nIf an unauthorized user obtains the private SSH host key file, the host could be impersonated."},"shortDescription":{"text":"Verify Ownership on SSH Server Private *_key Key Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_ownership_sshd_pub_key","name":"VerifyOwnershipOnSSHServerPublic*.pubKeyFiles","fullDescription":{"text":"SSH server public keys, files that match theglob, must be owned\nbyuser."},"help":{"text":"rationale:\nIf a public host key file is modified by an unauthorized user, the SSH service\nmay be compromised."},"shortDescription":{"text":"Verify Ownership on SSH Server Public *.pub Key Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_sshd_config","name":"VerifyPermissionsOnSSHServerConfigFile","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nService configuration files enable or disable features of their respective\nservices that if configured incorrectly can lead to insecure and vulnerable\nconfigurations. Therefore, service configuration files should be owned by the\ncorrect group to prevent unauthorized changes."},"shortDescription":{"text":"Verify Permissions on SSH Server config file."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_sshd_private_key","name":"VerifyPermissionsOnSSHServerPrivate*_keyKeyFiles","fullDescription":{"text":"SSH server private keys - files that match theglob, have to have restricted permissions.\nIf those files are owned by theuser and thegroup, they have to have thepermission or stricter."},"help":{"text":"rationale:\nIf an unauthorized user obtains the private SSH host key file, the host could be\nimpersonated."},"shortDescription":{"text":"Verify Permissions on SSH Server Private *_key Key Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_file_permissions_sshd_pub_key","name":"VerifyPermissionsOnSSHServerPublic*.pubKeyFiles","fullDescription":{"text":"To properly set the permissions of, run the command:."},"help":{"text":"rationale:\nIf a public host key file is modified by an unauthorized user, the SSH service\nmay be compromised."},"shortDescription":{"text":"Verify Permissions on SSH Server Public *.pub Key Files."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"AC-17 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"AC-6 (1)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_iptables_sshd_disabled","name":"RemoveSSHServerIptablesFirewallException(Unusual)","fullDescription":{"text":"By default, inbound connections to SSH's port are allowed. If the SSH\nserver is not being used, this exception should be removed from the\nfirewall configuration.Edit the filesand(if IPv6 is in use). In each file, locate\nand delete the line:This is unusual, as SSH is a common method for encrypted and authenticated\nremote access."},"help":{"text":"rationale:\nIf inbound SSH connections are not expected, disallowing access to the SSH\nport will avoid possible exploitation of the port by an attacker."},"shortDescription":{"text":"Remove SSH Server iptables Firewall exception (Unusual)."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"RA-5","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"SA-11","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_sssd_offline_cred_expiration","name":"ConfigureSSSDToExpireOfflineCredentials","fullDescription":{"text":"SSSD should be configured to expire offline credentials after 1 day.\n\nTo configure SSSD to expire offline credentials, settounder thesection in. For example:."},"help":{"text":"rationale:\nIf cached authentication information is out-of-date, the validity of the\nauthentication information may be questionable."},"shortDescription":{"text":"Configure SSSD to Expire Offline Credentials."},"defaultConfiguration":{"enabled":false,"level":"note"},"properties":{"security-severity":"0","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"IA-5 (13)","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]},{"id":"xccdf_org.ssgproject.content_rule_package_xorg-x11-server-common_removed","name":"RemoveTheXWindowsPackageGroup","fullDescription":{"text":"By removing the xorg-x11-server-common package, the system no longer has X Windows\ninstalled. If X Windows is not installed then the system cannot boot into graphical user mode.\nThis prevents the system from being accidentally or maliciously booted into amode. To do so, run the following command:."},"help":{"text":"rationale:\nUnnecessary service packages must not be installed to decrease the attack surface of the system. X windows has a long history of security\nvulnerabilities and should not be installed unless approved and documented.\nwarning:\nThe installation and use of a Graphical User Interface (GUI) increases your attack vector and decreases your\noverall security posture. Removing the package xorg-x11-server-common package will remove the graphical target\nwhich might bring your system to an inconsistent state requiring additional configuration to access the system\nagain. If a GUI is an operational requirement, a tailored profile that removes this rule should used before\ncontinuing installation."},"shortDescription":{"text":"Remove the X Windows Package Group."},"properties":{"security-severity":"5","precision":"very-high","tags":["security"]},"relationships":[{"target":{"id":"CM-6 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-6 b","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 a.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]},{"target":{"id":"CM-7 b.","toolComponent":{"name":"NIST","guid":"aafbab93-5201-419e-8443-d4925c542398"}},"kinds":["relevant"]}]}],"supportedTaxonomies":[{"name":"NIST SP800-53 v5","guid":"aafbab93-5201-419e-8443-d4925c542398"}]}},"originalUriBaseIds":{"ROOTPATH":{"uri":"file:///"}},"artifacts":[{"location":{"uri":"file:///","uriBaseId":"ROOTPATH"}},{"location":{"uri":"https://raw.githubusercontent.com/sarif-standard/taxonomies/main/NIST_SP800-53_v5.sarif"}}],"columnKind":"utf16CodeUnits","externalPropertyFileReferences":{"taxonomies":[{"location":{"uri":"https://raw.githubusercontent.com/sarif-standard/taxonomies/main/NIST_SP800-53_v5.sarif","index":1},"guid":"aafbab93-5201-419e-8443-d4925c542398"}]}}]}